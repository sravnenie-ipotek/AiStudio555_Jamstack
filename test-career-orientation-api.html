<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Orientation API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üß™ Career Orientation API Test</h1>
    
    <div class="test-section">
        <h2>1. Test GET Endpoint</h2>
        <button onclick="testGetAPI()">Test GET /api/career-orientation-page</button>
        <div id="getResult"></div>
    </div>

    <div class="test-section">
        <h2>2. Test PUT Endpoint (Save Data)</h2>
        <button onclick="testPutAPI()">Test PUT /api/career-orientation-page</button>
        <div id="putResult"></div>
    </div>

    <div class="test-section">
        <h2>3. Load and Display All Fields</h2>
        <button onclick="loadAllFields()">Load All 215+ Fields</button>
        <div id="fieldsResult"></div>
    </div>

    <script>
        const API_URL = '/api';
        
        async function testGetAPI() {
            const resultDiv = document.getElementById('getResult');
            resultDiv.innerHTML = 'Loading...';
            
            try {
                const response = await fetch(`${API_URL}/career-orientation-page?locale=en`);
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ GET Endpoint Working!</p>
                        <p>Response Status: ${response.status}</p>
                        <p>Data Found: ${data.data ? 'Yes' : 'No'}</p>
                        <p>Fields in Response: ${data.data?.attributes ? Object.keys(data.data.attributes).length : 0} fields</p>
                        <details>
                            <summary>View Response Data</summary>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </details>
                    `;
                } else {
                    resultDiv.innerHTML = `<p class="error">‚ùå Error: ${response.status} - ${response.statusText}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">‚ùå Network Error: ${error.message}</p>`;
            }
        }

        async function testPutAPI() {
            const resultDiv = document.getElementById('putResult');
            resultDiv.innerHTML = 'Saving test data...';
            
            const testData = {
                data: {
                    heroMainTitle: 'TEST: AI Career Orientation Program',
                    heroSubtitle: 'TEST: Discover Your Perfect AI Career Path',
                    heroDescription: 'TEST: Advanced AI-powered assessment',
                    heroStat1Value: '500+',
                    heroStat1Label: 'Career Paths Mapped',
                    heroStat2Value: '95%',
                    heroStat2Label: 'Success Rate',
                    heroStat3Value: '15+',
                    heroStat3Label: 'AI Specializations',
                    heroCtaText: 'Start Your Journey',
                    heroCtaLink: '#assessment',
                    heroBadgeText: 'Free Assessment',
                    heroVisible: true,
                    
                    problemsMainTitle: 'TEST: Common Career Challenges',
                    problemsSubtitle: 'TEST: We understand',
                    problemsVisible: true,
                    
                    solutionsMainTitle: 'TEST: Our Solutions',
                    solutionsVisible: true,
                    
                    processMainTitle: 'TEST: 5-Step Journey',
                    processVisible: true,
                    
                    careerPathsMainTitle: 'TEST: Career Paths',
                    careerPathsVisible: true,
                    
                    expertName: 'Dr. Test Expert',
                    expertTitle: 'Senior Test Advisor',
                    expertVisible: true,
                    
                    assessmentMainTitle: 'TEST: Free Assessment',
                    assessmentVisible: true,
                    
                    footerTitle: 'TEST: Ready to Transform?',
                    footerVisible: true
                }
            };
            
            try {
                const response = await fetch(`${API_URL}/career-orientation-page?locale=en`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ PUT Endpoint Working! Data Saved Successfully!</p>
                        <p>Response Status: ${response.status}</p>
                        <p>Test data with "TEST:" prefix has been saved.</p>
                        <p>Now click "Test GET" again to verify the data was saved.</p>
                    `;
                } else {
                    const errorText = await response.text();
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå Error: ${response.status}</p>
                        <pre>${errorText}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">‚ùå Network Error: ${error.message}</p>`;
            }
        }

        async function loadAllFields() {
            const resultDiv = document.getElementById('fieldsResult');
            resultDiv.innerHTML = 'Loading all fields...';
            
            try {
                const response = await fetch(`${API_URL}/career-orientation-page?locale=en`);
                const data = await response.json();
                
                if (response.ok && data.data?.attributes) {
                    const attrs = data.data.attributes;
                    const sections = {
                        'Hero Section': ['heroMainTitle', 'heroSubtitle', 'heroDescription', 'heroStat1Value', 'heroStat1Label'],
                        'Problems Section': ['problemsMainTitle', 'problemsSubtitle', 'problem1Title', 'problem1Description'],
                        'Solutions Section': ['solutionsMainTitle', 'solutionsSubtitle', 'solution1Title'],
                        'Process Section': ['processMainTitle', 'processSubtitle', 'processStep1Title'],
                        'Career Paths': ['careerPathsMainTitle', 'careerPath1Title'],
                        'Expert Section': ['expertName', 'expertTitle'],
                        'Assessment': ['assessmentMainTitle', 'assessmentSubtitle'],
                        'Footer': ['footerTitle', 'footerSubtitle']
                    };
                    
                    let html = '<h3>üìä All Sections Data:</h3>';
                    
                    for (const [section, fields] of Object.entries(sections)) {
                        html += `<h4>${section}</h4><ul>`;
                        for (const field of fields) {
                            const value = attrs[field] || '(empty)';
                            html += `<li><strong>${field}:</strong> ${value}</li>`;
                        }
                        html += '</ul>';
                    }
                    
                    html += `<p class="success">Total fields available: ${Object.keys(attrs).length}</p>`;
                    
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<p class="error">No data found or error loading fields</p>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
            }
        }

        // Auto-test on load
        window.addEventListener('DOMContentLoaded', function() {
            console.log('Career Orientation API Test Page Loaded');
            console.log('API URL:', API_URL);
        });
    </script>
</body>
</html>