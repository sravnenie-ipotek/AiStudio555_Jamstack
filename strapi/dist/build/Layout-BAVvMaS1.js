const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["strapi-CQJ1aB9a.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{r as h,aC as v,cO as I,aT as T,H as _,cP as C,bT as D,ar as A,u as N,X as O,C as B,ca as R,j as t,cQ as d,bK as U,cR as F,s as H,aE as K,bf as G,k as M,bj as V,L as X,cS as $}from"./strapi-CQJ1aB9a.js";import{s as Q}from"./sortBy-COOWoZgl.js";import{s as W}from"./selectors-Bq6LDChF.js";import"./_baseMap-CWCAK5nm.js";import"./_baseEach-B3G95oE4.js";const q=i=>i.map(a=>{const o=a.links.map(n=>({...n,isDisplayed:!1}));return{...a,links:o}}),z=()=>{const[{isLoading:i,menu:a},o]=h.useState({isLoading:!0,menu:[]}),n=v("useSettingsMenu",s=>s.checkUserHasPermissions),u=I("useSettingsMenu",s=>s.shouldUpdateStrapi),m=T("useSettingsMenu",s=>s.settings),g=_(W),y=h.useMemo(()=>C(),[]),{admin:p,global:r}=D(y,async()=>(await A(async()=>{const{SETTINGS_LINKS_EE:s}=await import("./strapi-CQJ1aB9a.js").then(e=>e.kX);return{SETTINGS_LINKS_EE:s}},__vite__mapDeps([0,1]))).SETTINGS_LINKS_EE(),{combine(s,e){return{admin:[...e.admin,...s.admin],global:[...s.global,...e.global]}},defaultValue:{admin:[],global:[]}}),l=h.useCallback(s=>{if(!s.id)throw new Error("The settings menu item must have an id attribute.");return{...s,permissions:g.settings?.[s.id]?.main??[]}},[g.settings]);return h.useEffect(()=>{const s=async()=>{const w=await(L=>Promise.all(L.reduce((f,S,k)=>{const x=S.links.map(async(j,b)=>({hasPermission:(await n(j.permissions)).length>0,sectionIndex:k,linkIndex:b}));return[...f,...x]},[])))(E);o(L=>({...L,isLoading:!1,menu:E.map((f,S)=>({...f,links:f.links.map((k,x)=>{const j=w.find(b=>b.sectionIndex===S&&b.linkIndex===x);return{...k,isDisplayed:!!j?.hasPermission}})}))}))},{global:e,...P}=m,E=q([{...e,links:Q([...e.links,...r.map(l)],c=>c.id).map(c=>({...c,hasNotification:c.id==="000-application-infos"&&u}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:p.map(l)},...Object.values(P)]);s()},[p,r,m,u,l,n]),{isLoading:i,menu:a.map(s=>({...s,links:s.links.filter(e=>e.isDisplayed)}))}},J=H(K)`
  border-radius: 50%;
  padding: ${({theme:i})=>i.spaces[2]};
  height: 2rem;
`,Y=({menu:i})=>{const{formatMessage:a}=N(),{trackUsage:o}=O(),{pathname:n}=B(),{license:u}=R(),m=u?.features.map(s=>s.name),g={"content-releases":"cms-content-releases","review-workflows":"review-workflows",sso:"sso",auditLogs:"audit-logs","auditLogs-purchase-page":"audit-logs"},p=i.filter(s=>!s.links.every(e=>e.isDisplayed===!1)).map(s=>({...s,title:s.intlLabel,links:s.links.map(e=>({...e,id:e.id,title:e.intlLabel,name:e.id}))})),r=a({id:"global.settings",defaultMessage:"Settings"}),l=s=>()=>{o("willNavigate",{from:n,to:s})};return t.jsxs(d.Main,{"aria-label":r,children:[t.jsx(d.Header,{label:r}),t.jsx(U,{background:"neutral150",marginBottom:5}),t.jsx(d.Sections,{children:p.map(s=>t.jsx(d.Section,{label:a(s.intlLabel),children:s.links.map(e=>t.jsx(d.Link,{to:e.to,onClick:l(e.to),label:a(e.intlLabel),endAction:t.jsxs(t.Fragment,{children:[e?.licenseOnly&&t.jsx(F,{fill:(m||[]).includes(g[e.id])?"primary600":"neutral300",width:"1.5rem",height:"1.5rem"}),e?.hasNotification&&t.jsx(J,{"aria-label":"Notification",backgroundColor:"primary600",textColor:"neutral0",children:"1"})]})},e.id))},s.id))})]})},is=()=>{const i=G("/settings/:settingId/*"),{formatMessage:a}=N(),{isLoading:o,menu:n}=z();return o?t.jsx(M.Loading,{}):i?.params.settingId?t.jsxs(X.Root,{sideNav:t.jsx(Y,{menu:n}),children:[t.jsx(M.Title,{children:a({id:"global.settings",defaultMessage:"Settings"})}),t.jsx($,{})]}):t.jsx(V,{to:"application-infos"})};export{is as Layout};
