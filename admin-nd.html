<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Design Admin - AI Studio</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: relative;
        }

        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 14px; }

        /* Language Switcher */
        #admin-language-switcher {
            position: absolute;
            top: 20px;
            right: 200px;
            display: flex !important;
            gap: 8px;
            z-index: 1001;
        }

        .lang-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .lang-btn.active {
            background: rgba(255,255,255,0.9);
            color: #667eea;
            border-color: white;
        }

        /* Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Main Card */
        .admin-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0;
            border-bottom: 2px solid #e1e1e1;
            background: #f8f9fa;
            padding: 0 20px;
        }

        .tab {
            padding: 15px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
            position: relative;
            color: #666;
        }

        .tab.active {
            color: #667eea;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .tab:hover:not(.active) {
            background: rgba(102, 126, 234, 0.05);
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 30px;
        }

        .content-section.active {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }


        /* Form Groups */
        .form-group {
            margin-bottom: 25px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e1e1e1;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s;
            font-family: inherit;
            background: white;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Visibility Toggle */
        .visibility-group {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .visibility-toggle {
            position: relative;
            width: 50px;
            height: 26px;
        }

        .visibility-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .visibility-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 26px;
        }

        .visibility-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        .visibility-toggle input:checked + .visibility-slider {
            background-color: #667eea;
        }

        .visibility-toggle input:checked + .visibility-slider:before {
            transform: translateX(24px);
        }

        /* Dynamic List Manager */
        .list-manager {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .list-item {
            background: white;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
        }

        .list-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .list-item-actions {
            display: flex;
            gap: 10px;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 15px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }

        /* Enhanced Tooltips */
        .btn[title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2d3748;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            margin-bottom: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            pointer-events: none;
        }

        .btn[title]:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #2d3748;
            margin-bottom: -4px;
            z-index: 1000;
            pointer-events: none;
        }

        .btn:hover {
            background: #5569d3;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-danger { background: #ff3b30; }
        .btn-danger:hover { background: #d12b20; }

        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #5a6268; }

        .btn-success { background: #28a745; }
        .btn-success:hover { background: #218838; }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        /* Search Feature Styles */
        .search-container {
            background: white;
            padding: 20px;
            border-bottom: 2px solid #e1e1e1;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s;
        }

        .search-box input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            cursor: pointer;
            transition: all 0.2s;
        }

        .search-result-item:hover {
            background: #e8f4fd;
            transform: translateX(5px);
        }

        .search-result-section {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .search-result-field {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .search-result-value {
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .search-highlight {
            background: #fff59d;
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        /* Preview Mode Banner */
        .preview-banner {
            background: #ffc107;
            color: #000;
            padding: 10px;
            text-align: center;
            font-weight: 500;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: none;
        }

        .preview-banner.active {
            display: block;
        }

        /* Toaster */
        .toaster-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            max-width: 400px;
        }

        .toaster {
            background: white;
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 10px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            border-left: 4px solid #667eea;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease-out;
        }

        .toaster.success { border-left-color: #28a745; }
        .toaster.error { border-left-color: #dc3545; }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Section Headers */
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
        }

        /* Loading States */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>

    <!-- Admin Hints System -->
    <link rel="stylesheet" href="backups/newDesign/css/admin-hints.css">
</head>
<body>
    <!-- Preview Banner -->
    <div id="previewBanner" class="preview-banner">
        🔍 Preview Mode - Changes are not saved until you click Save
    </div>

    <!-- Header -->
    <div class="header">
        <div id="admin-language-switcher">
            <button class="lang-btn active" data-lang="en">EN</button>
            <button class="lang-btn" data-lang="ru">RU</button>
            <button class="lang-btn" data-lang="he">HE</button>
        </div>
        <h1>🎨 New Design Content Manager</h1>
        <p>Manage content for the new design with visibility controls and multi-language support</p>
    </div>

    <!-- Container -->
    <div class="container">
        <div class="admin-card">
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" data-tab="home">Home Page</button>
                <button class="tab" data-tab="courses">Courses</button>
                <button class="tab" data-tab="pricing">Pricing</button>
                <button class="tab" data-tab="career-platform">Career Platform</button>
                <button class="tab" data-tab="teachers">Teachers</button>
                <button class="tab" data-tab="blogAdmin">BlogAdmin</button>
                <button class="tab" data-tab="menu">Navigation</button>
                <button class="tab" data-tab="footer">Footer</button>
                <button class="tab" data-tab="settings">Settings</button>
                <button class="tab" data-tab="database">📊 Database Tables</button>
            </div>

            <!-- Search Feature -->
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="adminSearch" placeholder="🔍 Search for any content, field, or value across all sections..." />
                    <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
                </div>
                <div id="searchResults" class="search-results"></div>
            </div>

            <!-- Home Page Section -->
            <div class="content-section active" id="home">
                <div class="section-header">
                    <div class="section-title">Home Page Sections</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small" onclick="toggleHomeHelp()">❓ Help</button>
                        <button class="btn btn-small" onclick="previewChanges()">👁️ Preview</button>
                    </div>
                </div>

                <!-- Help Section -->
                <div id="homeHelpSection" style="display: none; background: linear-gradient(135deg, #667eea15, #764ba215); border: 1px solid #667eea30; border-radius: 12px; padding: 20px; margin: 20px 0;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">📚 Home Page Management Guide</h3>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #2d3748; margin-bottom: 10px;">📖 Overview</h4>
                        <p style="color: #4a5568; line-height: 1.6;">This section allows you to manage all content displayed on the home page of your website. Each subsection corresponds to a visible area on your homepage. You can toggle visibility, edit text content, and manage dynamic lists like courses, testimonials, and features.</p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #2d3748; margin-bottom: 10px;">🔘 Button Functions</h4>
                        <div style="display: grid; gap: 10px;">
                            <div style="background: white; padding: 12px; border-radius: 8px; border-left: 3px solid #667eea;">
                                <strong>💾 Save Changes</strong> - Saves all modifications made to the home page content to the database. Changes won't appear on the live site until saved.
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; border-left: 3px solid #10b981;">
                                <strong>🔄 Reload Content</strong> - Refreshes the form with the latest content from the database, discarding any unsaved changes.
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                                <strong>📥 Export JSON</strong> - Downloads the current home page configuration as a JSON file for backup or transfer purposes.
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                                <strong>📤 Import JSON</strong> - Uploads a previously exported JSON file to restore home page configuration.
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; border-left: 3px solid #06b6d4;">
                                <strong>👁️ Preview</strong> - Opens the home page in a new tab with your unsaved changes applied temporarily for review.
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #2d3748; margin-bottom: 10px;">📝 Section Controls</h4>
                        <ul style="color: #4a5568; line-height: 1.8;">
                            <li><strong>Visibility Toggle</strong> - Use the switch next to each section to show/hide it on the live site</li>
                            <li><strong>+ Add Button</strong> - Adds new items to lists (features, courses, testimonials, etc.)</li>
                            <li><strong>Text Fields</strong> - Edit titles, subtitles, and descriptions directly</li>
                            <li><strong>Delete Icons</strong> - Remove individual items from lists</li>
                        </ul>
                    </div>

                    <div style="background: #fef5e7; border: 1px solid #f9c74f; border-radius: 8px; padding: 12px;">
                        <strong style="color: #f77f00;">⚠️ Important Notes:</strong>
                        <ul style="color: #d62828; margin-top: 8px; margin-bottom: 0;">
                            <li>Always save your changes before leaving the page</li>
                            <li>Use Preview to check your changes before saving</li>
                            <li>Export JSON regularly for backups</li>
                            <li>Changes are language-specific based on the selected language</li>
                        </ul>
                    </div>
                </div>

                <!-- Hero Section -->
                <div class="form-group">
                    <label>🦸 Hero Section</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="hero_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="hero_title" placeholder="Hero Title" class="mb-10">
                    <input type="text" id="hero_subtitle" placeholder="Hero Subtitle" class="mb-10">
                    <textarea id="hero_description" placeholder="Hero Description"></textarea>

                    <!-- Hero Buttons -->
                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Buttons</strong>
                            <button class="btn btn-small btn-success" onclick="addHeroButton()" title="Add a new call-to-action button to the hero section">+ Add Button</button>
                        </div>
                        <div id="heroButtons"></div>
                    </div>
                </div>

                <!-- Features Section -->
                <div class="form-group">
                    <label>✨ Features Section</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="features_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="features_title" placeholder="Features Title" class="mb-10">
                    <input type="text" id="features_subtitle" placeholder="Features Subtitle" class="mb-10">

                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Feature Items</strong>
                            <button class="btn btn-small btn-success" onclick="addFeatureItem()" title="Add a new feature item to showcase">+ Add Feature</button>
                        </div>
                        <div id="featureItems"></div>
                    </div>
                </div>

                <!-- Courses Section -->
                <div class="form-group">
                    <label>📚 Courses Section</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="courses_visible" checked onchange="console.log('🔄 [Admin] Courses visibility toggled:', this.checked ? 'ON' : 'OFF')">
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="courses_title" placeholder="Courses Title" class="mb-10">
                    <input type="text" id="courses_subtitle" placeholder="Courses Subtitle" class="mb-10">

                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Course Cards</strong>
                            <button class="btn btn-small btn-success add-course-btn" id="addCourseBtn" onclick="addCourseCard()" title="Add a new course card to display">+ Add Course</button>
                        </div>
                        <div id="courseCards"></div>
                    </div>
                </div>

                <!-- Testimonials Section -->
                <div class="form-group">
                    <label>💬 Testimonials Section</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="testimonials_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="testimonials_title" placeholder="Testimonials Title" class="mb-10">
                    <input type="text" id="testimonials_subtitle" placeholder="Testimonials Subtitle" class="mb-10">

                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Testimonial Items</strong>
                            <button class="btn btn-small btn-success" onclick="addTestimonial()" title="Add a new student testimonial">+ Add Testimonial</button>
                        </div>
                        <div id="testimonialItems"></div>
                    </div>
                </div>

                <!-- Awards Section -->
                <div class="form-group">
                    <label>🏆 Awards Section</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="awards_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="awards_title" placeholder="Awards Title (e.g., Awards That Define Our Excellence.)" class="mb-10">
                    <input type="text" id="awards_subtitle" placeholder="Awards Subtitle" class="mb-10">

                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Award Items</strong>
                            <button class="btn btn-small btn-success" onclick="addAwardItem()" title="Add a new award or certification">+ Add Award</button>
                        </div>
                        <div id="awardItems"></div>
                    </div>
                </div>

                <!-- Pricing Plans Section -->
                <div class="form-group">
                    <label>💰 Pricing Plans</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="pricing_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="pricing_title" placeholder="Pricing Title (e.g., Choose Your Learning Path)" class="mb-10">
                    <input type="text" id="pricing_subtitle" placeholder="Pricing Subtitle (e.g., Flexible Pricing Plans)" class="mb-10">

                    <div class="list-manager mt-20">
                        <div class="list-item-header">
                            <strong>Pricing Plans (Basic, Pro, Enterprise)</strong>
                            <button class="btn btn-small btn-success" onclick="addPricingPlan()" title="Add a new pricing plan option">+ Add Plan</button>
                        </div>
                        <div id="pricingPlans"></div>
                    </div>
                </div>

                <!-- CTA Section -->
                <div class="form-group">
                    <label>📢 Call to Action</label>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="cta_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Section Visible</span>
                    </div>

                    <input type="text" id="cta_title" placeholder="CTA Title" class="mb-10">
                    <textarea id="cta_description" placeholder="CTA Description"></textarea>
                    <input type="text" id="cta_button_text" placeholder="Button Text" class="mb-10">
                    <input type="text" id="cta_button_url" placeholder="Button URL" class="mb-10">
                </div>

                <!-- Save Buttons -->
                <div style="display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap;">
                    <button class="btn" onclick="saveHomeContent()" title="Save all changes to the database">💾 Save Changes</button>
                    <button class="btn btn-secondary" onclick="loadHomeContent()" title="Reload content from database (discards unsaved changes)">🔄 Reload Content</button>
                    <button class="btn btn-secondary" onclick="exportContent()" title="Download current configuration as JSON backup">📥 Export JSON</button>
                    <button class="btn btn-secondary" onclick="importContent()" title="Upload JSON file to restore configuration">📤 Import JSON</button>
                </div>
            </div>

            <!-- Courses Section -->
            <div class="content-section" id="courses">
                <div class="section-header">
                    <div class="section-title">Courses Management</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success add-course-btn" id="addCourseBtn" onclick="showAddCourseForm()">➕ Add New Course</button>
                        <button class="btn btn-small" onclick="loadAllCourses()">🔄 Refresh</button>
                    </div>
                </div>

                <!-- Course List -->
                <div id="coursesList" style="margin-bottom: 30px;">
                    <div style="text-align: center; padding: 40px; color: #999;">
                        Loading courses...
                    </div>
                </div>

                <!-- Add/Edit Course Form (hidden by default) -->
                <div id="courseForm" style="display: none; background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h3 id="courseFormTitle">Add New Course</h3>

                    <input type="hidden" id="course_id">

                    <div class="form-group">
                        <label>📘 Course Title *</label>
                        <input type="text" id="courseTitle" name="title" placeholder="Enter course title" required>
                    </div>

                    <div class="form-group">
                        <label>📝 Description *</label>
                        <textarea id="courseDescription" name="description" placeholder="Enter course description" rows="4" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>🎯 Short Description</label>
                        <input type="text" id="courseShortDescription" name="short_description" placeholder="Brief course summary">
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>💰 Price</label>
                            <input type="number" id="coursePrice" name="price" placeholder="99.99" step="0.01">
                        </div>

                        <div class="form-group">
                            <label>🏷️ Old Price (for discount display)</label>
                            <input type="number" id="courseOldPrice" name="old_price" placeholder="149.99" step="0.01">
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>⏱️ Duration</label>
                            <input type="text" id="courseDuration" name="duration" placeholder="e.g., 8 weeks, 30 hours">
                        </div>

                        <div class="form-group">
                            <label>📊 Level</label>
                            <select id="courseLevel" name="level">
                                <option value="">Select Level</option>
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                                <option value="All Levels">All Levels</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>🏷️ Category</label>
                        <select id="courseCategory" name="category" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">Select Category</option>
                            <option value="Web Development">Web Development</option>
                            <option value="App Development">App Development</option>
                            <option value="Machine Learning">Machine Learning</option>
                            <option value="Cloud Computing">Cloud Computing</option>
                            <option value="Data Science">Data Science</option>
                            <option value="Artificial Intelligence">Artificial Intelligence</option>
                            <option value="DevOps">DevOps</option>
                            <option value="Cybersecurity">Cybersecurity</option>
                            <option value="Blockchain">Blockchain</option>
                            <option value="General">General</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>👨‍🏫 Instructor</label>
                        <input type="text" id="courseInstructor" name="instructor" placeholder="Instructor name">
                    </div>

                    <div class="form-group">
                        <label>🖼️ Course Image</label>
                        <div style="margin-bottom: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                                <input type="radio" name="imageType" value="static" checked onchange="toggleImageInput()">
                                📦 Select Static Image
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer; margin-top: 5px;">
                                <input type="radio" name="imageType" value="custom" onchange="toggleImageInput()">
                                🔗 Custom Image URL
                            </label>
                        </div>

                        <div id="staticImageSelector" style="margin-bottom: 10px;">
                            <select id="courseImageSelect" name="image_select" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">Select a Static Image</option>
                                <option value="images/course-react.jpg">React & Redux (course-react.jpg)</option>
                                <option value="images/course-nodejs.jpg">Node.js Backend (course-nodejs.jpg)</option>
                                <option value="images/course-python.jpg">Python for Data Science (course-python.jpg)</option>
                                <option value="images/course-javascript.jpg">JavaScript Fundamentals (course-javascript.jpg)</option>
                                <option value="images/course-fullstack.jpg">Full Stack Web Dev (course-fullstack.jpg)</option>
                                <option value="images/course-mobile.jpg">Mobile App Development (course-mobile.jpg)</option>
                                <option value="images/course-ml.jpg">Machine Learning (course-ml.jpg)</option>
                                <option value="images/course-aws.jpg">Cloud Computing AWS (course-aws.jpg)</option>
                                <option value="images/course-database.jpg">Database Design & SQL (course-database.jpg)</option>
                                <option value="images/course-design.jpg">UI/UX Design (course-design.jpg)</option>
                                <option value="images/course-devops.jpg">DevOps & CI/CD (course-devops.jpg)</option>
                                <option value="images/course-analytics.jpg">Data Analytics (course-analytics.jpg)</option>
                            </select>
                        </div>

                        <div id="customImageInput" style="display: none;">
                            <input type="url" id="courseImageURL" name="image_url" placeholder="https://example.com/course-image.jpg">
                        </div>

                        <input type="hidden" id="courseImage" name="image">

                        <div id="imagePreview" style="margin-top: 10px; display: none;">
                            <img id="previewImg" src="" alt="Course Image Preview" style="max-width: 200px; max-height: 150px; border-radius: 8px; border: 2px solid #ddd;">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>🎥 Video URL (for preview)</label>
                        <input type="url" id="course_video_url" placeholder="https://youtube.com/watch?v=...">
                    </div>

                    <div class="form-group">
                        <label>🔗 Course Link/URL</label>
                        <input type="url" id="course_link" placeholder="https://example.com/course-page">
                    </div>

                    <div class="form-group">
                        <label>⭐ Rating (1-5)</label>
                        <input type="number" id="course_rating" placeholder="4.5" min="0" max="5" step="0.1">
                    </div>

                    <div class="form-group">
                        <label>👥 Students Enrolled</label>
                        <input type="number" id="course_students" placeholder="1500">
                    </div>

                    <div class="form-group">
                        <label>💬 Reviews Count</label>
                        <input type="text" id="course_reviews" placeholder="e.g. 2,340">
                    </div>

                    <div class="form-group">
                        <label>📚 Lessons Count</label>
                        <input type="text" id="course_lessons" placeholder="e.g. 120">
                    </div>

                    <div class="form-group">
                        <label>🚀 Features (comma-separated)</label>
                        <textarea id="course_features" placeholder="Live sessions, Projects, Certificate, Support" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label>📚 Syllabus/Modules (one per line)</label>
                        <textarea id="course_syllabus" placeholder="Module 1: Introduction&#10;Module 2: Advanced Topics&#10;Module 3: Projects" rows="4"></textarea>
                    </div>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="course_featured" >
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Featured Course</span>
                    </div>

                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="course_visible" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Course Visible</span>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn" onclick="saveCourse()">💾 Save Course</button>
                        <button class="btn btn-secondary" onclick="cancelCourseForm()">❌ Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Pricing Content -->
            <div class="content-section" id="pricing">
                <div class="section-header">
                    <div class="section-title">Pricing Page Management</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success" onclick="savePricingData()">💾 Save Changes</button>
                        <button class="btn btn-small" onclick="loadPricingData()">🔄 Refresh</button>
                    </div>
                </div>

                <div id="pricingContent">
                    <!-- Hero Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">🎯 Hero Section</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_hero_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="pricing_hero_title" placeholder="Hero Title (e.g., Choose Your Learning Path)" class="mb-10">
                        <textarea id="pricing_hero_subtitle" placeholder="Hero Subtitle" rows="2" class="mb-10"></textarea>
                    </div>

                    <!-- Pricing Plans -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">💰 Pricing Plans</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_plans_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <textarea id="pricing_plans_description" placeholder="Plans section description (e.g., 'Dive into a world of learning with diverse courses...')" rows="2" class="mb-10"></textarea>
                        <div class="list-manager mt-20">
                            <div class="list-item-header">
                                <strong>Pricing Plans</strong>
                                <button class="btn btn-small btn-success" onclick="addPricingPlanItem()">+ Add Plan</button>
                            </div>
                            <div id="pricingPlansList"></div>
                        </div>
                    </div>

                    <!-- Features Comparison Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">🔍 Features Comparison</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_features_comparison_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="pricing_features_comparison_title" placeholder="Features Comparison Title" class="mb-10">
                        <textarea id="pricing_features_comparison_subtitle" placeholder="Features Comparison Subtitle" rows="2" class="mb-10"></textarea>
                        <textarea id="pricing_features_comparison_description" placeholder="Features Comparison Description" rows="3" class="mb-10"></textarea>
                    </div>

                    <!-- FAQs Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">❓ FAQs</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_faqs_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="pricing_faqs_title" placeholder="FAQs Title" class="mb-10">
                        <textarea id="pricing_faqs_subtitle" placeholder="FAQs Subtitle" rows="2" class="mb-10"></textarea>
                        <textarea id="pricing_faqs_description" placeholder="FAQs Content" rows="3" class="mb-10"></textarea>
                    </div>

                    <!-- Testimonials Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">💬 Testimonials</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_testimonials_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="pricing_testimonials_title" placeholder="Testimonials Title" class="mb-10">
                        <textarea id="pricing_testimonials_subtitle" placeholder="Testimonials Subtitle" rows="2" class="mb-10"></textarea>
                        <textarea id="pricing_testimonials_description" placeholder="Testimonials Content" rows="3" class="mb-10"></textarea>
                    </div>

                    <!-- CTA Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">📢 Call to Action</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="pricing_cta_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="pricing_cta_title" placeholder="CTA Title" class="mb-10">
                        <textarea id="pricing_cta_description" placeholder="CTA Description" rows="2" class="mb-10"></textarea>
                        <input type="text" id="pricing_cta_button_text" placeholder="Button Text" class="mb-10">
                        <input type="text" id="pricing_cta_button_url" placeholder="Button URL" class="mb-10">
                    </div>
                </div>
            </div>

            <!-- Teachers Content -->
            <div class="content-section" id="teachers">
                <div class="section-header">
                    <div class="section-title">Teachers Page Management</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success" onclick="saveTeachersData()">💾 Save Changes</button>
                        <button class="btn btn-small" onclick="loadTeachersData()">🔄 Refresh</button>
                    </div>
                </div>

                <div id="teachersContent">
                    <!-- Teacher Profiles Management -->
                    <div class="form-group" style="border: 2px solid #667eea; padding: 20px; border-radius: 8px; margin-bottom: 30px; background: #f8f9ff;">
                        <div class="section-header" style="margin-bottom: 20px;">
                            <div class="section-title" style="color: #667eea; font-size: 18px; font-weight: 600;">👨‍🏫 Teacher Profiles Management</div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-small btn-success" onclick="showAddTeacherForm()">➕ Add New Teacher</button>
                                <button class="btn btn-small" onclick="loadAllTeachers()">🔄 Refresh</button>
                            </div>
                        </div>

                        <div id="teachersList" style="margin-bottom: 20px; min-height: 100px; background: #f9f9f9; padding: 10px; border-radius: 8px;">
                            <!-- Teacher list will be populated here -->
                            <div style="text-align: center; padding: 20px; color: #999;">
                                <span class="spinner">⏳</span> Loading teachers...
                                <br><br>
                                <button onclick="loadAllTeachers()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                                    Click here if teachers don't load automatically
                                </button>
                            </div>
                        </div>

                        <!-- Add/Edit Teacher Form (hidden by default) -->
                        <div id="teacherForm" style="display: none; background: white; padding: 20px; border-radius: 8px; border: 1px solid #ddd;">
                            <h3 id="teacherFormTitle">Add New Teacher</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                                <input type="text" id="teacher_full_name" placeholder="Full Name" class="mb-10" required>
                                <input type="text" id="teacher_key" placeholder="Teacher Key (e.g., sarah-chen)" class="mb-10" required>
                                <input type="text" id="teacher_professional_title" placeholder="Professional Title" class="mb-10">
                                <input type="text" id="teacher_company" placeholder="Company" class="mb-10">
                                <input type="url" id="teacher_profile_image_url" placeholder="Profile Image URL" class="mb-10">
                                <input type="email" id="teacher_email" placeholder="Email" class="mb-10">
                            </div>
                            <textarea id="teacher_bio" placeholder="Bio" rows="3" class="mb-10" style="width: 100%;"></textarea>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div>
                                    <label>Skills (comma-separated):</label>
                                    <textarea id="teacher_skills" placeholder="Machine Learning, Python, TensorFlow" rows="2" class="mb-10"></textarea>
                                </div>
                                <div>
                                    <label>📊 Professional Statistics (Displayed in Teacher Profile):</label>
                                    <div style="background: #f8f9ff; padding: 15px; border-radius: 8px; border: 1px solid #667eea;">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                            <div>
                                                <label style="font-size: 12px; color: #667eea; font-weight: 600;">Years Experience (8+)</label>
                                                <input type="number" id="teacher_years_experience" placeholder="8" class="mb-10">
                                            </div>
                                            <div>
                                                <label style="font-size: 12px; color: #667eea; font-weight: 600;">Students Taught (570+)</label>
                                                <input type="number" id="teacher_students_taught" placeholder="570" class="mb-10">
                                            </div>
                                            <div>
                                                <label style="font-size: 12px; color: #667eea; font-weight: 600;">Courses Count (12)</label>
                                                <input type="number" id="teacher_courses_count" placeholder="12" class="mb-10">
                                            </div>
                                            <div>
                                                <label style="font-size: 12px; color: #667eea; font-weight: 600;">Rating (4.8/5)</label>
                                                <input type="number" id="teacher_rating" placeholder="4.8" step="0.1" max="5" class="mb-10">
                                            </div>
                                        </div>
                                        <div style="margin-top: 10px; padding: 8px; background: #e8edff; border-radius: 4px; font-size: 12px; color: #4a5568;">
                                            💡 <strong>These statistics appear prominently in the teacher's profile page</strong> - they're the first thing students see!
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="teacher_is_featured">
                                    Featured
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="teacher_is_active" checked>
                                    Active
                                </label>
                                <input type="number" id="teacher_display_order" placeholder="Display Order" style="width: 120px;">
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button class="btn btn-success" onclick="saveTeacherData()">💾 Save Teacher</button>
                                <button class="btn" onclick="cancelTeacherForm()">❌ Cancel</button>
                                <button class="btn btn-secondary" onclick="previewTeacher()" id="previewTeacherBtn" style="display: none;">👁️ Preview</button>
                            </div>
                        </div>
                    </div>

                    <!-- Teacher Edit Modal (Comprehensive) -->
                    <div id="teacherModal" class="modal" style="display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6);">
                        <div class="modal-content" style="background-color: white; margin: 1% auto; padding: 0; border: none; border-radius: 12px; width: 95%; max-width: 1400px; height: 95vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);">
                            <!-- Modal Header -->
                            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center; border-radius: 12px 12px 0 0;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="background: rgba(255,255,255,0.2); padding: 8px; border-radius: 8px;">👨‍🏫</div>
                                    <h3 id="teacherModalTitle" style="margin: 0; font-size: 24px; font-weight: 600;">Edit: Teacher Name</h3>
                                </div>
                                <span class="close" onclick="closeTeacherModal()" style="color: white; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s ease; padding: 5px;">&times;</span>
                            </div>

                            <!-- Modal Navigation Tabs -->
                            <div class="teacher-modal-tabs" style="background: #f8f9fa; padding: 0 30px; display: flex; gap: 2px; border-bottom: 1px solid #e2e8f0;">
                                <button class="teacher-modal-tab active" onclick="switchTeacherTab('basic')" data-tab="basic" style="background: white; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; font-weight: 600; color: #667eea; cursor: pointer; margin-top: 10px; position: relative;">📋 Basic Info</button>
                                <button class="teacher-modal-tab" onclick="switchTeacherTab('details')" data-tab="details" style="background: #e2e8f0; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; font-weight: 600; color: #718096; cursor: pointer; margin-top: 10px;">📊 Details</button>
                                <button class="teacher-modal-tab" onclick="switchTeacherTab('experience')" data-tab="experience" style="background: #e2e8f0; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; font-weight: 600; color: #718096; cursor: pointer; margin-top: 10px;">💼 Experience</button>
                                <button class="teacher-modal-tab" onclick="switchTeacherTab('courses')" data-tab="courses" style="background: #e2e8f0; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; font-weight: 600; color: #718096; cursor: pointer; margin-top: 10px;">📚 Courses</button>
                                <button class="teacher-modal-tab" onclick="switchTeacherTab('media')" data-tab="media" style="background: #e2e8f0; border: none; padding: 12px 20px; border-radius: 8px 8px 0 0; font-weight: 600; color: #718096; cursor: pointer; margin-top: 10px;">🎬 Media</button>
                            </div>

                            <!-- Modal Content Area -->
                            <div style="flex: 1; overflow-y: auto; padding: 30px;">
                                <!-- Basic Info Tab -->
                                <div class="teacher-tab-content" id="teacher-tab-basic">
                                    <!-- Language Switcher for Teacher Modal -->
                                    <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; padding: 15px; background: #f7fafc; border-radius: 8px;">
                                        <button class="teacher-lang-btn" data-lang="en" onclick="switchTeacherLanguage('en')" style="padding: 8px 20px; border: 2px solid #e2e8f0; background: white; color: #4a5568; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">🇬🇧 English</button>
                                        <button class="teacher-lang-btn" data-lang="ru" onclick="switchTeacherLanguage('ru')" style="padding: 8px 20px; border: 2px solid #e2e8f0; background: white; color: #4a5568; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">🇷🇺 Russian</button>
                                        <button class="teacher-lang-btn" data-lang="he" onclick="switchTeacherLanguage('he')" style="padding: 8px 20px; border: 2px solid #e2e8f0; background: white; color: #4a5568; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;">🇮🇱 Hebrew</button>
                                    </div>

                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                                        <div>
                                            <h4 style="margin-bottom: 20px; color: #2d3748; font-size: 18px;">📋 Teacher Information</h4>
                                            <div style="display: grid; gap: 20px;">
                                                <div>
                                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Full Name *</label>
                                                    <input type="text" id="teacher-modal-name" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                                </div>
                                                <div>
                                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Teacher Key (URL)</label>
                                                    <input type="text" id="teacher-modal-key" placeholder="sarah-chen" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                                </div>
                                                <div>
                                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Professional Title</label>
                                                    <input type="text" id="teacher-modal-title" placeholder="AI & Machine Learning Expert" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                                </div>
                                                <div>
                                                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Company</label>
                                                    <input type="text" id="teacher-modal-company" placeholder="TechEd Solutions" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 style="margin-bottom: 20px; color: #2d3748; font-size: 18px;">📝 Description</h4>
                                            <div>
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Bio</label>
                                                <textarea id="teacher-modal-bio" rows="8" placeholder="Professional background and teaching experience..." style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; resize: vertical;"></textarea>
                                            </div>
                                            <div style="margin-top: 20px;">
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Skills (comma-separated)</label>
                                                <textarea id="teacher-modal-skills" rows="3" placeholder="Machine Learning, Python, TensorFlow, AI Ethics" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; resize: vertical;"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Details Tab -->
                                <div class="teacher-tab-content" id="teacher-tab-details" style="display: none;">
                                    <h4 style="margin-bottom: 20px; color: #2d3748; font-size: 18px;">📊 Professional Statistics</h4>
                                    <div style="background: #f8f9ff; padding: 25px; border-radius: 12px; border: 2px solid #667eea;">
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                                            <div>
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">Years Experience</label>
                                                <input type="number" id="teacher-modal-years" placeholder="8" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">Students Taught</label>
                                                <input type="number" id="teacher-modal-students" placeholder="570" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">Courses Count</label>
                                                <input type="number" id="teacher-modal-courses-count" placeholder="12" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #667eea;">Rating (1-5)</label>
                                                <input type="number" id="teacher-modal-rating" placeholder="4.8" step="0.1" max="5" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                            </div>
                                        </div>
                                        <div style="background: #e8edff; padding: 15px; border-radius: 8px; font-size: 14px; color: #4a5568;">
                                            💡 <strong>These statistics appear prominently in the teacher's profile page</strong> - they're the first thing students see!
                                        </div>
                                    </div>

                                    <h4 style="margin: 30px 0 20px 0; color: #2d3748; font-size: 18px;">📞 Contact & Social</h4>
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Email Address</label>
                                            <input type="email" id="teacher-modal-email" placeholder="sarah@teched.solutions" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Phone Number</label>
                                            <input type="text" id="teacher-modal-phone" placeholder="+1-555-0123" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">LinkedIn Profile</label>
                                            <input type="url" id="teacher-modal-linkedin" placeholder="https://linkedin.com/in/sarah-chen-ai" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">GitHub Profile</label>
                                            <input type="url" id="teacher-modal-github" placeholder="https://github.com/sarahchen" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                        </div>
                                    </div>
                                </div>

                                <!-- Experience Tab -->
                                <div class="teacher-tab-content" id="teacher-tab-experience" style="display: none;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                        <h4 style="margin: 0; color: #2d3748; font-size: 18px;">💼 Professional Experience</h4>
                                        <button onclick="addExperienceItem()" style="background: #10b981; color: white; border: none; padding: 10px 16px; border-radius: 8px; font-weight: 600; cursor: pointer;">➕ Add Experience</button>
                                    </div>
                                    <div id="experienceList" style="display: grid; gap: 20px;"></div>
                                </div>

                                <!-- Courses Tab -->
                                <div class="teacher-tab-content" id="teacher-tab-courses" style="display: none;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                        <h4 style="margin: 0; color: #2d3748; font-size: 18px;">📚 Courses Taught</h4>
                                        <button onclick="addCourseItem()" style="background: #10b981; color: white; border: none; padding: 10px 16px; border-radius: 8px; font-weight: 600; cursor: pointer;">➕ Add Course</button>
                                    </div>
                                    <div id="coursesTaughtList" style="display: grid; gap: 20px;"></div>
                                </div>

                                <!-- Media Tab -->
                                <div class="teacher-tab-content" id="teacher-tab-media" style="display: none;">
                                    <h4 style="margin-bottom: 20px; color: #2d3748; font-size: 18px;">🎬 Media & Images</h4>
                                    <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
                                        <div>
                                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Profile Image URL</label>
                                            <input type="url" id="teacher-modal-image" placeholder="images/teacher-profile.jpg" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                        </div>
                                        <div>
                                            <h5 style="margin-bottom: 15px; color: #2d3748;">⭐ Student Reviews</h5>
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                                <span style="font-weight: 600;">Manage Student Testimonials</span>
                                                <button onclick="addReviewItem()" style="background: #10b981; color: white; border: none; padding: 8px 14px; border-radius: 6px; font-weight: 600; cursor: pointer;">➕ Add Review</button>
                                            </div>
                                            <div id="reviewsList" style="display: grid; gap: 15px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Modal Footer -->
                            <div class="modal-footer" style="background: #f8f9fa; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center; border-radius: 0 0 12px 12px; border-top: 1px solid #e2e8f0;">
                                <div class="auto-save-status" id="teacher-modal-auto-save-status" style="font-size: 14px; color: #718096;">Ready to save</div>
                                <div class="modal-actions" style="display: flex; gap: 12px;">
                                    <button onclick="previewTeacherFromModal()" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: #10b981; color: white; display: flex; align-items: center; gap: 8px;">
                                        <span>👁️</span> Preview Teacher Page
                                    </button>
                                    <button onclick="closeTeacherModal()" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: #e2e8f0; color: #4a5568;">Cancel</button>
                                    <button onclick="saveTeacherData('save_and_continue')" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: #667eea; color: white; display: flex; align-items: center; gap: 8px;">
                                        <span>💾</span> Save & Continue
                                    </button>
                                    <button onclick="saveTeacherData('save_and_close')" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; display: flex; align-items: center; gap: 8px;">
                                        <span>✅</span> Save & Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Teachers Page Management -->
                    <div style="border-top: 2px solid #e0e0e0; padding-top: 20px;">
                        <div class="section-title" style="margin-bottom: 20px; color: #666;">📄 Teachers Page Content Management</div>

                    <!-- Hero Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">🎯 Hero Section</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="teachers_hero_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="teachers_hero_title" placeholder="Hero Title (e.g., Our Teachers)" class="mb-10">
                        <input type="text" id="teachers_hero_subtitle" placeholder="Hero Subtitle (e.g., Meet Our Team)" class="mb-10">
                        <textarea id="teachers_hero_description" placeholder="Hero Description" rows="2" class="mb-10"></textarea>
                    </div>

                    <!-- Instructor Grid Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">👨‍🏫 Instructor Grid</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="teachers_instructor_grid_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="teachers_instructor_grid_title" placeholder="Section Title" class="mb-10">
                        <input type="text" id="teachers_instructor_grid_subtitle" placeholder="Section Subtitle" class="mb-10">
                        <textarea id="teachers_instructor_grid_description" placeholder="Section Description" rows="3" class="mb-10"></textarea>

                        <div class="list-manager mt-20">
                            <div class="list-item-header">
                                <strong>Instructors</strong>
                                <button class="btn btn-small btn-success" onclick="addInstructorItem()">+ Add Instructor</button>
                            </div>
                            <div id="instructorsList"></div>
                        </div>
                    </div>

                    <!-- Become Instructor Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">📢 Become Instructor CTA</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="teachers_become_instructor_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>
                        <input type="text" id="teachers_become_instructor_title" placeholder="CTA Title" class="mb-10">
                        <input type="text" id="teachers_become_instructor_subtitle" placeholder="CTA Subtitle" class="mb-10">
                        <textarea id="teachers_become_instructor_description" placeholder="CTA Description" rows="2" class="mb-10"></textarea>
                        <input type="text" id="teachers_become_instructor_primary_button" placeholder="Primary Button Text" class="mb-10">
                        <input type="text" id="teachers_become_instructor_primary_link" placeholder="Primary Button Link" class="mb-10">
                        <input type="text" id="teachers_become_instructor_secondary_button" placeholder="Secondary Button Text" class="mb-10">
                        <input type="text" id="teachers_become_instructor_secondary_link" placeholder="Secondary Button Link" class="mb-10">
                    </div>

                    <!-- Stats Section -->
                    <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0;">📊 Stats Section</label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="teachers_stats_visible" checked>
                                <span>Visible</span>
                            </label>
                        </div>

                        <div class="list-manager mt-20">
                            <div class="list-item-header">
                                <strong>Stats Items</strong>
                                <button class="btn btn-small btn-success" onclick="addStatsItem()">+ Add Item</button>
                            </div>
                            <div id="statsList"></div>
                        </div>
                    </div>

                </div> <!-- Missing closing div 1 -->
                </div> <!-- Missing closing div 2 -->                </div> <!-- End teachersContent -->
            </div> <!-- End teachers section -->



            <div class="content-section" id="blogAdmin">
                <div class="section-header">
                    <div class="section-title">📝 Blog Posts Management</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success" onclick="openBlogCreateModal()">➕ Add New Blog Post</button>
                        <button class="btn btn-small" onclick="loadBlogAdmin()">🔄 Refresh</button>
                    </div>
                </div>

                <!-- Search -->
                <div style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label>🔍 Search Blog Posts</label>
                        <input type="text" id="blogAdmin-search-input" placeholder="Search by title, author, category..." style="width: 100%;" oninput="filterBlogAdminTable()">
                    </div>
                </div>

                <!-- Blog Table -->
                <div class="table-container" style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); overflow: hidden; margin-bottom: 20px;">
                    <table class="admin-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Title</th>
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Author</th>
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Category</th>
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Status</th>
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Published</th>
                                <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="blogAdmin-table-body">
                            <tr>
                                <td colspan="6" style="padding: 40px; text-align: center; color: #718096;">
                                    <div class="loading-spinner" style="display: inline-block; width: 30px; height: 30px; border: 3px solid #f3f3f3; border-top: 3px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 10px;"></div>
                                    <div>Loading blog posts...</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            </div> <!-- End blogAdmin section -->

            <div class="content-section" id="menu">
                <div class="section-header">
                    <div class="section-title">Navigation Menu</div>
                </div>
                <p>Menu management coming soon...</p>
            </div>

            <div class="content-section" id="footer">
                <div class="section-header">
                    <div class="section-title">Footer Content</div>
                </div>
                <p>Footer management coming soon...</p>
            </div>

            <div class="content-section" id="settings">
                <div class="section-header">
                    <div class="section-title">Global Settings</div>
                </div>

                <div class="form-group">
                    <label>🎬 Animation Settings</label>
                    <div class="visibility-group">
                        <label class="visibility-toggle">
                            <input type="checkbox" id="animations_enabled" checked>
                            <span class="visibility-slider"></span>
                        </label>
                        <span>Enable Animations Globally</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>🌍 Default Language</label>
                    <select id="default_language">
                        <option value="en">English</option>
                        <option value="ru">Russian</option>
                        <option value="he">Hebrew</option>
                    </select>
                </div>

                <button class="btn" onclick="saveSettings()">💾 Save Settings</button>
            </div>
            <!-- Career Center Platform Page Section -->
            <div class="content-section" id="career-platform">
                <div class="section-header">
                    <div class="section-title">Career Center Platform Page Management</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success" onclick="saveCareerPlatformData()">💾 Save Changes</button>
                        <button class="btn btn-small" onclick="loadCareerPlatformData()">🔄 Reload</button>
                    </div>
                </div>

                <!-- Hero Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">🎯 Hero Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-hero-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-hero-title" placeholder="Career Center Platform" class="mb-10">
                    <input type="text" id="career-platform-hero-subtitle" placeholder="Your Gateway to Professional Success" class="mb-10">
                    <textarea id="career-platform-hero-description" rows="3" placeholder="Connect with industry-leading career opportunities..." class="mb-10"></textarea>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <input type="text" id="career-platform-hero-button1-text" placeholder="Primary Button Text">
                        <input type="text" id="career-platform-hero-button1-url" placeholder="Primary Button URL">
                        <input type="text" id="career-platform-hero-button2-text" placeholder="Secondary Button Text">
                        <input type="text" id="career-platform-hero-button2-url" placeholder="Secondary Button URL">
                    </div>
                </div>

                <!-- Features Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">⚡ Features Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-features-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-features-title" placeholder="Platform Features" class="mb-10">
                    <input type="text" id="career-platform-features-subtitle" placeholder="Everything You Need for Career Success" class="mb-10">

                    <div id="career-platform-features-list" class="dynamic-list">
                        <!-- Features will be dynamically added here -->
                    </div>
                    <button class="btn btn-small" onclick="addCareerPlatformFeature()">➕ Add Feature</button>
                </div>

                <!-- Opportunities Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">🚀 Opportunities Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-opportunities-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-opportunities-title" placeholder="Career Opportunities" class="mb-10">
                    <input type="text" id="career-platform-opportunities-subtitle" placeholder="Discover Your Next Role" class="mb-10">
                    <textarea id="career-platform-opportunities-description" rows="2" placeholder="Browse through exclusive job opportunities..." class="mb-10"></textarea>
                    <div id="career-platform-categories-list" class="dynamic-list">
                        <!-- Categories will be dynamically added here -->
                    </div>
                    <button class="btn btn-small" onclick="addCareerPlatformCategory()">➕ Add Category</button>
                </div>

                <!-- Resources Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">📚 Resources Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-resources-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-resources-title" placeholder="Career Resources" class="mb-10">
                    <input type="text" id="career-platform-resources-subtitle" placeholder="Tools and Guides for Your Success" class="mb-10">
                    <div id="career-platform-resources-list" class="dynamic-list">
                        <!-- Resources will be dynamically added here -->
                    </div>
                    <button class="btn btn-small" onclick="addCareerPlatformResource()">➕ Add Resource</button>
                </div>

                <!-- Testimonials Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">💬 Testimonials Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-testimonials-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-testimonials-title" placeholder="Success Stories" class="mb-10">
                    <input type="text" id="career-platform-testimonials-subtitle" placeholder="From Our Platform Users" class="mb-10">
                    <div id="career-platform-testimonials-list" class="dynamic-list">
                        <!-- Testimonials will be dynamically added here -->
                    </div>
                    <button class="btn btn-small" onclick="addCareerPlatformTestimonial()">➕ Add Testimonial</button>
                </div>

                <!-- CTA Section -->
                <div class="form-group" style="border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <label style="margin: 0;">🎯 Call to Action Section</label>
                        <label style="display: flex; align-items: center; gap: 5px;">
                            <input type="checkbox" id="career-platform-cta-visible" checked>
                            <span>Visible</span>
                        </label>
                    </div>
                    <input type="text" id="career-platform-cta-title" placeholder="Ready to Advance Your Career?" class="mb-10">
                    <textarea id="career-platform-cta-description" rows="2" placeholder="Join thousands of professionals..." class="mb-10"></textarea>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <input type="text" id="career-platform-cta-button-text" placeholder="Button Text">
                        <input type="text" id="career-platform-cta-button-url" placeholder="Button URL">
                    </div>
                </div>
            </div>

            <!-- Database Tables Section -->
            <div class="content-section" id="database">
                <div class="section-header">
                    <div class="section-title">📊 Database Tables Reference</div>
                    <p style="color: #666; margin-top: 5px;">Each page/screen uses specific database tables for content management</p>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">🏠 Home Page</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_home</code></p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoint:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/home-page</code></p>
                        <p style="margin-bottom: 10px;"><strong>Sections:</strong> hero, navigation, features, course_categories, courses, stats, pricing, awards, faq, process, testimonials, testimonials_data, contact, footer</p>
                        <p><strong>Language Columns:</strong> content_en, content_ru, content_he</p>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">📚 Courses Page</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>UI Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_courses_page</code></p>
                        <p style="margin-bottom: 10px;"><strong>Data Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_courses</code></p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/courses-page</code> - UI translations</li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/courses</code> - Course data</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Language Support:</strong> UI elements and course data both support EN/RU/HE</p>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">📖 Course Details Page</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>UI Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_course_details_page</code></p>
                        <p style="margin-bottom: 10px;"><strong>Data Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_courses</code> (single course)</p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/course-details-page</code> - UI translations</li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/courses/:id</code> - Single course data</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">💰 Pricing Page</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_pricing_page</code></p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoint:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/pricing-page</code></p>
                        <p><strong>Content:</strong> Pricing plans, features, FAQ specific to pricing</p>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">👨‍🏫 Teachers Page</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>UI Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_teachers_page</code></p>
                        <p style="margin-bottom: 10px;"><strong>Data Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_teachers</code></p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/teachers-page</code> - UI translations</li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/teachers</code> - Teacher data</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">🎯 Career Center & Orientation</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>Tables:</strong></p>
                        <ul style="margin-left: 20px; margin-bottom: 10px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_career_center_page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_career_orientation_page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_career_center_platform_page</code></li>
                        </ul>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/career-center-page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/career-orientation-page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/career-center-platform-page</code></li>
                        </ul>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">ℹ️ About & Contact Pages</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>Tables:</strong></p>
                        <ul style="margin-left: 20px; margin-bottom: 10px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_about_page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_contact_page</code></li>
                        </ul>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/about-page</code></li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/contact-page</code></li>
                        </ul>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">📝 Blog</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <p style="margin-bottom: 10px;"><strong>UI Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_blog_page</code></p>
                        <p style="margin-bottom: 10px;"><strong>Data Table:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_blog_posts</code></p>
                        <p style="margin-bottom: 10px;"><strong>API Endpoints:</strong></p>
                        <ul style="margin-left: 20px; list-style-type: disc;">
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/blog-page</code> - UI translations</li>
                            <li><code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">/api/nd/blog-posts</code> - Blog posts data</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group" style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">🔧 Shared Components</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #764ba2;">
                        <p style="margin-bottom: 10px;"><strong>Navigation Menu:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_menu</code></p>
                        <p style="margin-bottom: 10px;"><strong>Footer:</strong> <code style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">nd_footer</code></p>
                        <p style="margin-bottom: 10px;"><strong>Used on:</strong> All pages</p>
                        <p><strong>Note:</strong> These components are shared across all pages and managed separately</p>
                    </div>
                </div>

                <div style="background: #fff5f5; border: 2px solid #fed7d7; padding: 20px; border-radius: 12px; margin-top: 30px;">
                    <h4 style="color: #c53030; margin-bottom: 15px;">⚠️ Important Notes:</h4>
                    <ul style="margin-left: 20px; color: #742a2a; line-height: 1.8;">
                        <li>All tables use <strong>JSONB columns</strong> for flexible content structure</li>
                        <li>Language columns: <code>content_en</code>, <code>content_ru</code>, <code>content_he</code></li>
                        <li>All content supports multi-language (EN/RU/HE)</li>
                        <li>Hebrew (HE) requires RTL layout support</li>
                        <li>Use <code>preview=true</code> parameter to see unpublished changes</li>
                        <li>Changes are immediate - no build process required</li>
                        <li>Database: PostgreSQL on Railway cloud platform</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Toaster Container -->
    <div class="toaster-container" id="toasterContainer"></div>

    <!-- 🔒 SECURITY DEPENDENCIES FOR XSS PROTECTION -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.9/dist/purify.min.js"></script>
    <script src="js/security-utils.js"></script>

    <script>
        // API Configuration
        const API_BASE = window.location.hostname === 'localhost'
            ? 'http://localhost:3000/api'
            : 'https://aistudio555jamstack-production.up.railway.app/api';

        // Current language
        let currentLang = 'en';

        // Admin interface translations
        const adminTranslations = {
            en: {
                title: "🎨 New Design Content Manager",
                subtitle: "Manage content for the new design with visibility controls and multi-language support",
                blogTable: {
                    title: "Blog Post",
                    author: "Author",
                    category: "Category",
                    status: "Status",
                    published: "Published",
                    actions: "Actions",
                    edit: "Edit",
                    view: "View",
                    delete: "Delete",
                    search: "Search by title, author, category...",
                    addNew: "Add New Blog Post",
                    refresh: "Refresh"
                },
                tabs: {
                    home: "Home Page",
                    courses: "Courses",
                    pricing: "Pricing",
                    "career-platform": "Career Platform",
                    teachers: "Teachers",
                    blogAdmin: "BlogAdmin",
                    blog: "Blog",
                    menu: "Navigation",
                    footer: "Footer",
                    settings: "Settings"
                },
                sections: {
                    hero: "🦸 Hero Section",
                    features: "✨ Features Section",
                    courses: "📚 Courses Section",
                    testimonials: "💬 Testimonials",
                    awards: "🏆 Awards Section",
                    pricing: "💰 Pricing Plans",
                    instructor_grid: "👨‍🏫 Instructor Grid",
                    become_instructor: "📢 Become Instructor CTA",
                    stats: "📊 Stats Section",
                    plans: "💰 Pricing Plans",
                    features_comparison: "🔍 Features Comparison",
                    faqs: "❓ FAQs",
                    cta: "📢 Call to Action"
                },
                buttons: {
                    save: "💾 Save Changes",
                    refresh: "🔄 Refresh",
                    preview: "👁️ Preview",
                    clear: "Clear",
                    add_instructor: "+ Add Instructor",
                    add_plan: "+ Add Plan",
                    add_item: "+ Add Item",
                    add_feature: "+ Add Feature",
                    add_course: "+ Add Course",
                    add_testimonial: "+ Add Testimonial",
                    add_award: "+ Add Award",
                    add_button: "+ Add Button",
                    remove: "Remove",
                    export: "📥 Export JSON",
                    import: "📤 Import JSON",
                    reload: "🔄 Reload Content"
                },
                fields: {
                    visible: "Visible",
                    title: "Title",
                    subtitle: "Subtitle",
                    description: "Description",
                    name: "Name",
                    expertise: "Expertise",
                    bio: "Bio/Description",
                    image: "Image URL",
                    profile_link: "Profile Link",
                    button_text: "Button Text",
                    button_url: "Button URL",
                    instructor: "Instructor"
                },
                placeholders: {
                    search: "🔍 Search for any content, field, or value across all sections...",
                    hero_title: "Hero Title",
                    hero_subtitle: "Hero Subtitle",
                    hero_description: "Hero Description",
                    features_title: "Features Title",
                    features_subtitle: "Features Subtitle",
                    courses_title: "Courses Title",
                    courses_subtitle: "Courses Subtitle",
                    testimonials_title: "Testimonials Title",
                    testimonials_subtitle: "Testimonials Subtitle",
                    awards_title: "Awards Title (e.g., Awards That Define Our Excellence.)",
                    awards_subtitle: "Awards Subtitle",
                    pricing_title: "Pricing Title (e.g., Choose Your Learning Path)",
                    pricing_subtitle: "Pricing Subtitle (e.g., Flexible Pricing Plans)",
                    cta_title: "CTA Title",
                    cta_description: "CTA Description",
                    instructor_name: "Instructor name",
                    section_title: "Section Title",
                    section_subtitle: "Section Subtitle",
                    section_description: "Section Description"
                },
                labels: {
                    hero_section: "🦸 Hero Section",
                    features_section: "✨ Features Section",
                    courses_section: "📚 Courses Section",
                    testimonials_section: "💬 Testimonials Section",
                    awards_section: "🏆 Awards Section",
                    pricing_section: "💰 Pricing Plans",
                    cta_section: "📢 Call to Action",
                    instructor_grid: "👨‍🏫 Instructor Grid",
                    become_instructor: "📢 Become Instructor CTA",
                    search_results: "Search Results",
                    loading_results: "Loading results...",
                    no_results: "No results found"
                },
                messages: {
                    loading: "Loading...",
                    success: "Success",
                    error: "Error",
                    saved: "Changes saved successfully",
                    save_error: "Error saving changes",
                    content_loaded: "Content loaded successfully",
                    content_updated: "Content updated successfully"
                }
            },
            ru: {
                title: "🎨 Менеджер Контента Нового Дизайна",
                subtitle: "Управление контентом для нового дизайна с контролем видимости и мультиязычной поддержкой",
                blogTable: {
                    title: "Запись блога",
                    author: "Автор",
                    category: "Категория",
                    status: "Статус",
                    published: "Опубликовано",
                    actions: "Действия",
                    edit: "Редактировать",
                    view: "Просмотр",
                    delete: "Удалить",
                    search: "Поиск по заголовку, автору, категории...",
                    addNew: "Добавить новую запись",
                    refresh: "Обновить"
                },
                tabs: {
                    home: "Главная",
                    courses: "Курсы",
                    pricing: "Цены",
                    "career-platform": "Карьерная Платформа",
                    teachers: "Преподаватели",
                    blogAdmin: "Админ Блога",
                    blog: "Блог",
                    menu: "Навигация",
                    footer: "Подвал",
                    settings: "Настройки"
                },
                sections: {
                    hero: "🦸 Главный Раздел",
                    features: "✨ Раздел Функций",
                    courses: "📚 Раздел Курсов",
                    testimonials: "💬 Отзывы",
                    awards: "🏆 Награды",
                    pricing: "💰 Ценовые Планы",
                    instructor_grid: "👨‍🏫 Сетка Преподавателей",
                    become_instructor: "📢 Стать Преподавателем",
                    stats: "📊 Статистика",
                    plans: "💰 Тарифные Планы",
                    features_comparison: "🔍 Сравнение Функций",
                    faqs: "❓ Часто Задаваемые Вопросы",
                    cta: "📢 Призыв к Действию"
                },
                buttons: {
                    save: "💾 Сохранить Изменения",
                    refresh: "🔄 Обновить",
                    preview: "👁️ Предпросмотр",
                    clear: "Очистить",
                    add_instructor: "+ Добавить Преподавателя",
                    add_plan: "+ Добавить План",
                    add_item: "+ Добавить Элемент",
                    add_feature: "+ Добавить Функцию",
                    add_course: "+ Добавить Курс",
                    add_testimonial: "+ Добавить Отзыв",
                    add_award: "+ Добавить Награду",
                    add_button: "+ Добавить Кнопку",
                    remove: "Удалить",
                    export: "📥 Экспорт JSON",
                    import: "📤 Импорт JSON",
                    reload: "🔄 Перезагрузить Контент"
                },
                fields: {
                    visible: "Видимость",
                    title: "Заголовок",
                    subtitle: "Подзаголовок",
                    description: "Описание",
                    name: "Имя",
                    expertise: "Специализация",
                    bio: "Биография/Описание",
                    image: "URL Изображения",
                    profile_link: "Ссылка на Профиль",
                    button_text: "Текст Кнопки",
                    button_url: "URL Кнопки",
                    instructor: "Преподаватель"
                },
                placeholders: {
                    search: "🔍 Поиск контента, полей или значений во всех разделах...",
                    hero_title: "Заголовок Главного Раздела",
                    hero_subtitle: "Подзаголовок Главного Раздела",
                    hero_description: "Описание Главного Раздела",
                    features_title: "Заголовок Раздела Функций",
                    features_subtitle: "Подзаголовок Раздела Функций",
                    courses_title: "Заголовок Раздела Курсов",
                    courses_subtitle: "Подзаголовок Раздела Курсов",
                    testimonials_title: "Заголовок Раздела Отзывов",
                    testimonials_subtitle: "Подзаголовок Раздела Отзывов",
                    awards_title: "Заголовок Раздела Наград (например, Награды, Определяющие Наше Превосходство.)",
                    awards_subtitle: "Подзаголовок Раздела Наград",
                    pricing_title: "Заголовок Раздела Цен (например, Выберите Свой Путь Обучения)",
                    pricing_subtitle: "Подзаголовок Раздела Цен (например, Гибкие Ценовые Планы)",
                    cta_title: "Заголовок Призыва к Действию",
                    cta_description: "Описание Призыва к Действию",
                    instructor_name: "Имя Преподавателя",
                    section_title: "Заголовок Раздела",
                    section_subtitle: "Подзаголовок Раздела",
                    section_description: "Описание Раздела"
                },
                labels: {
                    hero_section: "🦸 Главный Раздел",
                    features_section: "✨ Раздел Функций",
                    courses_section: "📚 Раздел Курсов",
                    testimonials_section: "💬 Раздел Отзывов",
                    awards_section: "🏆 Раздел Наград",
                    pricing_section: "💰 Ценовые Планы",
                    cta_section: "📢 Призыв к Действию",
                    instructor_grid: "👨‍🏫 Сетка Преподавателей",
                    become_instructor: "📢 Стать Преподавателем CTA",
                    search_results: "Результаты Поиска",
                    loading_results: "Загрузка результатов...",
                    no_results: "Результатов не найдено"
                },
                messages: {
                    loading: "Загрузка...",
                    success: "Успешно",
                    error: "Ошибка",
                    saved: "Изменения сохранены успешно",
                    save_error: "Ошибка при сохранении изменений",
                    content_loaded: "Контент загружен успешно",
                    content_updated: "Контент обновлен успешно"
                }
            },
            he: {
                title: "🎨 מנהל תוכן עיצוב חדש",
                subtitle: "ניהול תוכן לעיצוב החדש עם בקרת נראות ותמיכה רב-לשונית",
                blogTable: {
                    title: "פוסט בלוג",
                    author: "מחבר",
                    category: "קטגוריה",
                    status: "סטטוס",
                    published: "פורסם",
                    actions: "פעולות",
                    edit: "עריכה",
                    view: "צפייה",
                    delete: "מחיקה",
                    search: "חיפוש לפי כותרת, מחבר, קטגוריה...",
                    addNew: "הוסף פוסט בלוג חדש",
                    refresh: "רענן"
                },
                tabs: {
                    home: "עמוד הבית",
                    courses: "קורסים",
                    pricing: "תמחור",
                    "career-platform": "פלטפורמת קריירה",
                    teachers: "מרצים",
                    blogAdmin: "ניהול בלוג",
                    blog: "בלוג",
                    menu: "ניווט",
                    footer: "כותרת תחתונה",
                    settings: "הגדרות"
                },
                sections: {
                    hero: "🎯 קטע גיבור",
                    features: "✨ קטע תכונות",
                    courses: "📚 קטע קורסים",
                    testimonials: "💬 המלצות",
                    awards: "🏆 פרסים",
                    pricing: "💰 תוכניות תמחור",
                    instructor_grid: "👨‍🏫 רשת מרצים",
                    become_instructor: "📢 הפוך למרצה",
                    stats: "📊 קטע סטטיסטיקות",
                    plans: "💰 תוכניות תמחור",
                    features_comparison: "🔍 השוואת תכונות",
                    faqs: "❓ שאלות נפוצות",
                    cta: "📢 קריאה לפעולה"
                },
                buttons: {
                    save: "💾 שמור שינויים",
                    refresh: "🔄 רענן",
                    preview: "👁️ תצוגה מקדימה",
                    clear: "נקה",
                    add_instructor: "+ הוסף מרצה",
                    add_plan: "+ הוסף תוכנית",
                    add_item: "+ הוסף פריט",
                    add_feature: "+ הוסף תכונה",
                    add_course: "+ הוסף קורס",
                    add_testimonial: "+ הוסף המלצה",
                    add_award: "+ הוסף פרס",
                    add_button: "+ הוסף כפתור",
                    remove: "הסר",
                    export: "📥 ייצוא JSON",
                    import: "📤 ייבוא JSON",
                    reload: "🔄 טען מחדש תוכן"
                },
                fields: {
                    visible: "נראה",
                    title: "כותרת",
                    subtitle: "כותרת משנה",
                    description: "תיאור",
                    name: "שם",
                    expertise: "מומחיות",
                    bio: "ביוגרפיה/תיאור",
                    image: "URL תמונה",
                    profile_link: "קישור פרופיל",
                    button_text: "טקסט כפתור",
                    button_url: "URL כפתור",
                    instructor: "מרצה"
                },
                placeholders: {
                    search: "🔍 חיפוש תוכן, שדות או ערכים בכל הקטעים...",
                    hero_title: "כותרת קטע גיבור",
                    hero_subtitle: "כותרת משנה קטע גיבור",
                    hero_description: "תיאור קטע גיבור",
                    features_title: "כותרת קטע תכונות",
                    features_subtitle: "כותרת משנה קטע תכונות",
                    courses_title: "כותרת קטע קורסים",
                    courses_subtitle: "כותרת משנה קטע קורסים",
                    testimonials_title: "כותרת קטע המלצות",
                    testimonials_subtitle: "כותרת משנה קטע המלצות",
                    awards_title: "כותרת קטע פרסים (למשל, פרסים המגדירים את המצוינות שלנו.)",
                    awards_subtitle: "כותרת משנה קטע פרסים",
                    pricing_title: "כותרת קטע תמחור (למשל, בחר את נתיב הלמידה שלך)",
                    pricing_subtitle: "כותרת משנה קטע תמחור (למשל, תוכניות תמחור גמישות)",
                    cta_title: "כותרת קריאה לפעולה",
                    cta_description: "תיאור קריאה לפעולה",
                    instructor_name: "שם מרצה",
                    section_title: "כותרת קטע",
                    section_subtitle: "כותרת משנה קטע",
                    section_description: "תיאור קטע",
                    // PRICING TAB SPECIFIC PLACEHOLDERS - CRITICAL FIX
                    pricing_hero_title: "כותרת גיבור תמחור (למשל, בחר את נתיב הלמידה שלך)",
                    pricing_hero_subtitle: "כותרת משנה גיבור תמחור",
                    pricing_plans_description: "תיאור קטע תוכניות (למשל, 'היכנס לעולם של למידה עם קורסים מגוונים...')",
                    pricing_features_comparison_title: "כותרת השוואת תכונות",
                    pricing_features_comparison_subtitle: "כותרת משנה השוואת תכונות",
                    pricing_features_comparison_description: "תיאור השוואת תכונות",
                    pricing_faqs_title: "כותרת שאלות נפוצות",
                    pricing_faqs_subtitle: "כותרת משנה שאלות נפוצות",
                    pricing_faqs_description: "תוכן שאלות נפוצות",
                    pricing_testimonials_title: "כותרת המלצות",
                    pricing_testimonials_subtitle: "כותרת משנה המלצות",
                    pricing_testimonials_description: "תוכן המלצות",
                    pricing_cta_title: "כותרת קריאה לפעולה",
                    pricing_cta_description: "תיאור קריאה לפעולה",
                    pricing_cta_button_text: "טקסט כפתור",
                    pricing_cta_button_url: "URL כפתור",
                    // CAREER PLATFORM PLACEHOLDERS
                    career_platform_hero_title: "פלטפורמת מרכז הקריירה",
                    career_platform_hero_subtitle: "השער שלך להצלחה מקצועית",
                    career_platform_hero_description: "התחבר להזדמנויות קריירה מובילות בתעשייה...",
                    career_platform_hero_button1_text: "טקסט כפתור ראשי",
                    career_platform_hero_button1_url: "URL כפתור ראשי",
                    career_platform_hero_button2_text: "טקסט כפתור משני",
                    career_platform_hero_button2_url: "URL כפתור משני",
                    career_platform_features_title: "תכונות הפלטפורמה",
                    career_platform_features_subtitle: "כל מה שאתה צריך להצלחה בקריירה",
                    career_platform_opportunities_title: "הזדמנויות קריירה",
                    career_platform_opportunities_subtitle: "גלה את התפקיד הבא שלך",
                    career_platform_opportunities_description: "עיין בהזדמנויות עבודה בלעדיות...",
                    career_platform_resources_title: "משאבי קריירה",
                    career_platform_resources_subtitle: "כלים ומדריכים להצלחתך",
                    career_platform_testimonials_title: "סיפורי הצלחה",
                    career_platform_testimonials_subtitle: "ממשתמשי הפלטפורמה שלנו",
                    career_platform_cta_title: "מוכן לקדם את הקריירה שלך?",
                    career_platform_cta_description: "הצטרף לאלפי אנשי מקצוע...",
                    career_platform_cta_button_text: "טקסט כפתור",
                    career_platform_cta_button_url: "URL כפתור",
                    // TEACHERS TAB PLACEHOLDERS
                    teachers_hero_title: "כותרת גיבור (למשל, המרצים שלנו)",
                    teachers_hero_subtitle: "כותרת משנה גיבור (למשל, הכר את הצוות שלנו)",
                    teachers_hero_description: "תיאור גיבור",
                    teachers_instructor_grid_title: "כותרת קטע",
                    teachers_instructor_grid_subtitle: "כותרת משנה קטע",
                    teachers_instructor_grid_description: "תיאור קטע",
                    teachers_become_instructor_title: "כותרת CTA",
                    teachers_become_instructor_subtitle: "כותרת משנה CTA",
                    teachers_become_instructor_description: "תיאור CTA",
                    teachers_become_instructor_primary_button: "טקסט כפתור ראשי",
                    teachers_become_instructor_primary_link: "קישור כפתור ראשי",
                    teachers_become_instructor_secondary_button: "טקסט כפתור משני",
                    teachers_become_instructor_secondary_link: "קישור כפתור משני",
                    // COURSE PLACEHOLDERS
                    course_title: "הזן כותרת קורס",
                    course_description: "הזן תיאור קורס",
                    course_short_description: "סיכום קצר של הקורס",
                    course_price: "99.99",
                    course_old_price: "149.99",
                    course_duration: "למשל, 8 שבועות, 30 שעות",
                    course_instructor: "שם מרצה",
                    course_image_url: "https://example.com/course-image.jpg",
                    course_video_url: "https://youtube.com/watch?v=...",
                    course_link: "https://example.com/course-page",
                    course_rating: "4.5",
                    course_students: "1500",
                    course_reviews: "למשל 2,340",
                    course_lessons: "למשל 120",
                    course_features: "מפגשים חיים, פרויקטים, תעודה, תמיכה",
                    course_syllabus: "מודול 1: הקדמה\nמודול 2: נושאים מתקדמים\nמודול 3: פרויקטים",
                    // TEACHER PROFILE PLACEHOLDERS
                    teacher_full_name: "שם מלא",
                    teacher_key: "מפתח מרצה (למשל, sarah-chen)",
                    teacher_professional_title: "תואר מקצועי",
                    teacher_company: "חברה",
                    teacher_profile_image_url: "URL תמונת פרופיל",
                    teacher_email: "אימייל",
                    teacher_bio: "ביוגרפיה",
                    teacher_skills: "למידת מכונה, Python, TensorFlow",
                    teacher_years_experience: "8",
                    teacher_students_taught: "570",
                    teacher_courses_count: "12",
                    teacher_rating: "4.8",
                    teacher_display_order: "סדר תצוגה"
                },
                labels: {
                    hero_section: "🎯 קטע גיבור",
                    features_section: "✨ קטע תכונות",
                    courses_section: "📚 קטע קורסים",
                    testimonials_section: "💬 קטע המלצות",
                    awards_section: "🏆 קטע פרסים",
                    pricing_section: "💰 תוכניות תמחור",
                    cta_section: "📢 קריאה לפעולה",
                    instructor_grid: "👨‍🏫 רשת מרצים",
                    become_instructor: "📢 הפוך למרצה",
                    search_results: "תוצאות חיפוש",
                    loading_results: "טוען תוצאות...",
                    no_results: "לא נמצאו תוצאות"
                },
                messages: {
                    loading: "טוען...",
                    success: "הצלחה",
                    error: "שגיאה",
                    saved: "שינויים נשמרו בהצלחה",
                    save_error: "שגיאה בשמירת שינויים",
                    content_loaded: "תוכן נטען בהצלחה",
                    content_updated: "תוכן עודכן בהצלחה"
                }
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeTabs();
            initializeLanguageSwitcher();
            loadHomeContent();
            // Load pricing data for search indexing
            loadPricingData();
        });

        // Tab Management
        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', async () => {
                    // Remove active from all
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));

                    // Add active to clicked
                    tab.classList.add('active');
                    const tabId = tab.dataset.tab;
                    document.getElementById(tabId).classList.add('active');

                    // Load content for specific tabs
                    if (tabId === 'courses') {
                        console.log('🎯 Courses tab activated, loading courses...');
                        await loadAllCourses();
                    } else if (tabId === 'pricing') {
                        console.log('💰 Pricing tab activated, loading pricing data...');
                        await loadPricingData();
                    } else if (tabId === 'teachers') {
                        console.log('👨‍🏫 Teachers tab activated, loading teachers data...');
                        await loadTeachersData();
                        // Also load blog posts in teachers tab
                        await loadBlogPostsInTeachers();
                    } else if (tabId === 'blogAdmin') {
                        console.log('📝 BlogAdmin tab activated, loading blog posts...');
                        await loadBlogAdmin();
                    }
                });
            });
        }

        // DEBUG FUNCTION - Run this in browser console to check blogNew status
        function debugBlogNew() {
            console.log('🔧 DEBUGGING BLOGNEW TAB:');
            const section = document.getElementById('blogNew');
            const tbody = document.getElementById('blogNew-table-body');
            const tableContainer = section?.querySelector('.table-container');

            console.log('📍 BlogNew section exists:', !!section);
            console.log('📍 BlogNew section display:', section?.style.display);
            console.log('📍 BlogNew section computed display:', section ? window.getComputedStyle(section).display : 'N/A');
            console.log('📍 BlogNew section classes:', section?.className);
            console.log('📍 BlogNew tbody exists:', !!tbody);
            console.log('📍 BlogNew tbody content length:', tbody?.innerHTML?.length || 0);
            console.log('📍 BlogNew table container exists:', !!tableContainer);
            console.log('📍 BlogNew table container display:', tableContainer?.style.display);

            if (section) {
                console.log('🎯 Forcing blogNew visibility...');
                section.style.display = 'block';
                section.style.visibility = 'visible';
                section.style.opacity = '1';
                section.classList.add('active');
                console.log('✅ Forced visibility applied');
            }

            console.log('🔄 Calling loadBlogPostsNew()...');
            loadBlogPostsNew();
        }
        window.debugBlogNew = debugBlogNew;

        // Additional debug function to check positioning and dimensions
        function debugBlogNewPosition() {
            console.log('🔧 DEBUGGING BLOGNEW POSITION & DIMENSIONS:');
            const section = document.getElementById('blogNew');
            if (section) {
                const rect = section.getBoundingClientRect();
                const computed = window.getComputedStyle(section);

                console.log('📐 Position & Size:');
                console.log('  Top:', rect.top, 'Left:', rect.left);
                console.log('  Width:', rect.width, 'Height:', rect.height);
                console.log('  Visible on screen:', rect.top >= 0 && rect.left >= 0 && rect.bottom <= window.innerHeight && rect.right <= window.innerWidth);

                console.log('🎨 CSS Properties:');
                console.log('  Position:', computed.position);
                console.log('  Z-index:', computed.zIndex);
                console.log('  Overflow:', computed.overflow);
                console.log('  Transform:', computed.transform);
                console.log('  Clip-path:', computed.clipPath);

                // Check if content is behind other elements
                const elementAtPosition = document.elementFromPoint(rect.left + rect.width/2, rect.top + rect.height/2);
                console.log('🎯 Element at center of blogNew:', elementAtPosition);

                // Force scroll to blogNew section
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                console.log('📍 Scrolled to blogNew section');
            }
        }
        window.debugBlogNewPosition = debugBlogNewPosition;

        // Force make blogNew content visible by brute force
        function forceBlogNewVisible() {
            console.log('🚨 FORCE MAKING BLOGNEW VISIBLE');
            const section = document.getElementById('blogNew');
            if (section) {
                // Nuclear option - force every possible visibility property
                section.style.cssText = `
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    position: relative !important;
                    z-index: 9999 !important;
                    background: red !important;
                    min-height: 800px !important;
                    padding: 50px !important;
                    margin: 20px !important;
                    border: 10px solid yellow !important;
                    color: white !important;
                    font-size: 20px !important;
                `;

                // Force all child elements visible too
                const allChildren = section.querySelectorAll('*');
                allChildren.forEach(child => {
                    child.style.cssText += `
                        display: block !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        color: white !important;
                        background: rgba(0,0,0,0.3) !important;
                    `;
                });

                console.log('✅ Nuclear visibility applied to blogNew');
            }
        }
        window.forceBlogNewVisible = forceBlogNewVisible;

        // DOM Inspector function - run this to inspect actual DOM
        function inspectBlogNewDOM() {
            console.log('🔧 INSPECTING BLOGNEW DOM STRUCTURE:');
            const section = document.getElementById('blogNew');
            const content = document.getElementById('blogNewContent');
            const tbody = document.getElementById('blogNew-table-body');

            console.log('📍 BlogNew section:', section);
            if (section) {
                console.log('  - ClientHeight:', section.clientHeight);
                console.log('  - ScrollHeight:', section.scrollHeight);
                console.log('  - OffsetHeight:', section.offsetHeight);
                console.log('  - Children count:', section.children.length);
                console.log('  - First child:', section.children[0]);
            }

            console.log('📍 BlogNewContent wrapper:', content);
            if (content) {
                console.log('  - ClientHeight:', content.clientHeight);
                console.log('  - ScrollHeight:', content.scrollHeight);
                console.log('  - OffsetHeight:', content.offsetHeight);
                console.log('  - Children count:', content.children.length);
            }

            console.log('📍 Table body:', tbody);
            if (tbody) {
                console.log('  - ClientHeight:', tbody.clientHeight);
                console.log('  - ScrollHeight:', tbody.scrollHeight);
                console.log('  - OffsetHeight:', tbody.offsetHeight);
                console.log('  - InnerHTML length:', tbody.innerHTML.length);
                console.log('  - Children count:', tbody.children.length);
                console.log('  - First row:', tbody.children[0]);
            }

            // Check computed styles
            if (section) {
                const computed = window.getComputedStyle(section);
                console.log('🎨 Section computed styles:');
                console.log('  - Display:', computed.display);
                console.log('  - Height:', computed.height);
                console.log('  - MaxHeight:', computed.maxHeight);
                console.log('  - Overflow:', computed.overflow);
                console.log('  - Position:', computed.position);
                console.log('  - Transform:', computed.transform);
            }

            if (content) {
                const computed = window.getComputedStyle(content);
                console.log('🎨 Content computed styles:');
                console.log('  - Display:', computed.display);
                console.log('  - Height:', computed.height);
                console.log('  - MaxHeight:', computed.maxHeight);
                console.log('  - Overflow:', computed.overflow);
            }
        }
        window.inspectBlogNewDOM = inspectBlogNewDOM;

        // Find where blogNew actually is in the DOM
        function findBlogNewInDOM() {
            console.log('🔍 SEARCHING FOR BLOGNEW IN DOM:');
            const blogNew = document.getElementById('blogNew');

            if (blogNew) {
                console.log('📍 BlogNew element found:', blogNew);
                console.log('📍 Parent element:', blogNew.parentElement);
                console.log('📍 Parent class:', blogNew.parentElement?.className);
                console.log('📍 Parent ID:', blogNew.parentElement?.id);

                // Check all content sections
                const allContentSections = document.querySelectorAll('.content-section');
                console.log('📍 All content sections found:', allContentSections.length);
                allContentSections.forEach((section, index) => {
                    console.log(`  ${index}: ${section.id} - display: ${window.getComputedStyle(section).display}`);
                });

                // Check if blogNew is inside the admin-card
                const adminCard = document.querySelector('.admin-card');
                const isInsideCard = adminCard && adminCard.contains(blogNew);
                console.log('📍 BlogNew inside admin-card:', isInsideCard);

                // Check siblings
                console.log('📍 Previous sibling:', blogNew.previousElementSibling?.id);
                console.log('📍 Next sibling:', blogNew.nextElementSibling?.id);
            } else {
                console.error('❌ BlogNew element NOT FOUND in DOM!');
            }
        }
        window.findBlogNewInDOM = findBlogNewInDOM;

        // Fix blogNew positioning by moving it outside of teachers
        function fixBlogNewPosition() {
            console.log('🔧 FIXING BLOGNEW POSITION:');
            const blogNew = document.getElementById('blogNew');
            const adminCard = document.querySelector('.admin-card');

            if (blogNew && adminCard) {
                console.log('📍 Current parent:', blogNew.parentElement.id);

                // Remove blogNew from current position
                blogNew.remove();

                // Find the blog section (should be after teachers)
                const blogSection = document.getElementById('blog');
                if (blogSection) {
                    // Insert blogNew after blog section
                    blogSection.parentNode.insertBefore(blogNew, blogSection.nextSibling);
                    console.log('✅ Moved blogNew after blog section');
                } else {
                    // Fallback: append to admin card
                    adminCard.appendChild(blogNew);
                    console.log('✅ Appended blogNew to admin card');
                }

                // Force visibility
                blogNew.style.display = 'block';
                blogNew.style.visibility = 'visible';
                blogNew.style.opacity = '1';
                blogNew.classList.add('active');

                console.log('📍 New parent:', blogNew.parentElement.className);
                console.log('📍 New position confirmed');
            }
        }
        window.fixBlogNewPosition = fixBlogNewPosition;

        // Force activate BlogNew tab completely
        function forceActivateBlogNew() {
            console.log('🚀 FORCE ACTIVATING BLOGNEW:');

            // 1. Hide all other content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
                section.classList.remove('active');
                console.log(`Hidden section: ${section.id}`);
            });

            // 2. Show and activate blogNew
            const blogNew = document.getElementById('blogNew');
            if (blogNew) {
                blogNew.style.display = 'block !important';
                blogNew.style.visibility = 'visible !important';
                blogNew.style.opacity = '1 !important';
                blogNew.style.position = 'relative';
                blogNew.style.zIndex = '10';
                blogNew.classList.add('active');
                console.log('✅ BlogNew section activated');

                // 3. Force load content
                loadBlogPostsNew();
                console.log('✅ Content loading triggered');

                // 4. Check final status
                setTimeout(() => {
                    const rect = blogNew.getBoundingClientRect();
                    console.log('📐 Final BlogNew dimensions:');
                    console.log('  Height:', rect.height);
                    console.log('  Width:', rect.width);
                    console.log('  Visible:', rect.height > 0 && rect.width > 0);
                }, 1000);
            }

            // 5. Activate BlogNew tab button
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            const blogNewTab = document.querySelector('[data-tab="blogNew"]');
            if (blogNewTab) {
                blogNewTab.classList.add('active');
                console.log('✅ BlogNew tab button activated');
            }
        }
        window.forceActivateBlogNew = forceActivateBlogNew;

        // Force physical dimensions and visibility
        function forcePhysicalVisibility() {
            console.log('💪 FORCING PHYSICAL VISIBILITY:');

            const blogNew = document.getElementById('blogNew');
            const blogNewContent = document.getElementById('blogNewContent');
            const tableContainer = blogNew?.querySelector('.table-container');
            const table = blogNew?.querySelector('table');
            const tbody = document.getElementById('blogNew-table-body');

            // Force minimum heights and dimensions
            if (blogNew) {
                blogNew.style.cssText = `
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    position: relative !important;
                    z-index: 10 !important;
                    min-height: 800px !important;
                    height: auto !important;
                    width: 100% !important;
                    padding: 30px !important;
                    margin: 0 !important;
                    background: rgba(255,0,0,0.1) !important;
                    border: 3px solid red !important;
                `;
                console.log('✅ BlogNew section forced dimensions');
            }

            if (blogNewContent) {
                blogNewContent.style.cssText = `
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    min-height: 600px !important;
                    height: auto !important;
                    width: 100% !important;
                    background: rgba(0,255,0,0.1) !important;
                    border: 2px solid green !important;
                `;
                console.log('✅ BlogNewContent forced dimensions');
            }

            if (tableContainer) {
                tableContainer.style.cssText = `
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    min-height: 400px !important;
                    height: auto !important;
                    width: 100% !important;
                    background: white !important;
                    border: 2px solid blue !important;
                    overflow: visible !important;
                `;
                console.log('✅ Table container forced dimensions');
            }

            if (table) {
                table.style.cssText = `
                    display: table !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    width: 100% !important;
                    min-height: 300px !important;
                    table-layout: auto !important;
                    border-collapse: collapse !important;
                `;
                console.log('✅ Table forced dimensions');
            }

            if (tbody) {
                tbody.style.cssText = `
                    display: table-row-group !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                `;

                // Force each row visible
                const rows = tbody.querySelectorAll('tr');
                rows.forEach((row, index) => {
                    row.style.cssText = `
                        display: table-row !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        height: auto !important;
                        min-height: 60px !important;
                    `;
                    console.log(`✅ Row ${index + 1} forced visible`);
                });
            }

            // Final check
            setTimeout(() => {
                const rect = blogNew?.getBoundingClientRect();
                console.log('📐 FINAL CHECK:');
                console.log('  Height:', rect?.height);
                console.log('  Width:', rect?.width);
                console.log('  Success:', rect?.height > 0);
            }, 500);
        }
        window.forcePhysicalVisibility = forcePhysicalVisibility;

        // Final solution: Completely rebuild blogNew section
        function rebuildBlogNewSection() {
            console.log('🔨 REBUILDING BLOGNEW SECTION:');

            // 1. Remove existing blogNew
            const existingBlogNew = document.getElementById('blogNew');
            if (existingBlogNew) {
                existingBlogNew.remove();
                console.log('✅ Removed existing blogNew');
            }

            // 2. Find insertion point (after blog section)
            const blogSection = document.getElementById('blog');
            const menuSection = document.getElementById('menu');
            const insertionPoint = menuSection || blogSection?.nextElementSibling;

            if (!insertionPoint) {
                console.error('❌ Could not find insertion point');
                return;
            }

            // 3. Create new blogNew section with proper structure
            const newBlogNew = document.createElement('div');
            newBlogNew.className = 'content-section active';
            newBlogNew.id = 'blogNew';
            newBlogNew.style.cssText = `
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                min-height: 600px !important;
                padding: 30px !important;
                background: rgba(255,255,255,0.95) !important;
                border: 2px solid #667eea !important;
                margin: 20px 0 !important;
            `;

            newBlogNew.innerHTML = `
                <div class="section-header">
                    <div class="section-title">📝 Blog Posts Management (Rebuilt)</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-small btn-success" onclick="openBlogCreateModal()">➕ Add New Blog Post</button>
                        <button class="btn btn-small" onclick="loadBlogPostsNew()">🔄 Refresh</button>
                    </div>
                </div>
                <div id="blogNewContent">
                    <div style="margin-bottom: 20px;">
                        <div class="form-group">
                            <label>🔍 Search Blog Posts</label>
                            <input type="text" id="blogNew-search-input" placeholder="Search by title, author, category..." style="width: 100%;" oninput="filterBlogNewTable()">
                        </div>
                    </div>
                    <div class="table-container" style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); overflow: hidden; margin-bottom: 20px;">
                        <table class="admin-table" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f8f9fa;">
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Blog Post</th>
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Author</th>
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Category</th>
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Status</th>
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Published</th>
                                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #2d3748; border-bottom: 2px solid #e2e8f0;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="blogNew-table-body">
                                <tr>
                                    <td colspan="6" style="padding: 40px; text-align: center; color: #718096;">
                                        <div>Ready to load blog posts...</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            // 4. Insert before menu section
            insertionPoint.parentNode.insertBefore(newBlogNew, insertionPoint);
            console.log('✅ Inserted new blogNew section');

            // 5. Hide all other sections
            document.querySelectorAll('.content-section').forEach(section => {
                if (section.id !== 'blogNew') {
                    section.style.display = 'none';
                    section.classList.remove('active');
                }
            });

            // 6. Load content
            loadBlogPostsNew();
            console.log('✅ Loading content into rebuilt section');

            // 7. Final verification
            setTimeout(() => {
                const rect = newBlogNew.getBoundingClientRect();
                console.log('📐 REBUILT SECTION CHECK:');
                console.log('  Height:', rect.height);
                console.log('  Width:', rect.width);
                console.log('  Parent:', newBlogNew.parentElement.className);
                console.log('  SUCCESS:', rect.height > 0 && rect.width > 0);
            }, 1000);
        }
        window.rebuildBlogNewSection = rebuildBlogNewSection;

        // Language Switcher
        function initializeLanguageSwitcher() {
            const langBtns = document.querySelectorAll('.lang-btn');
            langBtns.forEach(btn => {
                btn.addEventListener('click', async () => {
                    langBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentLang = btn.dataset.lang;

                    // Translate interface
                    translateInterface();

                    // Reload content for current active tab
                    const activeTab = document.querySelector('.tab.active');
                    if (activeTab) {
                        const tabId = activeTab.getAttribute('data-tab');
                        console.log(`🌍 Language changed to ${currentLang}, reloading ${tabId} content...`);

                        // Load content based on active tab
                        switch (tabId) {
                            case 'home':
                                await loadHomeContent();
                                break;
                            case 'pricing':
                                await loadPricingData();
                                break;
                            case 'teachers':
                                await loadTeachersData();
                                console.log('🎯 FORCING TEACHER PROFILES LOAD...');
                                // Force load teachers with a delay to ensure DOM is ready
                                setTimeout(async () => {
                                    console.log('⏰ Loading individual teacher profiles NOW...');
                                    await loadAllTeachers();
                                }, 500);
                                break;
                            case 'courses':
                                await loadAllCourses();
                                break;
                            default:
                                await loadHomeContent();
                        }
                    }
                });
            });
        }

        // Translate Admin Interface
        function translateInterface() {
            const t = adminTranslations[currentLang] || adminTranslations.en;

            // Translate header
            const headerTitle = document.querySelector('.header h1');
            const headerSubtitle = document.querySelector('.header p');
            if (headerTitle) headerTitle.textContent = t.title;
            if (headerSubtitle) headerSubtitle.textContent = t.subtitle;

            // Translate tabs
            Object.keys(t.tabs).forEach(tabKey => {
                const tab = document.querySelector(`button[data-tab="${tabKey}"]`);
                if (tab) tab.textContent = t.tabs[tabKey];
            });

            // Translate sections (labels)
            document.querySelectorAll('label').forEach(label => {
                const text = label.textContent.trim();

                // Hero sections
                if (text.includes('🎯') && text.includes('Hero')) {
                    label.innerHTML = label.innerHTML.replace(/🎯.*?(<|$)/, t.sections.hero + (RegExp.$1 || ''));
                }
                // Instructor Grid
                if (text.includes('👨‍🏫')) {
                    label.innerHTML = label.innerHTML.replace(/👨‍🏫.*?(<|$)/, t.sections.instructor_grid + (RegExp.$1 || ''));
                }
                // Become Instructor
                if (text.includes('📢') && text.includes('Instructor')) {
                    label.innerHTML = label.innerHTML.replace(/📢.*?(<|$)/, t.sections.become_instructor + (RegExp.$1 || ''));
                }
                // Stats
                if (text.includes('📊')) {
                    label.innerHTML = label.innerHTML.replace(/📊.*?(<|$)/, t.sections.stats + (RegExp.$1 || ''));
                }
                // Pricing Plans
                if (text.includes('💰')) {
                    label.innerHTML = label.innerHTML.replace(/💰.*?(<|$)/, t.sections.plans + (RegExp.$1 || ''));
                }
                // Features Comparison
                if (text.includes('🔍')) {
                    label.innerHTML = label.innerHTML.replace(/🔍.*?(<|$)/, t.sections.features_comparison + (RegExp.$1 || ''));
                }
                // FAQs
                if (text.includes('❓')) {
                    label.innerHTML = label.innerHTML.replace(/❓.*?(<|$)/, t.sections.faqs + (RegExp.$1 || ''));
                }
                // Testimonials
                if (text.includes('💬')) {
                    label.innerHTML = label.innerHTML.replace(/💬.*?(<|$)/, t.sections.testimonials + (RegExp.$1 || ''));
                }
                // CTA
                if (text.includes('📢') && text.includes('Call')) {
                    label.innerHTML = label.innerHTML.replace(/📢.*?(<|$)/, t.sections.cta + (RegExp.$1 || ''));
                }

                // Field labels
                if (text === 'Visible') label.textContent = t.fields.visible;
            });

            // Translate buttons
            document.querySelectorAll('button').forEach(button => {
                const text = button.textContent.trim();
                if (text.includes('💾 Save Changes')) button.textContent = t.buttons.save;
                if (text.includes('🔄 Refresh')) button.textContent = t.buttons.refresh;
                if (text.includes('+ Add Instructor')) button.textContent = t.buttons.add_instructor;
                if (text.includes('+ Add Plan')) button.textContent = t.buttons.add_plan;
                if (text.includes('+ Add Item')) button.textContent = t.buttons.add_item;
                if (text === 'Remove') button.textContent = t.buttons.remove;
            });

            // Translate placeholder texts
            document.querySelectorAll('input, textarea').forEach(input => {
                const placeholder = input.placeholder;
                if (placeholder.includes('Title')) {
                    input.placeholder = placeholder.replace(/Title/g, t.fields.title);
                }
                if (placeholder.includes('Subtitle')) {
                    input.placeholder = placeholder.replace(/Subtitle/g, t.fields.subtitle);
                }
                if (placeholder.includes('Description')) {
                    input.placeholder = placeholder.replace(/Description/g, t.fields.description);
                }
                if (placeholder.includes('Name')) {
                    input.placeholder = placeholder.replace(/Name/g, t.fields.name);
                }
                if (placeholder.includes('Expertise')) {
                    input.placeholder = placeholder.replace(/Expertise/g, t.fields.expertise);
                }
                if (placeholder.includes('Bio')) {
                    input.placeholder = placeholder.replace(/Bio/g, t.fields.bio);
                }
                if (placeholder.includes('Image URL')) {
                    input.placeholder = placeholder.replace(/Image URL/g, t.fields.image);
                }
                if (placeholder.includes('Profile Link')) {
                    input.placeholder = placeholder.replace(/Profile Link/g, t.fields.profile_link);
                }
            });

            console.log(`🌍 Interface translated to ${currentLang}`);

            // Apply comprehensive translations
            translateComprehensive();
        }

        // Comprehensive Translation Function
        function translateComprehensive() {
            const t = adminTranslations[currentLang] || adminTranslations.en;

            // Translate all placeholders using the comprehensive placeholders object
            const searchInput = document.querySelector('#adminSearch');
            if (searchInput && t.placeholders && t.placeholders.search) {
                searchInput.placeholder = t.placeholders.search;
            }

            // Translate specific input placeholders
            const placeholderMappings = [
                { id: 'hero_title', key: 'hero_title' },
                { id: 'hero_subtitle', key: 'hero_subtitle' },
                { id: 'hero_description', key: 'hero_description' },
                { id: 'features_title', key: 'features_title' },
                { id: 'features_subtitle', key: 'features_subtitle' },
                { id: 'courses_title', key: 'courses_title' },
                { id: 'courses_subtitle', key: 'courses_subtitle' },
                { id: 'testimonials_title', key: 'testimonials_title' },
                { id: 'testimonials_subtitle', key: 'testimonials_subtitle' },
                { id: 'awards_title', key: 'awards_title' },
                { id: 'awards_subtitle', key: 'awards_subtitle' },
                { id: 'pricing_title', key: 'pricing_title' },
                { id: 'pricing_subtitle', key: 'pricing_subtitle' },
                { id: 'cta_title', key: 'cta_title' },
                { id: 'cta_description', key: 'cta_description' },
                { id: 'courseInstructor', key: 'instructor_name' },
                { id: 'teachers_instructor_grid_title', key: 'section_title' },
                { id: 'teachers_instructor_grid_subtitle', key: 'section_subtitle' },
                { id: 'teachers_instructor_grid_description', key: 'section_description' },
                { id: 'teachers_become_instructor_title', key: 'section_title' },
                { id: 'teachers_become_instructor_subtitle', key: 'section_subtitle' },
                { id: 'teachers_become_instructor_description', key: 'section_description' },
                { id: 'teachers_become_instructor_primary_button', key: 'button_text' },
                { id: 'teachers_become_instructor_primary_link', key: 'button_url' },
                { id: 'teachers_become_instructor_secondary_button', key: 'button_text' },
                { id: 'teachers_become_instructor_secondary_link', key: 'button_url' },
                { id: 'cta_button_text', key: 'button_text' },
                { id: 'cta_button_url', key: 'button_url' },
                // PRICING TAB SPECIFIC PLACEHOLDERS - Critical fix for user reported issue
                { id: 'pricing_hero_title', key: 'pricing_title' },
                { id: 'pricing_hero_subtitle', key: 'pricing_subtitle' },
                { id: 'pricing_plans_description', key: 'section_description' },
                { id: 'pricing_features_comparison_title', key: 'section_title' },
                { id: 'pricing_features_comparison_subtitle', key: 'section_subtitle' },
                { id: 'pricing_features_comparison_description', key: 'section_description' },
                { id: 'pricing_faqs_title', key: 'section_title' },
                { id: 'pricing_faqs_subtitle', key: 'section_subtitle' },
                { id: 'pricing_faqs_description', key: 'section_description' },
                { id: 'pricing_testimonials_title', key: 'section_title' },
                { id: 'pricing_testimonials_subtitle', key: 'section_subtitle' },
                { id: 'pricing_testimonials_description', key: 'section_description' },
                { id: 'pricing_cta_title', key: 'cta_title' },
                { id: 'pricing_cta_description', key: 'cta_description' },
                { id: 'pricing_cta_button_text', key: 'button_text' },
                { id: 'pricing_cta_button_url', key: 'button_url' },
                // CAREER PLATFORM TAB PLACEHOLDERS
                { id: 'career-platform-hero-title', key: 'section_title' },
                { id: 'career-platform-hero-subtitle', key: 'section_subtitle' },
                { id: 'career-platform-hero-description', key: 'section_description' },
                { id: 'career-platform-hero-button1-text', key: 'button_text' },
                { id: 'career-platform-hero-button1-url', key: 'button_url' },
                { id: 'career-platform-hero-button2-text', key: 'button_text' },
                { id: 'career-platform-hero-button2-url', key: 'button_url' },
                { id: 'career-platform-features-title', key: 'section_title' },
                { id: 'career-platform-features-subtitle', key: 'section_subtitle' },
                { id: 'career-platform-opportunities-title', key: 'section_title' },
                { id: 'career-platform-opportunities-subtitle', key: 'section_subtitle' },
                { id: 'career-platform-opportunities-description', key: 'section_description' },
                { id: 'career-platform-resources-title', key: 'section_title' },
                { id: 'career-platform-resources-subtitle', key: 'section_subtitle' },
                { id: 'career-platform-testimonials-title', key: 'section_title' },
                { id: 'career-platform-testimonials-subtitle', key: 'section_subtitle' },
                { id: 'career-platform-cta-title', key: 'cta_title' },
                { id: 'career-platform-cta-description', key: 'cta_description' },
                { id: 'career-platform-cta-button-text', key: 'button_text' },
                { id: 'career-platform-cta-button-url', key: 'button_url' },
                // BLOG ADMIN SEARCH PLACEHOLDER
                { id: 'blogAdmin-search-input', key: 'search' },
                // MAIN ADMIN SEARCH
                { id: 'adminSearch', key: 'search' }
            ];

            if (t.placeholders) {
                placeholderMappings.forEach(mapping => {
                    const element = document.getElementById(mapping.id);
                    if (element && t.placeholders[mapping.key]) {
                        element.placeholder = t.placeholders[mapping.key];
                    }
                });
            }

            // Update all section labels
            if (t.labels) {
                document.querySelectorAll('label').forEach(label => {
                    const text = label.textContent.trim();

                    // Hero Section
                    if ((text.includes('🦸') || text.includes('🎯')) && text.includes('Hero')) {
                        label.textContent = t.labels.hero_section;
                    }
                    // Features Section
                    else if (text.includes('✨') && text.includes('Features')) {
                        label.textContent = t.labels.features_section;
                    }
                    // Courses Section
                    else if (text.includes('📚') && text.includes('Courses')) {
                        label.textContent = t.labels.courses_section;
                    }
                    // Testimonials Section
                    else if (text.includes('💬') && text.includes('Testimonials')) {
                        label.textContent = t.labels.testimonials_section;
                    }
                    // Awards Section
                    else if (text.includes('🏆') && text.includes('Awards')) {
                        label.textContent = t.labels.awards_section;
                    }
                    // Pricing Section
                    else if (text.includes('💰') && (text.includes('Pricing') || text.includes('Plans'))) {
                        label.textContent = t.labels.pricing_section;
                    }
                    // CTA Section
                    else if (text.includes('📢') && text.includes('Call')) {
                        label.textContent = t.labels.cta_section;
                    }
                    // Instructor Grid
                    else if (text.includes('👨‍🏫') && text.includes('Grid')) {
                        label.textContent = t.labels.instructor_grid;
                    }
                    // Become Instructor
                    else if (text.includes('📢') && text.includes('Instructor')) {
                        label.textContent = t.labels.become_instructor;
                    }
                    // Instructor field
                    else if (text.includes('👨‍🏫') && text.includes('Instructor') && !text.includes('Grid')) {
                        label.textContent = '👨‍🏫 ' + t.fields.instructor;
                    }
                });
            }

            // Translate additional buttons using the comprehensive buttons object
            if (t.buttons) {
                document.querySelectorAll('button').forEach(button => {
                    const text = button.textContent.trim();

                    // Preview button
                    if (text.includes('👁️') && text.includes('Preview')) {
                        button.textContent = t.buttons.preview;
                    }
                    // Clear button
                    else if (text === 'Clear' || text === 'Очистить') {
                        button.textContent = t.buttons.clear;
                    }
                    // Export button
                    else if (text.includes('📥') && text.includes('Export')) {
                        button.textContent = t.buttons.export;
                    }
                    // Import button
                    else if (text.includes('📤') && text.includes('Import')) {
                        button.textContent = t.buttons.import;
                    }
                    // Reload Content button
                    else if (text.includes('🔄') && text.includes('Reload')) {
                        button.textContent = t.buttons.reload;
                    }
                    // Specific Add buttons
                    else if (text.includes('+ Add Feature')) {
                        button.textContent = t.buttons.add_feature;
                    }
                    else if (text.includes('+ Add Course')) {
                        button.textContent = t.buttons.add_course;
                    }
                    else if (text.includes('+ Add Testimonial')) {
                        button.textContent = t.buttons.add_testimonial;
                    }
                    else if (text.includes('+ Add Award')) {
                        button.textContent = t.buttons.add_award;
                    }
                    else if (text.includes('+ Add Button')) {
                        button.textContent = t.buttons.add_button;
                    }
                });
            }

            console.log(`🌍 Comprehensive translations applied for ${currentLang}`);
        }

        // Load Home Content (Multi-language support)
        async function loadHomeContent() {
            showLoading();
            try {
                // ✅ FIXED: Use new endpoint /api/nd/home-page
                const response = await fetch(`/api/nd/home-page?locale=${currentLang}`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                if (result.success && result.data) {
                    // NewDesign API returns nested data structure
                    populateHomeForm(result.data);
                    showToast(`Content loaded for ${currentLang.toUpperCase()}`, 'success');
                    // Rebuild search index after loading data
                    setTimeout(buildSearchIndex, 500);
                } else {
                    throw new Error(result.error || 'No data received');
                }
            } catch (error) {
                showToast('Failed to load content', 'error');
                console.error('Error loading home content:', error);
            } finally {
                hideLoading();
            }
        }

        // Populate Form
        function populateHomeForm(data) {
            // Handle nested JSON structure from nd_home table
            console.log('📊 Populating form with data:', data);

            // Hero Section - handle nested structure from API
            const heroVisible = document.getElementById('hero_visible');
            const heroTitle = document.getElementById('hero_title');
            const heroSubtitle = document.getElementById('hero_subtitle');
            const heroDescription = document.getElementById('hero_description');

            // Extract hero data from nested structure
            const heroData = data.hero?.content || data.hero || {};
            if (heroVisible) heroVisible.checked = data.hero?.visible !== false;
            if (heroTitle) heroTitle.value = heroData.title || '';
            if (heroSubtitle) heroSubtitle.value = heroData.subtitle || '';
            if (heroDescription) heroDescription.value = heroData.description || '';

            // Hero Buttons - skip for now as they're not in the flat structure
            document.getElementById('heroButtons').innerHTML = '';

            // Features Section - handle nested structure
            const featuresVisible = document.getElementById('features_visible');
            const featuresTitle = document.getElementById('features_title');
            const featuresSubtitle = document.getElementById('features_subtitle');

            const featuresData = data.features?.content?.content || data.features?.content || data.features || {};
            if (featuresVisible) featuresVisible.checked = data.features?.visible !== false;
            if (featuresTitle) featuresTitle.value = featuresData.title || '';
            if (featuresSubtitle) featuresSubtitle.value = featuresData.subtitle || '';

            // Feature Items - populate from nested structure
            const featureItems = document.getElementById('featureItems');
            featureItems.innerHTML = '';

            // Add features from nested items array
            if (featuresData.items && Array.isArray(featuresData.items)) {
                featuresData.items.forEach(item => {
                    addFeatureItem({
                        icon: '🎯',
                        title: item.title || '',
                        description: item.description || ''
                    });
                });
            }
            // Fallback to old structure if needed
            else if (data.feature_1_title) {
                addFeatureItem({
                    icon: '🎯',
                    title: data.feature_1_title,
                    description: data.feature_3_description
                });
            }

            // Courses Section - using snake_case
            const coursesVisible = document.getElementById('courses_visible');
            const coursesTitle = document.getElementById('courses_title');
            const coursesSubtitle = document.getElementById('courses_subtitle');
            if (coursesVisible) coursesVisible.checked = data.featured_courses_visible !== false;
            if (coursesTitle) coursesTitle.value = data.featured_courses_title || '';
            if (coursesSubtitle) coursesSubtitle.value = data.featured_courses_description || '';

            // Testimonials Section - handle nested structure
            const testimonialsVisible = document.getElementById('testimonials_visible');
            const testimonialsTitle = document.getElementById('testimonials_title');
            const testimonialsSubtitle = document.getElementById('testimonials_subtitle');

            const testimonialsData = data.testimonials?.content || data.testimonials || {};
            if (testimonialsVisible) testimonialsVisible.checked = data.testimonials?.visible !== false;
            if (testimonialsTitle) testimonialsTitle.value = testimonialsData.title || '';
            if (testimonialsSubtitle) testimonialsSubtitle.value = testimonialsData.description || '';

            // Awards Section - may not exist in flat structure
            const awardsVisible = document.getElementById('awards_visible');
            const awardsTitle = document.getElementById('awards_title');
            const awardsSubtitle = document.getElementById('awards_subtitle');
            if (awardsVisible) awardsVisible.checked = false;
            if (awardsTitle) awardsTitle.value = '';
            if (awardsSubtitle) awardsSubtitle.value = '';

            // Pricing Section - use defaults if not in flat structure
            const pricingVisible = document.getElementById('pricing_visible');
            const pricingTitle = document.getElementById('pricing_title');
            const pricingSubtitle = document.getElementById('pricing_subtitle');
            if (pricingVisible) pricingVisible.checked = true;
            if (pricingTitle) pricingTitle.value = 'Choose Your Learning Path';
            if (pricingSubtitle) pricingSubtitle.value = 'Flexible Pricing Plans';

            // Add default pricing plans
            const defaultPlans = [
                { id: 'basic', name: 'Basic Plan', price_monthly: '29', price_yearly: '278', description: 'Perfect for beginners', features: ['50+ courses', 'Community support', 'Certificates'], featured: false },
                { id: 'pro', name: 'Pro Plan', price_monthly: '79', price_yearly: '758', description: 'For serious learners', features: ['All courses', 'Priority support', '1-on-1 mentoring', 'Job placement'], featured: true, popular_badge: 'Most Popular' },
                { id: 'enterprise', name: 'Enterprise', price_monthly: 'Custom', price_yearly: 'Custom', description: 'For teams', features: ['Everything in Pro', 'Unlimited team members', 'Dedicated manager'], featured: false }
            ];
            document.getElementById('pricingPlans').innerHTML = '';
            defaultPlans.forEach(plan => addPricingPlan(plan));

            // CTA Section - using snake_case fields
            const ctaVisible = document.getElementById('cta_visible');
            const ctaTitle = document.getElementById('cta_title');
            const ctaDescription = document.getElementById('cta_description');
            const ctaButtonText = document.getElementById('cta_button_text');
            const ctaButtonUrl = document.getElementById('cta_button_url');
            if (ctaVisible) ctaVisible.checked = data.cta_visible !== false;
            if (ctaTitle) ctaTitle.value = data.cta_title || 'Ready to Start Learning?';
            if (ctaDescription) ctaDescription.value = data.cta_description || 'Join thousands of successful students';
            if (ctaButtonText) ctaButtonText.value = data.cta_button_text || 'Sign Up Today';
            if (ctaButtonUrl) ctaButtonUrl.value = data.cta_button_url || '#signup';
        }

        // Save Home Content
        async function saveHomeContent() {
            showLoading();

            try {
                // Build payload using flat structure that matches the custom API
                const payload = {
                    // Hero Section
                    heroSectionVisible: document.getElementById('hero_visible')?.checked ?? false,
                    heroTitle: document.getElementById('hero_title')?.value || '',
                    heroSubtitle: document.getElementById('hero_subtitle')?.value || '',
                    heroDescription: document.getElementById('hero_description')?.value || '',

                    // Features Section
                    featuredCoursesVisible: document.getElementById('courses_visible')?.checked ?? false,
                    featuredCoursesTitle: document.getElementById('courses_title')?.value || '',
                    featuredCoursesDescription: document.getElementById('courses_subtitle')?.value || '',

                    // Testimonials Section
                    testimonialsVisible: document.getElementById('testimonials_visible')?.checked ?? false,
                    testimonialsTitle: document.getElementById('testimonials_title')?.value || '',
                    testimonialsSubtitle: document.getElementById('testimonials_subtitle')?.value || '',

                    // CTA Section
                    // Note: Removed focusPracticeTitle and coreSkillsTitle as these columns don't exist in database
                    ctaVisible: document.getElementById('cta_visible')?.checked ?? false,
                    ctaTitle: document.getElementById('cta_title')?.value || '',
                    ctaDescription: document.getElementById('cta_description')?.value || '',
                    ctaButtonText: document.getElementById('cta_button_text')?.value || '',
                    ctaButtonUrl: document.getElementById('cta_button_url')?.value || ''
                };

                console.log('📊 [Admin] Saving Home Content with visibility settings');

                // Save each section using the correct API endpoints
                let successCount = 0;
                let failCount = 0;

                // Save Hero Section
                const heroResponse = await fetch(`/api/nd/home-page/hero`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        [`content_${currentLang}`]: {
                            content: {
                                title: payload.heroTitle,
                                subtitle: payload.heroSubtitle,
                                description: payload.heroDescription
                            },
                            visible: payload.heroSectionVisible
                        }
                    })
                });
                if (heroResponse.ok) successCount++; else failCount++;

                // Save Features Section
                const featuresResponse = await fetch(`/api/nd/home-page/features`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        [`content_${currentLang}`]: {
                            content: {
                                content: {
                                    title: document.getElementById('features_title')?.value || '',
                                    subtitle: document.getElementById('features_subtitle')?.value || ''
                                }
                            },
                            visible: document.getElementById('features_visible')?.checked ?? true
                        }
                    })
                });
                if (featuresResponse.ok) successCount++; else failCount++;

                // Save Testimonials Section
                const testimonialsResponse = await fetch(`/api/nd/home-page/testimonials`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        [`content_${currentLang}`]: {
                            content: {
                                title: payload.testimonialsTitle,
                                description: payload.testimonialsSubtitle
                            },
                            visible: payload.testimonialsVisible
                        }
                    })
                });
                if (testimonialsResponse.ok) successCount++; else failCount++;

                // Save CTA Section
                const ctaResponse = await fetch(`/api/nd/home-page/cta_bottom`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        [`content_${currentLang}`]: {
                            content: {
                                title: payload.ctaTitle,
                                description: payload.ctaDescription
                            },
                            visible: payload.ctaVisible
                        }
                    })
                });
                if (ctaResponse.ok) successCount++; else failCount++;

                if (failCount === 0) {
                    showToast(`✅ All sections saved for ${currentLang.toUpperCase()}`, 'success');
                } else {
                    showToast(`⚠️ Saved ${successCount} sections, ${failCount} failed`, 'warning');
                }
            } catch (error) {
                showToast('Failed to save content', 'error');
                console.error('Save error:', error);
            } finally {
                hideLoading();
            }
        }

        // Dynamic List Management
        function addHeroButton(data = {}) {
            const container = document.getElementById('heroButtons');
            const id = Date.now();
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `
                <input type="text" placeholder="Button Text" value="${data.text || ''}" class="mb-10" data-field="text">
                <input type="text" placeholder="Button URL" value="${data.url || ''}" class="mb-10" data-field="url">
                <select data-field="style">
                    <option value="primary" ${data.style === 'primary' ? 'selected' : ''}>Primary</option>
                    <option value="secondary" ${data.style === 'secondary' ? 'selected' : ''}>Secondary</option>
                </select>
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(item);
        }

        function addFeatureItem(data = {}) {
            const container = document.getElementById('featureItems');
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `
                <input type="text" placeholder="Feature Title" value="${data.title || ''}" class="mb-10" data-field="title">
                <textarea placeholder="Feature Description" data-field="description">${data.description || ''}</textarea>
                <input type="text" placeholder="Icon Class" value="${data.icon || ''}" class="mb-10" data-field="icon">
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(item);
        }

        function getHeroButtons() {
            const buttons = [];
            document.querySelectorAll('#heroButtons .list-item').forEach(item => {
                buttons.push({
                    text: item.querySelector('[data-field="text"]').value,
                    url: item.querySelector('[data-field="url"]').value,
                    style: item.querySelector('[data-field="style"]').value
                });
            });
            return buttons;
        }

        function getFeatureItems() {
            const items = [];
            document.querySelectorAll('#featureItems .list-item').forEach(item => {
                items.push({
                    title: item.querySelector('[data-field="title"]').value,
                    description: item.querySelector('[data-field="description"]').value,
                    icon: item.querySelector('[data-field="icon"]').value,
                    visible: true
                });
            });
            return items;
        }

        function addAwardItem(data = {}) {
            const container = document.getElementById('awardItems');
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `
                <input type="text" placeholder="Award Title" value="${data.title || ''}" class="mb-10" data-field="title">
                <textarea placeholder="Award Description" data-field="description">${data.description || ''}</textarea>
                <input type="text" placeholder="Award Year" value="${data.year || ''}" class="mb-10" data-field="year">
                <input type="text" placeholder="Award Icon/Image URL" value="${data.icon || ''}" class="mb-10" data-field="icon">
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(item);
        }

        function getAwardItems() {
            const items = [];
            document.querySelectorAll('#awardItems .list-item').forEach(item => {
                items.push({
                    title: item.querySelector('[data-field="title"]').value,
                    description: item.querySelector('[data-field="description"]').value,
                    year: item.querySelector('[data-field="year"]').value,
                    icon: item.querySelector('[data-field="icon"]').value,
                    visible: true
                });
            });
            return items;
        }

        // Pricing Plan Functions
        function addPricingPlan(data = {}) {
            const container = document.getElementById('pricingPlans');
            const item = document.createElement('div');
            item.className = 'list-item';
            item.style.background = '#f8f9fa';
            item.style.padding = '20px';
            item.style.borderRadius = '8px';
            item.style.marginBottom = '15px';

            item.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="Plan Name (e.g., Basic Plan)" value="${data.name || ''}" class="mb-10" data-field="name">
                    <select data-field="id" style="padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                        <option value="basic" ${data.id === 'basic' ? 'selected' : ''}>Basic</option>
                        <option value="pro" ${data.id === 'pro' ? 'selected' : ''}>Pro</option>
                        <option value="enterprise" ${data.id === 'enterprise' ? 'selected' : ''}>Enterprise</option>
                    </select>
                </div>

                <textarea placeholder="Plan Description" data-field="description" style="margin-bottom: 10px;">${data.description || ''}</textarea>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="Monthly Price (e.g., 29 or Custom)" value="${data.price_monthly || ''}" data-field="price_monthly">
                    <input type="text" placeholder="Yearly Price (e.g., 278 or Custom)" value="${data.price_yearly || ''}" data-field="price_yearly">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="CTA Button Text" value="${data.cta_text || 'Get Started'}" data-field="cta_text">
                    <input type="text" placeholder="CTA Button Link" value="${data.cta_link || '#signup'}" data-field="cta_link">
                </div>

                <textarea placeholder="Features (one per line)" data-field="features" rows="6" style="margin-bottom: 10px;">${Array.isArray(data.features) ? data.features.join('\n') : (data.features || '')}</textarea>

                <div style="display: flex; gap: 10px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" ${data.featured ? 'checked' : ''} data-field="featured">
                        Featured Plan
                    </label>
                    <input type="text" placeholder="Popular Badge Text" value="${data.popular_badge || ''}" data-field="popular_badge" style="flex: 1;">
                    <input type="color" value="${data.color_scheme || '#667EEA'}" data-field="color_scheme" title="Plan Color Scheme">
                    <button class="btn btn-small btn-danger" onclick="this.parentElement.parentElement.remove()">Remove Plan</button>
                </div>
            `;
            container.appendChild(item);
        }

        function getPricingPlans() {
            const plans = [];
            document.querySelectorAll('#pricingPlans .list-item').forEach(item => {
                const featuresText = item.querySelector('[data-field="features"]').value;
                plans.push({
                    id: item.querySelector('[data-field="id"]').value,
                    name: item.querySelector('[data-field="name"]').value,
                    description: item.querySelector('[data-field="description"]').value,
                    price_monthly: item.querySelector('[data-field="price_monthly"]').value,
                    price_yearly: item.querySelector('[data-field="price_yearly"]').value,
                    cta_text: item.querySelector('[data-field="cta_text"]').value,
                    cta_link: item.querySelector('[data-field="cta_link"]').value,
                    features: featuresText.split('\n').map(f => f.trim()).filter(f => f),
                    featured: item.querySelector('[data-field="featured"]').checked,
                    popular_badge: item.querySelector('[data-field="popular_badge"]').value,
                    color_scheme: item.querySelector('[data-field="color_scheme"]').value
                });
            });
            return plans;
        }

        // Preview Changes
        function previewChanges() {
            const url = `/nd/home.html?preview=true`;
            window.open(url, '_blank');
        }

        // Toggle Help Section
        function toggleHomeHelp() {
            const helpSection = document.getElementById('homeHelpSection');
            if (helpSection) {
                if (helpSection.style.display === 'none') {
                    helpSection.style.display = 'block';
                    helpSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    helpSection.style.display = 'none';
                }
            }
        }

        // Export/Import
        function exportContent() {
            // Implement export functionality
            showToast('Export feature coming soon', 'info');
        }

        function importContent() {
            // Implement import functionality
            showToast('Import feature coming soon', 'info');
        }

        // Settings
        async function saveSettings() {
            const enabled = document.getElementById('animations_enabled').checked;

            try {
                await fetch(`${API_BASE}/settings/animations`, {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ page: 'home', enabled })
                });
                showToast('Settings saved successfully', 'success');
            } catch (error) {
                showToast('Failed to save settings', 'error');
            }
        }

        // UI Helpers
        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toasterContainer');
            const toast = document.createElement('div');
            toast.className = `toaster ${type}`;
            toast.innerHTML = `
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer;">✕</button>
            `;
            container.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        // Search Functionality
        let searchIndex = [];
        let searchTimeout;

        function buildSearchIndex() {
            searchIndex = [];

            // Get all content sections
            const sections = document.querySelectorAll('.content-section');

            sections.forEach(section => {
                const sectionName = section.id;
                const sectionTitle = sectionName.charAt(0).toUpperCase() + sectionName.slice(1);

                // Index all inputs and textareas in this section
                const fields = section.querySelectorAll('input[type="text"], input[type="url"], input[type="email"], textarea, select');

                fields.forEach(field => {
                    const fieldId = field.id;
                    const fieldLabel = field.placeholder ||
                                     field.previousElementSibling?.textContent ||
                                     fieldId.replace(/_/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
                    const fieldValue = field.value || '';

                    if (fieldId && (fieldValue || fieldLabel)) {
                        searchIndex.push({
                            section: sectionTitle,
                            sectionId: sectionName,
                            field: fieldLabel,
                            fieldId: fieldId,
                            value: fieldValue,
                            element: field
                        });
                    }
                });

                // Also index list items (hero buttons, features, etc.)
                const listItems = section.querySelectorAll('.list-item');
                listItems.forEach((item, index) => {
                    const inputs = item.querySelectorAll('input, textarea');
                    inputs.forEach(input => {
                        const value = input.value || '';
                        if (value) {
                            searchIndex.push({
                                section: sectionTitle,
                                sectionId: sectionName,
                                field: input.placeholder || 'List Item',
                                fieldId: input.id || `${sectionName}_item_${index}`,
                                value: value,
                                element: input
                            });
                        }
                    });
                });
            });

            console.log(`Search index built with ${searchIndex.length} items`);
        }

        function performSearch(query) {
            const resultsContainer = document.getElementById('searchResults');

            if (!query || query.length < 2) {
                resultsContainer.innerHTML = '';
                resultsContainer.classList.remove('active');
                return;
            }

            const lowerQuery = query.toLowerCase();
            const results = searchIndex.filter(item => {
                const fieldMatch = item.field && item.field.toLowerCase().includes(lowerQuery);
                const valueMatch = item.value && item.value.toLowerCase().includes(lowerQuery);
                const sectionMatch = item.section && item.section.toLowerCase().includes(lowerQuery);
                return fieldMatch || valueMatch || sectionMatch;
            });

            displaySearchResults(results, query);
        }

        function displaySearchResults(results, query) {
            const resultsContainer = document.getElementById('searchResults');

            if (results.length === 0) {
                resultsContainer.innerHTML = '<div class="no-results">No matching content found</div>';
                resultsContainer.classList.add('active');
                return;
            }

            let html = '';
            results.forEach(result => {
                const highlightedField = highlightText(result.field, query);
                const highlightedValue = highlightText(result.value.substring(0, 200), query);
                const highlightedSection = highlightText(result.section, query);

                html += `
                    <div class="search-result-item" onclick="goToResult('${result.sectionId}', '${result.fieldId}')">
                        <div class="search-result-section">${highlightedSection}</div>
                        <div class="search-result-field">${highlightedField}</div>
                        <div class="search-result-value">${highlightedValue}${result.value.length > 200 ? '...' : ''}</div>
                    </div>
                `;
            });

            resultsContainer.innerHTML = html;
            resultsContainer.classList.add('active');
        }

        function highlightText(text, query) {
            if (!text) return '';
            const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }

        function goToResult(sectionId, fieldId) {
            // First, switch to the correct tab
            const tabs = document.querySelectorAll('.tab');
            const sections = document.querySelectorAll('.content-section');

            tabs.forEach(tab => {
                if (tab.dataset.tab === sectionId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            sections.forEach(section => {
                if (section.id === sectionId) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });

            // Clear search results
            clearSearch();

            // Scroll to and highlight the field
            setTimeout(() => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    field.style.transition = 'all 0.3s';
                    field.style.boxShadow = '0 0 0 5px rgba(102, 126, 234, 0.3)';
                    field.style.borderColor = '#667eea';
                    field.focus();

                    setTimeout(() => {
                        field.style.boxShadow = '';
                        field.style.borderColor = '';
                    }, 3000);
                }
            }, 300);
        }

        function clearSearch() {
            document.getElementById('adminSearch').value = '';
            const resultsContainer = document.getElementById('searchResults');
            resultsContainer.innerHTML = '';
            resultsContainer.classList.remove('active');
        }

        // Course Management Functions
        let allCourses = [];
        let editingCourseId = null;

        async function loadAllCourses() {
            try {
                console.log('🔄 Loading courses from nd_courses table...');
                // Now using dedicated nd_courses table
                const response = await fetch(`${API_BASE}/nd/courses?locale=${currentLang}`);
                const data = await response.json();

                console.log('📡 API Response:', {
                    success: data.success,
                    coursesCount: data.data ? data.data.length : 0
                });

                if (data.success && data.data && data.data.length > 0) {
                    allCourses = data.data;
                    console.log(`✅ Loaded ${allCourses.length} courses from nd_courses:`, allCourses.map(c => c.title));
                    displayCourses();
                    showToast('Courses loaded successfully', 'success');
                } else if (data.success && data.data && data.data.length === 0) {
                    console.log('📝 No courses in database');
                    allCourses = [];
                    displayCourses();
                    showToast('No courses found', 'info');
                } else {
                    throw new Error(data.error || 'Failed to load courses');
                }
            } catch (error) {
                console.error('❌ Error loading courses:', error);
                showToast('Failed to load courses', 'error');
                allCourses = [];
                displayCourses();
            }
        }

        function displayCourses() {
            console.log('🎨 Displaying courses:', allCourses.length);
            const coursesList = document.getElementById('coursesList');

            if (!coursesList) {
                console.error('❌ coursesList element not found!');
                return;
            }

            if (!allCourses || allCourses.length === 0) {
                console.log('📝 No courses to display, showing empty state');
                coursesList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #999;">
                        <p>No courses found</p>
                        <button class="btn btn-small btn-success" onclick="showAddCourseForm()">➕ Add Your First Course</button>
                    </div>
                `;
                return;
            }

            let html = '<div style="display: grid; gap: 15px;">';

            allCourses.forEach((course) => {
                const featured = course.featured ? '<span style="background: #ffc107; color: black; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">⭐ FEATURED</span>' : '';
                const visible = course.visible !== false ? '<span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">👁️ VISIBLE</span>' : '<span style="background: #dc3545; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">🚫 HIDDEN</span>';

                html += `
                    <div style="background: white; border: 2px solid #e1e1e1; border-radius: 12px; padding: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 10px 0; color: #333;">
                                    ${course.title || 'Untitled Course'}
                                    ${featured}
                                    ${visible}
                                </h4>
                                <p style="color: #666; margin: 5px 0;">${course.short_description || course.description?.substring(0, 100) || 'No description'}</p>

                                <!-- Quick Actions Bar -->
                                <div style="margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e1e1e1;">
                                    <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                                        <!-- Visibility Toggle -->
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <label class="visibility-toggle" style="margin: 0;">
                                                <input type="checkbox" ${course.visible !== false ? 'checked' : ''}
                                                       onchange="quickToggleVisible(${course.id}, this.checked)">
                                                <span class="visibility-slider"></span>
                                            </label>
                                            <span style="font-size: 13px; color: #666;">Visible</span>
                                        </div>

                                        <!-- Featured Toggle -->
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <label class="visibility-toggle" style="margin: 0;">
                                                <input type="checkbox" ${course.featured ? 'checked' : ''}
                                                       onchange="quickToggleFeatured(${course.id}, this.checked)">
                                                <span class="visibility-slider"></span>
                                            </label>
                                            <span style="font-size: 13px; color: #666;">Featured</span>
                                        </div>

                                        <!-- Category Dropdown -->
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="font-size: 13px; color: #666;">Category:</span>
                                            <select onchange="quickUpdateCategory(${course.id}, this.value)"
                                                    style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                                <option value="">Select</option>
                                                <option value="Web Development" ${course.category === 'Web Development' ? 'selected' : ''}>Web Dev</option>
                                                <option value="App Development" ${course.category === 'App Development' ? 'selected' : ''}>App Dev</option>
                                                <option value="Machine Learning" ${course.category === 'Machine Learning' ? 'selected' : ''}>ML</option>
                                                <option value="Cloud Computing" ${course.category === 'Cloud Computing' ? 'selected' : ''}>Cloud</option>
                                                <option value="Data Science" ${course.category === 'Data Science' ? 'selected' : ''}>Data Sci</option>
                                                <option value="Artificial Intelligence" ${course.category === 'Artificial Intelligence' ? 'selected' : ''}>AI</option>
                                                <option value="DevOps" ${course.category === 'DevOps' ? 'selected' : ''}>DevOps</option>
                                                <option value="Cybersecurity" ${course.category === 'Cybersecurity' ? 'selected' : ''}>Security</option>
                                                <option value="General" ${course.category === 'General' ? 'selected' : ''}>General</option>
                                            </select>
                                        </div>

                                        <!-- Price Edit -->
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="font-size: 13px; color: #666;">Price: $</span>
                                            <input type="number" value="${course.price || 0}"
                                                   step="0.01" min="0"
                                                   onblur="quickUpdatePrice(${course.id}, this.value)"
                                                   onkeypress="if(event.key === 'Enter') this.blur()"
                                                   style="width: 80px; padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                                        </div>
                                    </div>
                                </div>

                                <!-- Course Stats -->
                                <div style="display: flex; gap: 20px; margin-top: 10px; font-size: 14px; color: #999;">
                                    ${course.instructor ? `<span>👨‍🏫 ${course.instructor}</span>` : ''}
                                    ${course.level ? `<span>📊 ${course.level}</span>` : ''}
                                    ${course.students_count ? `<span>👥 ${course.students_count} students</span>` : ''}
                                    ${course.rating ? `<span>⭐ ${course.rating}/5</span>` : ''}
                                    ${course.duration ? `<span>⏱️ ${course.duration}</span>` : ''}
                                    ${course.lessons_count ? `<span>📚 ${course.lessons_count} lessons</span>` : ''}
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div style="display: flex; flex-direction: column; gap: 10px; margin-left: 20px;">
                                <button class="btn btn-small" onclick="openCourseDetailsModal(${course.id})" style="background: #667eea; color: white;">
                                    📝 Edit Details
                                </button>
                                <button class="btn btn-small preview-btn" onclick="window.open('/detail_courses.html?id=${course.id}&preview=true', '_blank')" style="background: #28a745; color: white;">
                                    👁️ Preview
                                </button>
                                <button class="btn btn-small btn-danger delete-btn" onclick="deleteCourse(${course.id})">
                                    🗑️ Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            console.log('📝 Setting coursesList innerHTML with Quick Actions');
            coursesList.innerHTML = html;
            console.log('✅ Courses displayed with Quick Actions, element count:', coursesList.children.length);
        }

        // Quick Action Functions
        async function quickToggleVisible(courseId, isVisible) {
            try {
                console.log(`🔄 Quick updating visibility for course ${courseId} to ${isVisible}`);
                const response = await fetch(`${API_BASE}/nd/courses/${courseId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ visible: isVisible })
                });

                if (response.ok) {
                    showToast(`Course visibility ${isVisible ? 'enabled' : 'disabled'}`, 'success');
                    // Update local data
                    const course = allCourses.find(c => c.id === courseId);
                    if (course) course.visible = isVisible;
                } else {
                    showToast('Failed to update visibility', 'error');
                    displayCourses(); // Refresh to show correct state
                }
            } catch (error) {
                console.error('Error updating visibility:', error);
                showToast('Error updating visibility', 'error');
                displayCourses(); // Refresh to show correct state
            }
        }

        async function quickToggleFeatured(courseId, isFeatured) {
            try {
                console.log(`🔄 Quick updating featured status for course ${courseId} to ${isFeatured}`);
                const response = await fetch(`${API_BASE}/nd/courses/${courseId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ featured: isFeatured })
                });

                if (response.ok) {
                    showToast(`Course ${isFeatured ? 'featured' : 'unfeatured'}`, 'success');
                    // Update local data
                    const course = allCourses.find(c => c.id === courseId);
                    if (course) course.featured = isFeatured;
                    displayCourses(); // Refresh to show badges
                } else {
                    showToast('Failed to update featured status', 'error');
                    displayCourses(); // Refresh to show correct state
                }
            } catch (error) {
                console.error('Error updating featured status:', error);
                showToast('Error updating featured status', 'error');
                displayCourses(); // Refresh to show correct state
            }
        }

        async function quickUpdateCategory(courseId, category) {
            if (!category) return;

            try {
                console.log(`🔄 Quick updating category for course ${courseId} to ${category}`);
                const response = await fetch(`${API_BASE}/nd/courses/${courseId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category: category })
                });

                if (response.ok) {
                    showToast(`Category updated to ${category}`, 'success');
                    // Update local data
                    const course = allCourses.find(c => c.id === courseId);
                    if (course) course.category = category;
                } else {
                    showToast('Failed to update category', 'error');
                    displayCourses(); // Refresh to show correct state
                }
            } catch (error) {
                console.error('Error updating category:', error);
                showToast('Error updating category', 'error');
                displayCourses(); // Refresh to show correct state
            }
        }

        async function quickUpdatePrice(courseId, price) {
            const numPrice = parseFloat(price) || 0;

            try {
                console.log(`🔄 Quick updating price for course ${courseId} to $${numPrice}`);
                const response = await fetch(`${API_BASE}/nd/courses/${courseId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ price: numPrice })
                });

                if (response.ok) {
                    showToast(`Price updated to $${numPrice}`, 'success');
                    // Update local data
                    const course = allCourses.find(c => c.id === courseId);
                    if (course) course.price = numPrice;
                } else {
                    showToast('Failed to update price', 'error');
                    displayCourses(); // Refresh to show correct state
                }
            } catch (error) {
                console.error('Error updating price:', error);
                showToast('Error updating price', 'error');
                displayCourses(); // Refresh to show correct state
            }
        }

        function showAddCourseForm() {
            document.getElementById('courseFormTitle').textContent = 'Add New Course';
            document.getElementById('courseForm').style.display = 'block';
            document.getElementById('coursesList').style.display = 'none';

            // Clear form
            editingCourseId = null;
            document.getElementById('course_id').value = '';
            document.getElementById('courseTitle').value = '';
            document.getElementById('courseDescription').value = '';
            document.getElementById('courseShortDescription').value = '';
            document.getElementById('coursePrice').value = '';
            document.getElementById('courseOldPrice').value = '';
            document.getElementById('courseDuration').value = '';
            document.getElementById('courseLevel').value = '';
            document.getElementById('courseCategory').value = '';
            document.getElementById('courseInstructor').value = '';
            document.getElementById('courseImage').value = '';
            document.getElementById('course_video_url').value = '';
            document.getElementById('course_link').value = '';
            document.getElementById('course_rating').value = '';
            document.getElementById('course_students').value = '';
            document.getElementById('course_reviews').value = '';
            document.getElementById('course_lessons').value = '';
            document.getElementById('course_features').value = '';
            document.getElementById('course_syllabus').value = '';
            document.getElementById('course_featured').checked = false;
            document.getElementById('course_visible').checked = true;

            // Scroll to form
            document.getElementById('courseForm').scrollIntoView({ behavior: 'smooth' });
        }

        function editCourse(courseId) {
            const course = allCourses.find(c => c.id === courseId);
            if (!course) return;

            editingCourseId = courseId;
            document.getElementById('courseFormTitle').textContent = 'Edit Course';
            document.getElementById('courseForm').style.display = 'block';
            document.getElementById('coursesList').style.display = 'none';

            // Populate form
            document.getElementById('course_id').value = course.id;
            document.getElementById('courseTitle').value = course.title || '';
            document.getElementById('courseDescription').value = course.description || '';
            document.getElementById('courseShortDescription').value = course.short_description || '';
            document.getElementById('coursePrice').value = course.price || '';
            document.getElementById('courseOldPrice').value = course.old_price || '';
            document.getElementById('courseDuration').value = course.duration || '';
            document.getElementById('courseLevel').value = course.level || '';
            document.getElementById('courseCategory').value = course.category || '';
            document.getElementById('courseInstructor').value = course.instructor || '';
            document.getElementById('courseImage').value = course.image || '';
            document.getElementById('course_video_url').value = course.video_url || '';
            document.getElementById('course_link').value = course.link || '';
            document.getElementById('course_rating').value = course.rating || '';
            document.getElementById('course_students').value = course.students_count || '';
            document.getElementById('course_reviews').value = course.reviews_count || '';
            document.getElementById('course_lessons').value = course.lessons_count || '';
            document.getElementById('course_features').value = Array.isArray(course.features) ? course.features.join(', ') : (course.features || '');
            document.getElementById('course_syllabus').value = Array.isArray(course.syllabus) ? course.syllabus.join('\n') : (course.syllabus || '');
            document.getElementById('course_featured').checked = course.featured || false;
            document.getElementById('course_visible').checked = course.visible !== false;

            // Scroll to form
            document.getElementById('courseForm').scrollIntoView({ behavior: 'smooth' });
        }

        async function saveCourse() {
            const courseData = {
                title: document.getElementById('courseTitle').value,
                description: document.getElementById('courseDescription').value,
                short_description: document.getElementById('courseShortDescription').value,
                price: parseFloat(document.getElementById('coursePrice').value) || null,
                old_price: parseFloat(document.getElementById('courseOldPrice').value) || null,
                duration: document.getElementById('courseDuration').value,
                level: document.getElementById('courseLevel').value,
                category: document.getElementById('courseCategory').value,
                instructor: document.getElementById('courseInstructor').value,
                image: document.getElementById('courseImage').value,
                video_url: document.getElementById('course_video_url').value,
                link: document.getElementById('course_link').value,
                rating: parseFloat(document.getElementById('course_rating').value) || null,
                students: parseInt(document.getElementById('course_students').value) || null,
                reviews: document.getElementById('course_reviews').value || '',
                lessons: document.getElementById('course_lessons').value || '',
                features: document.getElementById('course_features').value.split(',').map(f => f.trim()).filter(f => f),
                syllabus: document.getElementById('course_syllabus').value.split('\n').map(s => s.trim()).filter(s => s),
                featured: document.getElementById('course_featured').checked,
                visible: document.getElementById('course_visible').checked
            };

            if (!courseData.title || !courseData.description) {
                showToast('Please fill in required fields (Title and Description)', 'error');
                return;
            }

            showLoading();
            try {
                // Map field names to match database schema
                const apiData = {
                    title: courseData.title,
                    description: courseData.description,
                    short_description: courseData.short_description,
                    price: courseData.price,
                    old_price: courseData.old_price,
                    duration: courseData.duration,
                    level: courseData.level,
                    category: courseData.category,
                    instructor: courseData.instructor,
                    image: courseData.image,
                    video_url: courseData.video_url,
                    url: courseData.link || '', // Will be auto-generated after creation
                    rating: courseData.rating,
                    reviews_count: parseInt(courseData.reviews?.replace(/[^0-9]/g, '')) || 0,
                    students_count: courseData.students,
                    lessons_count: parseInt(courseData.lessons?.replace(/[^0-9]/g, '')) || 0,
                    features: courseData.features,
                    syllabus: courseData.syllabus,
                    featured: courseData.featured,
                    visible: courseData.visible
                };

                // Save directly to nd_courses table
                const response = await fetch(
                    editingCourseId !== null
                        ? `${API_BASE}/nd/courses/${editingCourseId}`
                        : `${API_BASE}/nd/courses`,
                    {
                        method: editingCourseId !== null ? 'PUT' : 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(apiData)
                    }
                );

                const result = await response.json();

                if (result.success || response.ok) {
                    // If creating a new course, update its URL with auto-generated value
                    if (editingCourseId === null && result.data && result.data.id) {
                        await fetch(`${API_BASE}/nd/courses/${result.data.id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ url: `/detail_courses.html?id=${result.data.id}` })
                        });
                    }

                    showToast(editingCourseId !== null ? 'Course updated successfully' : 'Course created successfully', 'success');
                    cancelCourseForm();
                    await loadAllCourses();
                    // Rebuild search index
                    setTimeout(buildSearchIndex, 500);
                } else {
                    throw new Error(result.message || 'Failed to save course');
                }
            } catch (error) {
                showToast('Failed to save course', 'error');
                console.error(error);
            } finally {
                hideLoading();
            }
        }

        async function deleteCourse(courseId) {
            if (!confirm('Are you sure you want to delete this course?')) return;

            showLoading();
            try {
                // Delete directly from nd_courses table
                const response = await fetch(`${API_BASE}/nd/courses/${courseId}`, {
                    method: 'DELETE'
                });

                const result = await response.json();

                if (result.success || response.ok) {
                    showToast('Course deleted successfully', 'success');
                    await loadAllCourses();
                    // Rebuild search index
                    setTimeout(buildSearchIndex, 500);
                } else {
                    throw new Error(result.message || 'Failed to delete course');
                }
            } catch (error) {
                showToast('Failed to delete course', 'error');
                console.error(error);
            } finally {
                hideLoading();
            }
        }

        function cancelCourseForm() {
            document.getElementById('courseForm').style.display = 'none';
            document.getElementById('coursesList').style.display = 'block';
            editingCourseId = null;
        }

        // Course Details Modal Functions
        let currentEditingCourse = null;
        let courseAutoSaveInterval = null;
        let courseLessons = [];

        function openCourseDetailsModal(courseId) {
            const course = allCourses.find(c => c.id === courseId);
            if (!course) {
                console.error('Course not found:', courseId);
                return;
            }

            currentEditingCourse = course;
            document.getElementById('modal_course_id').value = course.id;
            document.getElementById('modalCourseTitle').textContent = `Edit: ${course.title || 'Untitled Course'}`;

            // Populate Basic Info tab
            document.getElementById('modal_course_title').value = course.title || '';
            document.getElementById('modal_course_description').value = course.description || '';
            document.getElementById('modal_course_short_description').value = course.short_description || '';
            document.getElementById('modal_course_price').value = course.price || 0;
            document.getElementById('modal_course_old_price').value = course.old_price || '';

            // Populate Details tab
            document.getElementById('modal_course_duration').value = course.duration || '';
            document.getElementById('modal_course_level').value = course.level || '';
            document.getElementById('modal_course_category').value = course.category || '';
            document.getElementById('modal_course_features').value = course.features || '';
            document.getElementById('modal_course_requirements').value = course.requirements || '';
            document.getElementById('modal_course_objectives').value = course.objectives || '';

            // Populate Instructor tab
            document.getElementById('modal_course_instructor').value = course.instructor || '';
            document.getElementById('modal_instructor_bio').value = course.instructor_bio || '';
            document.getElementById('modal_instructor_photo').value = course.instructor_photo || '';

            // Populate Media tab
            document.getElementById('modal_course_image').value = course.image || '';
            document.getElementById('modal_course_video_url').value = course.video_url || '';
            document.getElementById('modal_course_banner').value = course.banner_image || '';

            // Load lessons
            loadCourseLessons(course.lessons || course.syllabus || '');

            // Show modal and reset to first tab
            document.getElementById('courseDetailsModal').style.display = 'block';
            switchModalTab('basic');

            // Start auto-save
            startAutoSave();
        }

        function closeCourseDetailsModal() {
            document.getElementById('courseDetailsModal').style.display = 'none';
            currentEditingCourse = null;
            stopAutoSave();
        }

        function switchModalTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.modal-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            // Show selected tab
            document.getElementById('tab-' + tabName).style.display = 'block';

            // Update active tab button
            document.querySelectorAll('.modal-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.modal-tab[data-tab="${tabName}"]`).classList.add('active');
        }

        async function saveCourseFromModal(closeAfterSave = false) {
            if (!currentEditingCourse) return;

            const courseData = {
                title: document.getElementById('modal_course_title').value,
                description: document.getElementById('modal_course_description').value,
                short_description: document.getElementById('modal_course_short_description').value,
                price: parseFloat(document.getElementById('modal_course_price').value) || 0,
                old_price: parseFloat(document.getElementById('modal_course_old_price').value) || null,
                duration: document.getElementById('modal_course_duration').value,
                level: document.getElementById('modal_course_level').value,
                category: document.getElementById('modal_course_category').value,
                features: document.getElementById('modal_course_features').value,
                requirements: document.getElementById('modal_course_requirements').value,
                objectives: document.getElementById('modal_course_objectives').value,
                instructor: document.getElementById('modal_course_instructor').value,
                instructor_bio: document.getElementById('modal_instructor_bio').value,
                instructor_photo: document.getElementById('modal_instructor_photo').value,
                image: document.getElementById('modal_course_image').value,
                video_url: document.getElementById('modal_course_video_url').value,
                banner_image: document.getElementById('modal_course_banner').value,
                lessons: JSON.stringify(courseLessons),
                // Auto-generate URL for detail_courses.html
                url: `/detail_courses.html?id=${currentEditingCourse.id}`
            };

            showLoading();
            try {
                const response = await fetch(`${API_BASE}/nd/courses/${currentEditingCourse.id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(courseData)
                });

                if (response.ok) {
                    showToast('Course updated successfully', 'success');
                    await loadAllCourses();

                    if (closeAfterSave) {
                        closeCourseDetailsModal();
                    }
                } else {
                    showToast('Failed to save course', 'error');
                }
            } catch (error) {
                console.error('Error saving course:', error);
                showToast('Error saving course', 'error');
            } finally {
                hideLoading();
            }
        }

        // Lesson Management
        function loadCourseLessons(lessonsData) {
            courseLessons = [];

            if (typeof lessonsData === 'string' && lessonsData) {
                // Parse lessons from string (syllabus format)
                const lines = lessonsData.split('\n').filter(line => line.trim());
                courseLessons = lines.map((line, index) => ({
                    id: index + 1,
                    title: line.trim(),
                    duration: '30 minutes',
                    type: 'video'
                }));
            } else if (Array.isArray(lessonsData)) {
                courseLessons = lessonsData;
            }

            renderLessons();
        }

        function renderLessons() {
            const lessonsList = document.getElementById('lessonsList');
            if (!lessonsList) return;

            lessonsList.innerHTML = '';

            courseLessons.forEach((lesson, index) => {
                const lessonItem = document.createElement('div');
                lessonItem.className = 'lesson-item';
                lessonItem.draggable = true;
                lessonItem.dataset.lessonId = lesson.id || index;

                lessonItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span style="font-size: 18px; cursor: move;">☰</span>
                        <span style="font-weight: bold;">Lesson ${index + 1}:</span>
                        <input type="text" value="${lesson.title || ''}"
                               onchange="updateLesson(${index}, 'title', this.value)"
                               style="flex: 1; padding: 5px 10px; border: 1px solid #ddd; border-radius: 4px;">
                        <input type="text" value="${lesson.duration || '30 minutes'}"
                               onchange="updateLesson(${index}, 'duration', this.value)"
                               style="width: 120px; padding: 5px 10px; border: 1px solid #ddd; border-radius: 4px;"
                               placeholder="Duration">
                    </div>
                    <button class="btn btn-small btn-danger" onclick="removeLesson(${index})">🗑️</button>
                `;

                // Add drag and drop events
                lessonItem.addEventListener('dragstart', handleDragStart);
                lessonItem.addEventListener('dragover', handleDragOver);
                lessonItem.addEventListener('drop', handleDrop);
                lessonItem.addEventListener('dragend', handleDragEnd);

                lessonsList.appendChild(lessonItem);
            });
        }

        function addLesson() {
            const newLesson = {
                id: Date.now(),
                title: 'New Lesson',
                duration: '30 minutes',
                type: 'video'
            };
            courseLessons.push(newLesson);
            renderLessons();
        }

        function updateLesson(index, field, value) {
            if (courseLessons[index]) {
                courseLessons[index][field] = value;
            }
        }

        function removeLesson(index) {
            courseLessons.splice(index, 1);
            renderLessons();
        }

        // Drag and Drop for lessons
        let draggedLesson = null;

        function handleDragStart(e) {
            draggedLesson = this;
            this.classList.add('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            return false;
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }

            if (draggedLesson !== this) {
                const draggedIndex = Array.from(this.parentNode.children).indexOf(draggedLesson);
                const targetIndex = Array.from(this.parentNode.children).indexOf(this);

                // Swap lessons in array
                const temp = courseLessons[draggedIndex];
                courseLessons[draggedIndex] = courseLessons[targetIndex];
                courseLessons[targetIndex] = temp;

                renderLessons();
            }

            return false;
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
        }

        // Auto-save functionality
        function startAutoSave() {
            stopAutoSave(); // Clear any existing interval
            courseAutoSaveInterval = setInterval(() => {
                console.log('⏰ Auto-saving course...');
                saveCourseFromModal(false);
            }, 30000); // Save every 30 seconds
        }

        function stopAutoSave() {
            if (courseAutoSaveInterval) {
                clearInterval(courseAutoSaveInterval);
                courseAutoSaveInterval = null;
            }
        }

        // ==========================================
        // PRICING PAGE FUNCTIONS
        // ==========================================

        async function loadPricingData() {
            try {
                showLoading();
                console.log('📊 Loading pricing data from nd_pricing_page...');

                const response = await fetch(`${API_BASE}/nd/pricing-page?locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data) {
                    const sections = result.data.attributes?.sections || {};

                    // Hero section
                    const hero = sections.hero || {};
                    const heroTitle = document.getElementById('pricing_hero_title');
                    const heroSubtitle = document.getElementById('pricing_hero_subtitle');
                    const heroVisible = document.getElementById('pricing_hero_visible');
                    if (heroTitle) heroTitle.value = hero.title || '';
                    if (heroSubtitle) heroSubtitle.value = hero.subtitle || '';
                    if (heroVisible) heroVisible.checked = hero.visible !== false;

                    // Features Comparison section
                    const featuresComparison = sections.features_comparison || {};
                    const fcTitle = document.getElementById('pricing_features_comparison_title');
                    const fcSubtitle = document.getElementById('pricing_features_comparison_subtitle');
                    const fcDescription = document.getElementById('pricing_features_comparison_description');
                    const fcVisible = document.getElementById('pricing_features_comparison_visible');
                    if (fcTitle) fcTitle.value = featuresComparison.title || '';
                    if (fcSubtitle) fcSubtitle.value = featuresComparison.subtitle || '';
                    if (fcDescription) fcDescription.value = featuresComparison.description || '';
                    if (fcVisible) fcVisible.checked = featuresComparison.visible !== false;

                    // FAQs section
                    const faqs = sections.faqs || {};
                    const faqsTitle = document.getElementById('pricing_faqs_title');
                    const faqsSubtitle = document.getElementById('pricing_faqs_subtitle');
                    const faqsDescription = document.getElementById('pricing_faqs_description');
                    const faqsVisible = document.getElementById('pricing_faqs_visible');
                    if (faqsTitle) faqsTitle.value = faqs.title || '';
                    if (faqsSubtitle) faqsSubtitle.value = faqs.subtitle || '';
                    if (faqsDescription) faqsDescription.value = faqs.description || '';
                    if (faqsVisible) faqsVisible.checked = faqs.visible !== false;

                    // Testimonials section
                    const testimonials = sections.testimonials || {};
                    const testTitle = document.getElementById('pricing_testimonials_title');
                    const testSubtitle = document.getElementById('pricing_testimonials_subtitle');
                    const testDescription = document.getElementById('pricing_testimonials_description');
                    const testVisible = document.getElementById('pricing_testimonials_visible');
                    if (testTitle) testTitle.value = testimonials.title || '';
                    if (testSubtitle) testSubtitle.value = testimonials.subtitle || '';
                    if (testDescription) testDescription.value = testimonials.description || '';
                    if (testVisible) testVisible.checked = testimonials.visible !== false;

                    // CTA section
                    const cta = sections.cta || {};
                    const ctaTitle = document.getElementById('pricing_cta_title');
                    const ctaDescription = document.getElementById('pricing_cta_description');
                    const ctaBtnText = document.getElementById('pricing_cta_button_text');
                    const ctaBtnUrl = document.getElementById('pricing_cta_button_url');
                    const ctaVisible = document.getElementById('pricing_cta_visible');
                    if (ctaTitle) ctaTitle.value = cta.title || '';
                    if (ctaDescription) ctaDescription.value = cta.description || '';
                    if (ctaBtnText) ctaBtnText.value = cta.button_text || '';
                    if (ctaBtnUrl) ctaBtnUrl.value = cta.button_url || '';
                    if (ctaVisible) ctaVisible.checked = cta.visible !== false;

                    // Plans section visibility and description
                    const plans = sections.plans || {};
                    const plansVisible = document.getElementById('pricing_plans_visible');
                    const plansDesc = document.getElementById('pricing_plans_description');
                    if (plansVisible) plansVisible.checked = plans.visible !== false;
                    if (plansDesc) plansDesc.value = plans.description || '';

                    // Load pricing plans
                    const plansContainer = document.getElementById('pricingPlansList');
                    plansContainer.innerHTML = '';

                    const plansData = sections.plans?.plans || [];
                    if (Array.isArray(plansData)) {
                        plansData.forEach(plan => addPricingPlanItem(plan));
                    }

                    showToast('Pricing data loaded successfully', 'success');
                    // Rebuild search index after pricing data loads
                    setTimeout(() => {
                        buildSearchIndex();
                        console.log('🔍 Search index rebuilt after pricing data load');
                    }, 500);
                } else {
                    showToast('No pricing data found', 'warning');
                }
            } catch (error) {
                console.error('Error loading pricing data:', error);
                showToast('Failed to load pricing data', 'error');
            } finally {
                hideLoading();
            }
        }

        async function savePricingData() {
            try {
                showLoading();
                console.log('💾 Saving pricing data to nd_pricing_page...');

                // Collect pricing plans
                const plans = [];
                document.querySelectorAll('#pricingPlansList .pricing-plan-item').forEach(item => {
                    const featuresText = item.querySelector('[data-field="features"]').value;
                    plans.push({
                        name: item.querySelector('[data-field="name"]').value,
                        monthly_price: item.querySelector('[data-field="monthly_price"]').value,
                        yearly_price: item.querySelector('[data-field="yearly_price"]').value,
                        description: item.querySelector('[data-field="description"]').value,
                        features: featuresText.split('\n').map(f => f.trim()).filter(f => f),
                        button_text: item.querySelector('[data-field="button_text"]').value,
                        button_url: item.querySelector('[data-field="button_url"]').value,
                        featured: item.querySelector('[data-field="featured"]')?.checked || false,
                        // Keep legacy fields for backward compatibility
                        price: item.querySelector('[data-field="monthly_price"]').value,
                        price_period: '/month'
                    });
                });

                const pricingData = {
                    hero: {
                        title: document.getElementById('pricing_hero_title').value,
                        subtitle: document.getElementById('pricing_hero_subtitle').value,
                        visible: document.getElementById('pricing_hero_visible').checked
                    },
                    plans: {
                        plans: plans,
                        description: document.getElementById('pricing_plans_description').value,
                        visible: document.getElementById('pricing_plans_visible').checked
                    },
                    features_comparison: {
                        title: document.getElementById('pricing_features_comparison_title').value,
                        subtitle: document.getElementById('pricing_features_comparison_subtitle').value,
                        description: document.getElementById('pricing_features_comparison_description').value,
                        visible: document.getElementById('pricing_features_comparison_visible').checked
                    },
                    faqs: {
                        title: document.getElementById('pricing_faqs_title').value,
                        subtitle: document.getElementById('pricing_faqs_subtitle').value,
                        description: document.getElementById('pricing_faqs_description').value,
                        visible: document.getElementById('pricing_faqs_visible').checked
                    },
                    testimonials: {
                        title: document.getElementById('pricing_testimonials_title').value,
                        subtitle: document.getElementById('pricing_testimonials_subtitle').value,
                        description: document.getElementById('pricing_testimonials_description').value,
                        visible: document.getElementById('pricing_testimonials_visible').checked
                    },
                    cta: {
                        title: document.getElementById('pricing_cta_title').value,
                        description: document.getElementById('pricing_cta_description').value,
                        button_text: document.getElementById('pricing_cta_button_text').value,
                        button_url: document.getElementById('pricing_cta_button_url').value,
                        visible: document.getElementById('pricing_cta_visible').checked
                    }
                };

                // Save each section separately
                const sections = {
                    hero: pricingData.hero,
                    plans: pricingData.plans,
                    features_comparison: pricingData.features_comparison,
                    faqs: pricingData.faqs,
                    testimonials: pricingData.testimonials,
                    cta: pricingData.cta
                };

                let allSuccess = true;
                for (const [sectionName, content] of Object.entries(sections)) {
                    const response = await fetch(`${API_BASE}/nd/pricing-page/${sectionName}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ content, locale: currentLang })
                    });

                    if (!response.ok) {
                        allSuccess = false;
                        console.error(`Failed to save ${sectionName} section`);
                    }
                }

                if (allSuccess) {
                    showToast('Pricing data saved successfully', 'success');
                } else {
                    throw new Error('Some sections failed to save');
                }
            } catch (error) {
                console.error('Error saving pricing data:', error);
                showToast('Failed to save pricing data', 'error');
            } finally {
                hideLoading();
            }
        }

        function addPricingPlanItem(data = {}) {
            const container = document.getElementById('pricingPlansList');
            const item = document.createElement('div');
            item.className = 'pricing-plan-item';
            item.style.cssText = 'background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px;';

            item.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="Plan Name" value="${data.name || ''}" data-field="name">
                </div>

                <div style="background: #e8f4f8; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
                    <label style="font-weight: bold; display: block; margin-bottom: 10px;">💰 Pricing (Monthly & Yearly):</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 12px; color: #666;">Monthly Price:</label>
                            <input type="text" placeholder="$29/month" value="${data.monthly_price || data.price || ''}" data-field="monthly_price">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 12px; color: #666;">Yearly Price:</label>
                            <input type="text" placeholder="$290/year" value="${data.yearly_price || ''}" data-field="yearly_price">
                        </div>
                    </div>
                </div>

                <textarea placeholder="Plan Description" data-field="description" rows="2" style="margin-bottom: 10px;">${data.description || ''}</textarea>

                <div style="margin-bottom: 10px;">
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">Features (one per line - e.g., "Access All Courses"):</label>
                    <textarea placeholder="Enter features one per line:\n✓ Access All Courses\n✓ Priority Support\n✓ Certificate of Completion" data-field="features" rows="6" style="width: 100%; font-family: monospace;">${Array.isArray(data.features) ? data.features.join('\n') : (data.features || '')}</textarea>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="Button Text" value="${data.button_text || 'Get Started'}" data-field="button_text">
                    <input type="text" placeholder="Button URL" value="${data.button_url || '#'}" data-field="button_url">
                </div>

                <div style="display: flex; gap: 10px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" ${data.featured ? 'checked' : ''} data-field="featured">
                        Featured Plan
                    </label>
                    <button class="btn btn-small btn-danger" onclick="this.parentElement.parentElement.remove()">Remove</button>
                </div>
            `;

            container.appendChild(item);
        }

        // ==================== TEACHERS MANAGEMENT FUNCTIONS ====================

        // ==================== INDIVIDUAL TEACHER PROFILES MANAGEMENT ====================

        let editingTeacherId = null;

        // Load all teachers
        async function loadAllTeachers() {
            try {
                console.log('🔄 Loading teachers from entity_teachers table...');

                const response = await fetch(`${API_BASE}/nd/teachers`);
                const result = await response.json();

                if (result.success && result.data && result.data.length > 0) {
                    console.log('✅ Teachers loaded:', result.data);
                    renderTeachersList(result.data);
                } else {
                    console.log('📝 No teachers in database');
                    document.getElementById('teachersList').innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #666;">
                            <p>📚 No teachers yet. Add your first teacher!</p>
                            <button class="btn btn-small btn-success" onclick="showAddTeacherForm()">➕ Add Your First Teacher</button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading teachers:', error);
                showToast('Failed to load teachers', 'error');
            }
        }

        // Render teachers list with Quick Actions
        function renderTeachersList(teachers) {
            const html = teachers.map(teacher => `
                <div class="course-item" style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; border: 1px solid #e0e0e0; display: flex; gap: 15px; align-items: center;">
                    <img src="${teacher.profile_image_url || 'images/placeholder.jpg'}"
                         alt="${teacher.full_name}"
                         style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover;">

                    <div style="flex: 1;">
                        <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 8px;">
                            <strong style="color: #333; font-size: 16px;">${teacher.full_name}</strong>
                            <span style="color: #667eea; font-weight: 500;">${teacher.professional_title || 'Professional'}</span>
                            <span style="color: #666; font-size: 14px;">${teacher.company || ''}</span>
                        </div>

                        <div style="display: flex; gap: 20px; align-items: center; font-size: 14px; color: #666;">
                            <span>⭐ ${teacher.statistics?.rating || 'N/A'}</span>
                            <span>👥 ${teacher.statistics?.students_taught || 0} students</span>
                            <span>📚 ${teacher.statistics?.courses_count || 0} courses</span>
                            <span>💼 ${teacher.statistics?.years_experience || 0}+ years</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <!-- Quick Actions -->
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" ${teacher.is_featured ? 'checked' : ''}
                                   onchange="updateTeacherProperty(${teacher.id}, 'is_featured', this.checked)"
                                   style="transform: scale(0.9);">
                            Featured
                        </label>

                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" ${teacher.is_active ? 'checked' : ''}
                                   onchange="updateTeacherProperty(${teacher.id}, 'is_active', this.checked)"
                                   style="transform: scale(0.9);">
                            Active
                        </label>

                        <input type="number" value="${teacher.display_order || 0}"
                               onchange="updateTeacherProperty(${teacher.id}, 'display_order', parseInt(this.value))"
                               style="width: 60px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"
                               title="Display Order">

                        <button class="btn btn-primary" onclick="editTeacherDetails(${teacher.id})" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; margin-right: 8px;">✏️ Edit Details</button>
                        <button class="btn btn-success" onclick="previewTeacherProfile(${teacher.id})" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; margin-right: 8px;">👁️ Preview</button>
                        <button class="btn btn-danger" onclick="deleteTeacher(${teacher.id})" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600;">🗑️ Delete</button>
                    </div>
                </div>
            `).join('');

            console.log('📝 Setting teachersList innerHTML with Quick Actions');
            document.getElementById('teachersList').innerHTML = html;
            console.log('✅ Teachers displayed with Quick Actions, element count:', document.getElementById('teachersList').children.length);
        }

        // Show add teacher form
        function showAddTeacherForm() {
            document.getElementById('teacherFormTitle').textContent = 'Add New Teacher';
            clearTeacherForm();
            document.getElementById('teachersList').style.display = 'none';
            document.getElementById('teacherForm').style.display = 'block';
            document.getElementById('previewTeacherBtn').style.display = 'none';
            editingTeacherId = null;
        }

        // Edit teacher
        function editTeacher(teacherId) {
            console.log('✏️ Editing teacher:', teacherId);

            // Find teacher data
            const teachers = JSON.parse(localStorage.getItem('currentTeachers') || '[]');
            const teacher = teachers.find(t => t.id === teacherId);

            if (!teacher) {
                // Fetch from API if not in localStorage
                fetchTeacherForEdit(teacherId);
                return;
            }

            editingTeacherId = teacherId;
            document.getElementById('teacherFormTitle').textContent = 'Edit Teacher';
            fillTeacherForm(teacher);
            document.getElementById('teachersList').style.display = 'none';
            document.getElementById('teacherForm').style.display = 'block';
            document.getElementById('previewTeacherBtn').style.display = 'inline-block';
        }

        // Fetch teacher for editing
        async function fetchTeacherForEdit(teacherId) {
            try {
                const response = await fetch(`${API_BASE}/nd/teachers/${teacherId}`);
                const result = await response.json();

                if (result.success && result.data) {
                    editingTeacherId = teacherId;
                    document.getElementById('teacherFormTitle').textContent = 'Edit Teacher';
                    fillTeacherForm(result.data);
                    document.getElementById('teachersList').style.display = 'none';
                    document.getElementById('teacherForm').style.display = 'block';
                    document.getElementById('previewTeacherBtn').style.display = 'inline-block';
                } else {
                    showToast('Teacher not found', 'error');
                }
            } catch (error) {
                console.error('Error fetching teacher:', error);
                showToast('Failed to load teacher', 'error');
            }
        }

        // Fill teacher form with data
        function fillTeacherForm(teacher) {
            document.getElementById('teacher_full_name').value = teacher.full_name || '';
            document.getElementById('teacher_key').value = teacher.teacher_key || '';
            document.getElementById('teacher_professional_title').value = teacher.professional_title || '';
            document.getElementById('teacher_company').value = teacher.company || '';
            document.getElementById('teacher_profile_image_url').value = teacher.profile_image_url || '';
            document.getElementById('teacher_email').value = teacher.contact_info?.email || '';
            document.getElementById('teacher_bio').value = teacher.bio || '';

            // Skills
            if (teacher.skills && Array.isArray(teacher.skills)) {
                document.getElementById('teacher_skills').value = teacher.skills.join(', ');
            }

            // Statistics
            if (teacher.statistics) {
                document.getElementById('teacher_years_experience').value = teacher.statistics.years_experience || '';
                document.getElementById('teacher_students_taught').value = teacher.statistics.students_taught || '';
                document.getElementById('teacher_courses_count').value = teacher.statistics.courses_count || '';
                document.getElementById('teacher_rating').value = teacher.statistics.rating || '';
            }

            document.getElementById('teacher_is_featured').checked = teacher.is_featured || false;
            document.getElementById('teacher_is_active').checked = teacher.is_active !== false;
            document.getElementById('teacher_display_order').value = teacher.display_order || 0;
        }

        // Clear teacher form
        function clearTeacherForm() {
            document.getElementById('teacher_full_name').value = '';
            document.getElementById('teacher_key').value = '';
            document.getElementById('teacher_professional_title').value = '';
            document.getElementById('teacher_company').value = '';
            document.getElementById('teacher_profile_image_url').value = '';
            document.getElementById('teacher_email').value = '';
            document.getElementById('teacher_bio').value = '';
            document.getElementById('teacher_skills').value = '';
            document.getElementById('teacher_years_experience').value = '';
            document.getElementById('teacher_students_taught').value = '';
            document.getElementById('teacher_courses_count').value = '';
            document.getElementById('teacher_rating').value = '';
            document.getElementById('teacher_is_featured').checked = false;
            document.getElementById('teacher_is_active').checked = true;
            document.getElementById('teacher_display_order').value = 0;
        }

        // Save teacher data
        async function saveTeacherData() {
            try {
                console.log('💾 Saving teacher data...');

                // Collect form data
                const formData = {
                    teacher_key: document.getElementById('teacher_key').value,
                    full_name: document.getElementById('teacher_full_name').value,
                    professional_title: document.getElementById('teacher_professional_title').value,
                    company: document.getElementById('teacher_company').value,
                    bio: document.getElementById('teacher_bio').value,
                    profile_image_url: document.getElementById('teacher_profile_image_url').value,
                    skills: document.getElementById('teacher_skills').value.split(',').map(s => s.trim()).filter(s => s),
                    statistics: {
                        years_experience: parseInt(document.getElementById('teacher_years_experience').value) || 0,
                        students_taught: parseInt(document.getElementById('teacher_students_taught').value) || 0,
                        courses_count: parseInt(document.getElementById('teacher_courses_count').value) || 0,
                        rating: parseFloat(document.getElementById('teacher_rating').value) || 0
                    },
                    contact_info: {
                        email: document.getElementById('teacher_email').value
                    },
                    is_featured: document.getElementById('teacher_is_featured').checked,
                    is_active: document.getElementById('teacher_is_active').checked,
                    display_order: parseInt(document.getElementById('teacher_display_order').value) || 0
                };

                // Validate required fields
                if (!formData.full_name || !formData.teacher_key) {
                    showToast('Please fill in required fields: Full Name and Teacher Key', 'error');
                    return;
                }

                const url = editingTeacherId !== null
                    ? `${API_BASE}/nd/teachers/${editingTeacherId}`
                    : `${API_BASE}/nd/teachers`;

                const response = await fetch(url, {
                    method: editingTeacherId !== null ? 'PUT' : 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    showToast(editingTeacherId !== null ? 'Teacher updated successfully' : 'Teacher created successfully', 'success');
                    await loadAllTeachers();
                    cancelTeacherForm();
                } else {
                    showToast('Failed to save teacher: ' + (result.error || 'Unknown error'), 'error');
                }

            } catch (error) {
                console.error('Error saving teacher:', error);
                showToast('Failed to save teacher', 'error');
            }
        }

        // Cancel teacher form
        function cancelTeacherForm() {
            document.getElementById('teacherForm').style.display = 'none';
            document.getElementById('teachersList').style.display = 'block';
            editingTeacherId = null;
        }

        // Delete teacher
        async function deleteTeacher(teacherId) {
            if (!confirm('Are you sure you want to delete this teacher? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/nd/teachers/${teacherId}`, {
                    method: 'DELETE'
                });

                const result = await response.json();

                if (result.success) {
                    showToast('Teacher deleted successfully', 'success');
                    await loadAllTeachers();
                } else {
                    showToast('Failed to delete teacher: ' + (result.error || 'Unknown error'), 'error');
                }

            } catch (error) {
                console.error('Error deleting teacher:', error);
                showToast('Failed to delete teacher', 'error');
            }
        }

        // Update teacher property (Quick Action)
        async function updateTeacherProperty(teacherId, property, value) {
            try {
                const response = await fetch(`${API_BASE}/nd/teachers/${teacherId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ [property]: value })
                });

                const result = await response.json();

                if (result.success) {
                    showToast(`Teacher ${property} updated`, 'success');
                } else {
                    showToast(`Failed to update ${property}`, 'error');
                    // Reload to reset the UI
                    await loadAllTeachers();
                }

            } catch (error) {
                console.error(`Error updating ${property}:`, error);
                showToast(`Failed to update ${property}`, 'error');
                // Reload to reset the UI
                await loadAllTeachers();
            }
        }

        // Preview teacher profile
        function previewTeacherProfile(teacherId) {
            const previewUrl = `/detail_teacher.html?id=${teacherId}&preview=true`;
            window.open(previewUrl, '_blank');
            showToast('🔍 Opened teacher preview in new tab', 'info');
        }

        // Preview current teacher being edited
        function previewTeacher() {
            if (editingTeacherId) {
                previewTeacherProfile(editingTeacherId);
            }
        }

        // ==================== TEACHER MODAL FUNCTIONS ====================

        let currentEditingTeacherId = null;
        let teacherData = {};
        let teacherAutoSaveInterval = null;
        let teacherModalLang = 'en'; // Track current language in teacher modal

        // Open comprehensive teacher editing modal
        async function editTeacherDetails(teacherId) {
            currentEditingTeacherId = teacherId;
            console.log('✏️ Opening comprehensive teacher editor for ID:', teacherId);

            try {
                // Fetch teacher data with current locale
                const response = await fetch(`${API_BASE}/nd/teachers/${teacherId}?locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data) {
                    teacherData = result.data;

                    // Populate the modal with teacher data
                    populateTeacherModal(result.data);

                    // Show the modal
                    document.getElementById('teacherModal').style.display = 'block';

                    // Start auto-save
                    startTeacherAutoSave();

                    console.log('✅ Teacher comprehensive modal opened with data:', result.data);
                } else {
                    showToast('Failed to load teacher data', 'error');
                }
            } catch (error) {
                console.error('Error loading teacher for comprehensive edit:', error);
                showToast('Failed to load teacher data', 'error');
            }
        }

        // Populate comprehensive teacher modal with data
        function populateTeacherModal(teacher) {
            console.log('🎨 Populating teacher modal with data:', teacher);
            console.log('📋 Modal language:', teacherModalLang);

            // Get language-specific field values based on teacherModalLang
            const getLocalizedField = (fieldBase, teacher) => {
                if (teacherModalLang === 'en') {
                    return teacher[fieldBase] || '';
                }
                const localizedField = `${fieldBase}_${teacherModalLang}`;
                return teacher[localizedField] || teacher[fieldBase] || '';
            };

            // Update modal title with localized name
            const displayName = getLocalizedField('full_name', teacher);
            document.getElementById('teacherModalTitle').textContent = `Edit: ${displayName || 'Teacher'}`;

            // Basic Info Tab - Use localized fields
            document.getElementById('teacher-modal-name').value = getLocalizedField('full_name', teacher);
            document.getElementById('teacher-modal-key').value = teacher.teacher_key || '';
            document.getElementById('teacher-modal-title').value = getLocalizedField('professional_title', teacher);
            document.getElementById('teacher-modal-company').value = getLocalizedField('company', teacher);
            document.getElementById('teacher-modal-bio').value = getLocalizedField('bio', teacher);

            // Skills
            if (teacher.skills && Array.isArray(teacher.skills)) {
                document.getElementById('teacher-modal-skills').value = teacher.skills.join(', ');
            }

            // Details Tab - Statistics
            const stats = teacher.statistics || {};
            document.getElementById('teacher-modal-years').value = stats.years_experience || '';
            document.getElementById('teacher-modal-students').value = stats.students_taught || '';
            document.getElementById('teacher-modal-courses-count').value = stats.courses_count || '';
            document.getElementById('teacher-modal-rating').value = stats.rating || '';

            // Contact & Social
            const contactInfo = teacher.contact_info || {};
            const socialLinks = teacher.social_links || {};
            document.getElementById('teacher-modal-email').value = contactInfo.email || '';
            document.getElementById('teacher-modal-phone').value = contactInfo.phone || '';
            document.getElementById('teacher-modal-linkedin').value = socialLinks.linkedin || '';
            document.getElementById('teacher-modal-github').value = socialLinks.github || '';

            // Media Tab
            document.getElementById('teacher-modal-image').value = teacher.profile_image_url || '';

            // Experience Tab
            populateExperienceList(teacher.experience_history || []);

            // Courses Taught Tab
            populateCoursesTaughtList(teacher.courses_taught || []);

            // Reviews Tab
            populateReviewsList(teacher.student_reviews || []);

            // Set initial language in modal to match currentLang
            teacherModalLang = currentLang;
            updateTeacherLanguageButtons();

            console.log('✅ Teacher modal populated successfully');
        }

        // Switch language in teacher modal
        async function switchTeacherLanguage(lang) {
            teacherModalLang = lang;
            console.log('🌐 Switching teacher modal to language:', lang);

            // Update button styles
            updateTeacherLanguageButtons();

            // Re-fetch and populate teacher data with new language
            if (currentEditingTeacherId) {
                try {
                    const response = await fetch(`${API_BASE}/nd/teachers/${currentEditingTeacherId}?locale=${lang}`);
                    const result = await response.json();

                    if (result.success && result.data) {
                        teacherData = result.data;
                        populateTeacherModal(result.data);
                        console.log('✅ Teacher data reloaded for language:', lang);
                    }
                } catch (error) {
                    console.error('Error loading teacher for language switch:', error);
                    showToast('Failed to load teacher data', 'error');
                }
            }
        }

        // Update teacher language button styles
        function updateTeacherLanguageButtons() {
            document.querySelectorAll('.teacher-lang-btn').forEach(btn => {
                if (btn.dataset.lang === teacherModalLang) {
                    btn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    btn.style.color = 'white';
                    btn.style.border = '2px solid #667eea';
                } else {
                    btn.style.background = 'white';
                    btn.style.color = '#4a5568';
                    btn.style.border = '2px solid #e2e8f0';
                }
            });
        }

        // Switch tabs in teacher detail modal
        function switchTeacherTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.teacher-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            // Remove active class from all tabs
            document.querySelectorAll('.teacher-modal-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.background = '#e2e8f0';
                tab.style.color = '#718096';
            });

            // Show selected tab content
            const targetTab = document.getElementById(`teacher-tab-${tabName}`);
            if (targetTab) {
                targetTab.style.display = 'block';
            }

            // Add active class to selected tab
            const activeTab = document.querySelector(`.teacher-modal-tab[data-tab="${tabName}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
                activeTab.style.background = 'white';
                activeTab.style.color = '#667eea';
            }

            console.log(`✅ Switched to teacher tab: ${tabName}`);
        }

        // Save teacher data (matching courses pattern)
        async function saveTeacherData(action = 'save') {
            try {
                console.log('💾 Saving teacher data...');

                // Collect all form data from all tabs
                const formData = {
                    teacher_key: document.getElementById('teacher-modal-key').value,
                    full_name: document.getElementById('teacher-modal-name').value,
                    professional_title: document.getElementById('teacher-modal-title').value,
                    company: document.getElementById('teacher-modal-company').value,
                    bio: document.getElementById('teacher-modal-bio').value,
                    profile_image_url: document.getElementById('teacher-modal-image').value,

                    // Skills (convert from comma-separated to array)
                    skills: document.getElementById('teacher-modal-skills').value.split(',').map(s => s.trim()).filter(s => s),

                    // Statistics
                    statistics: {
                        years_experience: parseInt(document.getElementById('teacher-modal-years').value) || 0,
                        students_taught: parseInt(document.getElementById('teacher-modal-students').value) || 0,
                        courses_count: parseInt(document.getElementById('teacher-modal-courses-count').value) || 0,
                        rating: parseFloat(document.getElementById('teacher-modal-rating').value) || 5.0
                    },

                    // Contact info
                    contact_info: {
                        email: document.getElementById('teacher-modal-email').value,
                        phone: document.getElementById('teacher-modal-phone').value
                    },

                    // Social links
                    social_links: {
                        linkedin: document.getElementById('teacher-modal-linkedin').value,
                        github: document.getElementById('teacher-modal-github').value
                    },

                    // TODO: Add experience, courses taught, and reviews data collection
                    experience_history: teacherData.experience_history || [],
                    courses_taught: teacherData.courses_taught || [],
                    student_reviews: teacherData.student_reviews || [],

                    is_featured: teacherData.is_featured || false,
                    is_active: teacherData.is_active || true,
                    display_order: teacherData.display_order || 0
                };

                // API call
                const url = `${API_BASE}/nd/teachers/${currentEditingTeacherId}`;
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    showToast('✅ Teacher saved successfully', 'success');

                    // Update local data
                    teacherData = { ...teacherData, ...formData };

                    // Handle different actions
                    if (action === 'save_and_close') {
                        closeTeacherModal();
                    } else if (action === 'save_and_continue') {
                        // Just show success, stay on current tab
                        console.log('✅ Saved, continuing editing...');
                    }

                    // Refresh teacher list
                    await loadAllTeachers();

                } else {
                    showToast('❌ Failed to save teacher', 'error');
                }

            } catch (error) {
                console.error('Error saving teacher:', error);
                showToast('❌ Error saving teacher', 'error');
            }
        }

        // Auto-save functionality (matching courses pattern)
        function startTeacherAutoSave() {
            // Clear any existing interval
            if (teacherAutoSaveInterval) {
                clearInterval(teacherAutoSaveInterval);
            }

            // Start auto-save every 30 seconds
            teacherAutoSaveInterval = setInterval(async () => {
                if (currentEditingTeacherId) {
                    console.log('🔄 Auto-saving teacher data...');
                    await saveTeacherData('auto_save');
                    showToast('💾 Auto-saved', 'info');
                }
            }, 30000);

            console.log('⏰ Teacher auto-save started (30 second intervals)');
        }

        // Close teacher modal (matching courses pattern)
        function closeTeacherModal() {
            const modal = document.getElementById('teacherModal');
            modal.style.display = 'none';

            // Clear auto-save interval
            if (teacherAutoSaveInterval) {
                clearInterval(teacherAutoSaveInterval);
                teacherAutoSaveInterval = null;
            }

            // Reset modal state
            currentEditingTeacherId = null;
            teacherData = {};

            console.log('❌ Teacher modal closed');
        }

        // Preview teacher from modal (matching courses pattern)
        function previewTeacherFromModal() {
            if (currentEditingTeacherId) {
                const previewUrl = `/detail_teacher.html?id=${currentEditingTeacherId}&preview=true`;
                window.open(previewUrl, '_blank');
                showToast('🔍 Opened teacher preview in new tab', 'info');
            }
        }

        // Populate experience list
        function populateExperienceList(experienceData) {
            const container = document.getElementById('experienceList');
            container.innerHTML = '';

            const experiences = Array.isArray(experienceData) ? experienceData : [];

            experiences.forEach((exp, index) => {
                addExperienceItemWithData(exp, index);
            });

            if (experiences.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">No experience added yet. Click "Add Experience" to get started.</p>';
            }
        }

        // Add experience item with data
        function addExperienceItemWithData(exp, index) {
            const container = document.getElementById('experienceList');
            const div = document.createElement('div');
            div.className = 'experience-item';
            div.style.cssText = 'background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e2e8f0;';

            div.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px;">
                    <input type="text" placeholder="Job Title" value="${exp.title || ''}"
                           onchange="updateExperienceField(${index}, 'title', this.value)"
                           style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                    <input type="text" placeholder="Company" value="${exp.company || ''}"
                           onchange="updateExperienceField(${index}, 'company', this.value)"
                           style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr auto; gap: 15px; margin-bottom: 10px;">
                    <input type="text" placeholder="Duration (e.g., 2020 - Present)" value="${exp.duration || ''}"
                           onchange="updateExperienceField(${index}, 'duration', this.value)"
                           style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                    <button onclick="removeExperienceItem(${index})" style="background: #ef4444; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">🗑️ Remove</button>
                </div>
                <textarea placeholder="Description of role and responsibilities"
                          onchange="updateExperienceField(${index}, 'description', this.value)"
                          style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; rows="3">${exp.description || ''}</textarea>
            `;

            container.appendChild(div);
        }

        // Add new experience item
        function addExperienceItem() {
            if (!teacherDetailData.experience_history) {
                teacherDetailData.experience_history = [];
            }

            const newExp = { title: '', company: '', duration: '', description: '' };
            teacherDetailData.experience_history.push(newExp);

            addExperienceItemWithData(newExp, teacherDetailData.experience_history.length - 1);
        }

        // Update experience field
        function updateExperienceField(index, field, value) {
            if (!teacherDetailData.experience_history) {
                teacherDetailData.experience_history = [];
            }

            if (!teacherDetailData.experience_history[index]) {
                teacherDetailData.experience_history[index] = {};
            }

            teacherDetailData.experience_history[index][field] = value;
            markTeacherDetailChanged();
        }

        // Remove experience item
        function removeExperienceItem(index) {
            if (teacherDetailData.experience_history && teacherDetailData.experience_history[index]) {
                teacherDetailData.experience_history.splice(index, 1);
                populateExperienceList(teacherDetailData.experience_history);
                markTeacherDetailChanged();
            }
        }

        // Similar functions for courses taught and reviews (simplified for brevity)
        function populateCoursesTaughtList(coursesData) {
            const container = document.getElementById('coursesTaughtList');
            container.innerHTML = '';

            const courses = Array.isArray(coursesData) ? coursesData : [];

            if (courses.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">No courses added yet. Click "Add Course" to get started.</p>';
            } else {
                courses.forEach((course, index) => {
                    const div = document.createElement('div');
                    div.style.cssText = 'background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e2e8f0;';
                    div.innerHTML = `
                        <input type="text" placeholder="Course Title" value="${course.title || ''}"
                               style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; margin-bottom: 10px;">
                        <textarea placeholder="Course Description" rows="2"
                                  style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; margin-bottom: 10px;">${course.description || ''}</textarea>
                        <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px;">
                            <input type="number" placeholder="Students" value="${course.students || ''}"
                                   style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <input type="number" placeholder="Rating" step="0.1" max="5" value="${course.rating || ''}"
                                   style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <button onclick="removeCourseItem(${index})" style="background: #ef4444; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">🗑️</button>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        }

        function populateReviewsList(reviewsData) {
            const container = document.getElementById('reviewsList');
            container.innerHTML = '';

            const reviews = Array.isArray(reviewsData) ? reviewsData : [];

            if (reviews.length === 0) {
                container.innerHTML = '<p style="color: #666; font-style: italic;">No reviews added yet. Click "Add Review" to get started.</p>';
            } else {
                reviews.forEach((review, index) => {
                    const div = document.createElement('div');
                    div.style.cssText = 'background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e2e8f0;';
                    div.innerHTML = `
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; margin-bottom: 10px;">
                            <input type="text" placeholder="Student Name" value="${review.author || ''}"
                                   style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                            <select style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">
                                <option value="★★★★★" ${review.stars === '★★★★★' ? 'selected' : ''}>★★★★★ (5 stars)</option>
                                <option value="★★★★☆" ${review.stars === '★★★★☆' ? 'selected' : ''}>★★★★☆ (4 stars)</option>
                                <option value="★★★☆☆" ${review.stars === '★★★☆☆' ? 'selected' : ''}>★★★☆☆ (3 stars)</option>
                                <option value="★★☆☆☆" ${review.stars === '★★☆☆☆' ? 'selected' : ''}>★★☆☆☆ (2 stars)</option>
                                <option value="★☆☆☆☆" ${review.stars === '★☆☆☆☆' ? 'selected' : ''}>★☆☆☆☆ (1 star)</option>
                            </select>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px;">
                            <textarea placeholder="Review text" rows="3"
                                      style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px;">${review.text || ''}</textarea>
                            <button onclick="removeReviewItem(${index})" style="background: #ef4444; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; height: fit-content;">🗑️</button>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        }

        // Add course item
        function addCourseItem() {
            if (!teacherDetailData.courses_taught) {
                teacherDetailData.courses_taught = [];
            }

            const newCourse = { title: '', description: '', students: 0, rating: 5.0 };
            teacherDetailData.courses_taught.push(newCourse);
            populateCoursesTaughtList(teacherDetailData.courses_taught);
            markTeacherDetailChanged();
        }

        // Add review item
        function addReviewItem() {
            if (!teacherDetailData.student_reviews) {
                teacherDetailData.student_reviews = [];
            }

            const newReview = { author: '', text: '', stars: '★★★★★' };
            teacherDetailData.student_reviews.push(newReview);
            populateReviewsList(teacherDetailData.student_reviews);
            markTeacherDetailChanged();
        }

        // Mark that changes have been made
        function markTeacherDetailChanged() {
            document.getElementById('teacher-detail-auto-save-status').textContent = 'Changes pending...';
            document.getElementById('teacher-detail-auto-save-status').style.color = '#f59e0b';
        }

        // Start auto-save for teacher detail
        function startTeacherDetailAutoSave() {
            teacherDetailAutoSaveInterval = setInterval(() => {
                const status = document.getElementById('teacher-detail-auto-save-status').textContent;
                if (status.includes('pending')) {
                    saveTeacherDetailData(false); // Auto-save without closing modal
                }
            }, 30000); // Every 30 seconds
        }

        // Save teacher detail data
        async function saveTeacherDetailData(closeModal = true) {
            try {
                console.log('💾 Saving teacher detail data...');

                // Collect form data
                teacherDetailData.bio = document.getElementById('teacher-detail-bio').value;

                // Contact info
                teacherDetailData.contact_info = {
                    email: document.getElementById('teacher-detail-email').value,
                    phone: document.getElementById('teacher-detail-phone').value
                };

                // Social links
                teacherDetailData.social_links = {
                    linkedin: document.getElementById('teacher-detail-linkedin').value,
                    github: document.getElementById('teacher-detail-github').value,
                    twitter: document.getElementById('teacher-detail-twitter').value
                };

                const response = await fetch(`${API_BASE}/nd/teachers/${currentEditingDetailTeacherId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(teacherDetailData)
                });

                const result = await response.json();

                if (result.success) {
                    showToast(closeModal ? 'Teacher detail content saved successfully' : 'Auto-saved', 'success');
                    document.getElementById('teacher-detail-auto-save-status').textContent = 'Saved';
                    document.getElementById('teacher-detail-auto-save-status').style.color = '#10b981';

                    if (closeModal) {
                        closeTeacherDetailModal();
                        await loadAllTeachers(); // Refresh the teacher list
                    }
                } else {
                    showToast('Failed to save teacher detail content: ' + (result.error || 'Unknown error'), 'error');
                }

            } catch (error) {
                console.error('Error saving teacher detail data:', error);
                showToast('Failed to save teacher detail content', 'error');
            }
        }

        // Close teacher detail modal
        function closeTeacherDetailModal() {
            document.getElementById('teacherDetailModal').style.display = 'none';
            currentEditingDetailTeacherId = null;
            teacherDetailData = {};

            if (teacherDetailAutoSaveInterval) {
                clearInterval(teacherDetailAutoSaveInterval);
                teacherDetailAutoSaveInterval = null;
            }
        }

        // Preview teacher detail page
        function previewTeacherDetailPage() {
            if (currentEditingDetailTeacherId) {
                const previewUrl = `/detail_teacher.html?id=${currentEditingDetailTeacherId}&preview=true`;
                window.open(previewUrl, '_blank');
                showToast('🔍 Opened teacher detail preview in new tab', 'info');
            }
        }

        // ==================== TEACHERS PAGE CONTENT MANAGEMENT ====================

        // Load teachers data
        async function loadTeachersData() {
            try {
                showLoading();
                console.log('📊 Loading teachers data from nd_teachers_page...');

                const response = await fetch(`${API_BASE}/nd/teachers-page?locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data) {
                    console.log('✅ Teachers data loaded:', result.data);

                    // Process sections
                    result.data.forEach(section => {
                        const content = section.content || {};

                        switch (section.section_name) {
                            case 'hero':
                                const heroTitle = document.getElementById('teachers_hero_title');
                                const heroSubtitle = document.getElementById('teachers_hero_subtitle');
                                const heroDescription = document.getElementById('teachers_hero_description');
                                const heroVisible = document.getElementById('teachers_hero_visible');
                                if (heroTitle) heroTitle.value = content.title || '';
                                if (heroSubtitle) heroSubtitle.value = content.subtitle || '';
                                if (heroDescription) heroDescription.value = content.description || '';
                                if (heroVisible) heroVisible.checked = section.visible !== false;
                                break;

                            case 'instructor_grid':
                                const igTitle = document.getElementById('teachers_instructor_grid_title');
                                const igSubtitle = document.getElementById('teachers_instructor_grid_subtitle');
                                const igDescription = document.getElementById('teachers_instructor_grid_description');
                                const igVisible = document.getElementById('teachers_instructor_grid_visible');
                                if (igTitle) igTitle.value = content.title || '';
                                if (igSubtitle) igSubtitle.value = content.subtitle || '';
                                if (igDescription) igDescription.value = content.description || '';
                                if (igVisible) igVisible.checked = section.visible !== false;

                                // Load instructors
                                const instructorsContainer = document.getElementById('instructorsList');
                                instructorsContainer.innerHTML = '';
                                const instructors = content.instructors || [];
                                if (Array.isArray(instructors)) {
                                    instructors.forEach(instructor => addInstructorItem(instructor));
                                }
                                break;

                            case 'become_instructor':
                                const biTitle = document.getElementById('teachers_become_instructor_title');
                                const biSubtitle = document.getElementById('teachers_become_instructor_subtitle');
                                const biDescription = document.getElementById('teachers_become_instructor_description');
                                const biPrimaryButton = document.getElementById('teachers_become_instructor_primary_button');
                                const biPrimaryLink = document.getElementById('teachers_become_instructor_primary_link');
                                const biSecondaryButton = document.getElementById('teachers_become_instructor_secondary_button');
                                const biSecondaryLink = document.getElementById('teachers_become_instructor_secondary_link');
                                const biVisible = document.getElementById('teachers_become_instructor_visible');
                                if (biTitle) biTitle.value = content.title || '';
                                if (biSubtitle) biSubtitle.value = content.subtitle || '';
                                if (biDescription) biDescription.value = content.description || '';
                                if (biPrimaryButton) biPrimaryButton.value = content.primary_button || '';
                                if (biPrimaryLink) biPrimaryLink.value = content.primary_link || '';
                                if (biSecondaryButton) biSecondaryButton.value = content.secondary_button || '';
                                if (biSecondaryLink) biSecondaryLink.value = content.secondary_link || '';
                                if (biVisible) biVisible.checked = section.visible !== false;
                                break;

                            case 'stats':
                                const statsVisible = document.getElementById('teachers_stats_visible');
                                if (statsVisible) statsVisible.checked = section.visible !== false;

                                // Load stats items
                                const statsContainer = document.getElementById('statsList');
                                statsContainer.innerHTML = '';
                                const statsItems = content.items || [];
                                if (Array.isArray(statsItems)) {
                                    statsItems.forEach(item => addStatsItem(item));
                                }
                                break;
                        }
                    });

                    showToast('Teachers data loaded successfully', 'success');
                } else {
                    showToast('No teachers data found', 'warning');
                }
            } catch (error) {
                console.error('Error loading teachers data:', error);
                showToast('Failed to load teachers data', 'error');
            } finally {
                hideLoading();
            }
        }

        // Save teachers data
        async function saveTeachersData() {
            try {
                showLoading();
                console.log('💾 Saving teachers data to nd_teachers_page...');

                // Collect instructors
                const instructors = [];
                document.querySelectorAll('#instructorsList .instructor-item').forEach(item => {
                    instructors.push({
                        id: instructors.length + 1,
                        name: item.querySelector('[data-field="name"]').value,
                        expertise: item.querySelector('[data-field="expertise"]').value,
                        bio: item.querySelector('[data-field="bio"]').value,
                        image: item.querySelector('[data-field="image"]').value,
                        profile_link: item.querySelector('[data-field="profile_link"]').value
                    });
                });

                // Collect stats items
                const statsItems = [];
                document.querySelectorAll('#statsList .stats-item').forEach(item => {
                    statsItems.push({
                        text: item.querySelector('[data-field="text"]').value
                    });
                });

                const sectionsData = {
                    hero: {
                        title: document.getElementById('teachers_hero_title').value,
                        subtitle: document.getElementById('teachers_hero_subtitle').value,
                        description: document.getElementById('teachers_hero_description').value,
                        visible: document.getElementById('teachers_hero_visible').checked
                    },
                    instructor_grid: {
                        title: document.getElementById('teachers_instructor_grid_title').value,
                        subtitle: document.getElementById('teachers_instructor_grid_subtitle').value,
                        description: document.getElementById('teachers_instructor_grid_description').value,
                        instructors: instructors,
                        visible: document.getElementById('teachers_instructor_grid_visible').checked
                    },
                    become_instructor: {
                        title: document.getElementById('teachers_become_instructor_title').value,
                        subtitle: document.getElementById('teachers_become_instructor_subtitle').value,
                        description: document.getElementById('teachers_become_instructor_description').value,
                        primary_button: document.getElementById('teachers_become_instructor_primary_button').value,
                        primary_link: document.getElementById('teachers_become_instructor_primary_link').value,
                        secondary_button: document.getElementById('teachers_become_instructor_secondary_button').value,
                        secondary_link: document.getElementById('teachers_become_instructor_secondary_link').value,
                        visible: document.getElementById('teachers_become_instructor_visible').checked
                    },
                    stats: {
                        items: statsItems,
                        visible: document.getElementById('teachers_stats_visible').checked
                    }
                };

                // Save each section
                for (const [sectionName, sectionData] of Object.entries(sectionsData)) {
                    const response = await fetch(`${API_BASE}/nd/teachers-page/${sectionName}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ content: sectionData, locale: currentLang })
                    });

                    const result = await response.json();
                    if (!result.success) {
                        throw new Error(`Failed to save ${sectionName} section: ${result.error}`);
                    }
                }

                showToast('Teachers data saved successfully', 'success');
            } catch (error) {
                console.error('Error saving teachers data:', error);
                showToast('Failed to save teachers data: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // Add instructor item
        function addInstructorItem(data = {}) {
            const container = document.getElementById('instructorsList');
            const item = document.createElement('div');
            item.className = 'instructor-item';
            item.style.cssText = 'background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px;';

            item.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" placeholder="Instructor Name" value="${data.name || ''}" data-field="name">
                    <input type="text" placeholder="Expertise (e.g., AI & Machine Learning)" value="${data.expertise || ''}" data-field="expertise">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="text" placeholder="Image URL" value="${data.image || ''}" data-field="image" style="width: 100%;">
                </div>
                <div style="margin-bottom: 10px;">
                    <textarea placeholder="Bio/Description" data-field="bio" rows="3" style="width: 100%;">${data.bio || ''}</textarea>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" placeholder="Profile Link" value="${data.profile_link || '#'}" data-field="profile_link" style="flex: 1;">
                    <button class="btn btn-small btn-danger" onclick="this.parentElement.parentElement.remove()">Remove</button>
                </div>
            `;

            container.appendChild(item);
        }

        // Add stats item
        function addStatsItem(data = {}) {
            const container = document.getElementById('statsList');
            const item = document.createElement('div');
            item.className = 'stats-item';
            item.style.cssText = 'background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;';

            item.innerHTML = `
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" placeholder="Stats Text (e.g., Start Learning)" value="${data.text || ''}" data-field="text" style="flex: 1;">
                    <button class="btn btn-small btn-danger" onclick="this.parentElement.parentElement.remove()">Remove</button>
                </div>
            `;

            container.appendChild(item);
        }

        // Blog Management Functions (LEGACY - replaced by sophisticated version at end of file)

        async function addBlogPost() {
            const title = document.getElementById('new-blog-title').value;
            const author = document.getElementById('new-blog-author').value;
            const category = document.getElementById('new-blog-category').value;
            const url = document.getElementById('new-blog-url').value;
            const excerpt = document.getElementById('new-blog-excerpt').value;
            const content = document.getElementById('new-blog-content').value;

            if (!title || !author || !excerpt) {
                alert('Please fill in title, author, and excerpt fields');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/blog-posts`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        title,
                        author,
                        category,
                        url: url || null,
                        excerpt,
                        content,
                        slug: title.toLowerCase().replace(/[^\\w ]+/g, '').replace(/ +/g, '-'),
                        published_at: new Date().toISOString(),
                        locale: 'en'
                    })
                });

                if (response.ok) {
                    alert('Blog post added successfully!');
                    // Clear form
                    document.getElementById('new-blog-title').value = '';
                    document.getElementById('new-blog-author').value = '';
                    document.getElementById('new-blog-url').value = '';
                    document.getElementById('new-blog-excerpt').value = '';
                    document.getElementById('new-blog-content').value = '';
                    // Reload posts
                    loadBlogPosts();
                } else {
                    alert('Error adding blog post');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // editBlogPost function moved to end of file (sophisticated version)

        async function deleteBlogPost(id) {
            if (!confirm('Are you sure you want to delete this blog post?')) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/blog-posts/${id}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    alert('Blog post deleted successfully!');
                    loadBlogPosts();
                } else {
                    alert('Error deleting blog post');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // ========================================
        // Career Center Platform Functions
        // ========================================

        async function loadCareerPlatformData() {
            try {
                showLoading();
                console.log('📚 Loading Career Center Platform data...');

                const response = await fetch(`${API_BASE}/nd/career-center-platform-page?locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data && result.data.sections) {
                    const sections = result.data.sections;

                    // Hero Section
                    if (sections.hero) {
                        const heroTitle = document.getElementById('career-platform-hero-title');
                        const heroSubtitle = document.getElementById('career-platform-hero-subtitle');
                        const heroDescription = document.getElementById('career-platform-hero-description');
                        if (heroTitle) heroTitle.value = sections.hero.title || '';
                        if (heroSubtitle) heroSubtitle.value = sections.hero.subtitle || '';
                        if (heroDescription) heroDescription.value = sections.hero.description || '';
                        if (sections.hero.buttons && sections.hero.buttons[0]) {
                            const btn1Text = document.getElementById('career-platform-hero-button1-text');
                            const btn1Url = document.getElementById('career-platform-hero-button1-url');
                            if (btn1Text) btn1Text.value = sections.hero.buttons[0].text || '';
                            if (btn1Url) btn1Url.value = sections.hero.buttons[0].url || '';
                        }
                        if (sections.hero.buttons && sections.hero.buttons[1]) {
                            const btn2Text = document.getElementById('career-platform-hero-button2-text');
                            const btn2Url = document.getElementById('career-platform-hero-button2-url');
                            if (btn2Text) btn2Text.value = sections.hero.buttons[1].text || '';
                            if (btn2Url) btn2Url.value = sections.hero.buttons[1].url || '';
                        }
                    }

                    // Features Section
                    if (sections.features) {
                        const featuresTitle = document.getElementById('career-platform-features-title');
                        const featuresSubtitle = document.getElementById('career-platform-features-subtitle');
                        if (featuresTitle) featuresTitle.value = sections.features.title || '';
                        if (featuresSubtitle) featuresSubtitle.value = sections.features.subtitle || '';
                        if (sections.features.items) {
                            const container = document.getElementById('career-platform-features-list');
                            container.innerHTML = '';
                            sections.features.items.forEach(item => {
                                addCareerPlatformFeatureItem(item);
                            });
                        }
                    }

                    // Opportunities Section
                    if (sections.opportunities) {
                        const oppTitle = document.getElementById('career-platform-opportunities-title');
                        const oppSubtitle = document.getElementById('career-platform-opportunities-subtitle');
                        const oppDescription = document.getElementById('career-platform-opportunities-description');
                        if (oppTitle) oppTitle.value = sections.opportunities.title || '';
                        if (oppSubtitle) oppSubtitle.value = sections.opportunities.subtitle || '';
                        if (oppDescription) oppDescription.value = sections.opportunities.description || '';
                        if (sections.opportunities.categories) {
                            const container = document.getElementById('career-platform-categories-list');
                            container.innerHTML = '';
                            sections.opportunities.categories.forEach(category => {
                                addCareerPlatformCategoryItem(category);
                            });
                        }
                    }

                    // Resources Section
                    if (sections.resources) {
                        const resourcesTitle = document.getElementById('career-platform-resources-title');
                        const resourcesSubtitle = document.getElementById('career-platform-resources-subtitle');
                        if (resourcesTitle) resourcesTitle.value = sections.resources.title || '';
                        if (resourcesSubtitle) resourcesSubtitle.value = sections.resources.subtitle || '';
                        if (sections.resources.items) {
                            const container = document.getElementById('career-platform-resources-list');
                            container.innerHTML = '';
                            sections.resources.items.forEach(item => {
                                addCareerPlatformResourceItem(item);
                            });
                        }
                    }

                    // Testimonials Section
                    if (sections.testimonials) {
                        document.getElementById('career-platform-testimonials-title').value = sections.testimonials.title || '';
                        document.getElementById('career-platform-testimonials-subtitle').value = sections.testimonials.subtitle || '';
                        if (sections.testimonials.items) {
                            const container = document.getElementById('career-platform-testimonials-list');
                            container.innerHTML = '';
                            sections.testimonials.items.forEach(item => {
                                addCareerPlatformTestimonialItem(item);
                            });
                        }
                    }

                    // CTA Section
                    if (sections.cta) {
                        document.getElementById('career-platform-cta-title').value = sections.cta.title || '';
                        document.getElementById('career-platform-cta-description').value = sections.cta.description || '';
                        document.getElementById('career-platform-cta-button-text').value = sections.cta.button_text || '';
                        document.getElementById('career-platform-cta-button-url').value = sections.cta.button_url || '';
                    }
                }

                showToast('Career Center Platform data loaded successfully', 'success');
            } catch (error) {
                console.error('Error loading Career Center Platform data:', error);
                showToast('Failed to load Career Center Platform data', 'error');
            } finally {
                hideLoading();
            }
        }

        async function saveCareerPlatformData() {
            try {
                showLoading();
                console.log('💾 Saving Career Center Platform data...');

                // Collect all section data
                const sections = {
                    hero: {
                        title: document.getElementById('career-platform-hero-title')?.value || '',
                        subtitle: document.getElementById('career-platform-hero-subtitle')?.value || '',
                        description: document.getElementById('career-platform-hero-description')?.value || '',
                        buttons: [
                            {
                                text: document.getElementById('career-platform-hero-button1-text')?.value || '',
                                url: document.getElementById('career-platform-hero-button1-url')?.value || '',
                                style: 'primary'
                            },
                            {
                                text: document.getElementById('career-platform-hero-button2-text')?.value || '',
                                url: document.getElementById('career-platform-hero-button2-url')?.value || '',
                                style: 'secondary'
                            }
                        ]
                    },
                    features: {
                        title: document.getElementById('career-platform-features-title')?.value || '',
                        subtitle: document.getElementById('career-platform-features-subtitle')?.value || '',
                        items: collectCareerPlatformFeatures()
                    },
                    opportunities: {
                        title: document.getElementById('career-platform-opportunities-title')?.value || '',
                        subtitle: document.getElementById('career-platform-opportunities-subtitle')?.value || '',
                        description: document.getElementById('career-platform-opportunities-description')?.value || '',
                        categories: collectCareerPlatformCategories()
                    },
                    resources: {
                        title: document.getElementById('career-platform-resources-title')?.value || '',
                        subtitle: document.getElementById('career-platform-resources-subtitle')?.value || '',
                        items: collectCareerPlatformResources()
                    },
                    testimonials: {
                        title: document.getElementById('career-platform-testimonials-title')?.value || '',
                        subtitle: document.getElementById('career-platform-testimonials-subtitle')?.value || '',
                        items: collectCareerPlatformTestimonials()
                    },
                    cta: {
                        title: document.getElementById('career-platform-cta-title')?.value || '',
                        description: document.getElementById('career-platform-cta-description')?.value || '',
                        button_text: document.getElementById('career-platform-cta-button-text')?.value || '',
                        button_url: document.getElementById('career-platform-cta-button-url')?.value || ''
                    }
                };

                // Save each section
                for (const [sectionName, sectionData] of Object.entries(sections)) {
                    const response = await fetch(`${API_BASE}/nd/career-center-platform-page/${sectionName}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            content_en: sectionData,
                            content_ru: sectionData, // For now, same content
                            content_he: sectionData, // For now, same content
                            visible: true
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`Failed to save ${sectionName} section`);
                    }
                }

                showToast('Career Center Platform data saved successfully!', 'success');
            } catch (error) {
                console.error('Error saving Career Center Platform data:', error);
                showToast('Failed to save Career Center Platform data', 'error');
            } finally {
                hideLoading();
            }
        }

        // Helper functions for Career Center Platform
        function addCareerPlatformFeature() {
            const item = {
                title: 'New Feature',
                description: 'Feature description',
                icon: 'images/feature-icon.svg',
                url: '#'
            };
            addCareerPlatformFeatureItem(item);
        }

        function addCareerPlatformFeatureItem(item) {
            const container = document.getElementById('career-platform-features-list');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <div class="form-grid">
                    <input type="text" placeholder="Feature Title" value="${item.title || ''}" data-field="title">
                    <input type="text" placeholder="Feature Description" value="${item.description || ''}" data-field="description">
                    <input type="text" placeholder="Icon URL" value="${item.icon || ''}" data-field="icon">
                    <input type="text" placeholder="URL" value="${item.url || ''}" data-field="url">
                </div>
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">❌ Remove</button>
            `;
            container.appendChild(div);
        }

        function collectCareerPlatformFeatures() {
            const features = [];
            document.querySelectorAll('#career-platform-features-list .dynamic-item').forEach(item => {
                features.push({
                    title: item.querySelector('[data-field="title"]').value,
                    description: item.querySelector('[data-field="description"]').value,
                    icon: item.querySelector('[data-field="icon"]').value,
                    url: item.querySelector('[data-field="url"]').value
                });
            });
            return features;
        }

        function addCareerPlatformCategory() {
            const item = {
                name: 'Category Name',
                count: 0,
                icon: 'images/category-icon.svg'
            };
            addCareerPlatformCategoryItem(item);
        }

        function addCareerPlatformCategoryItem(item) {
            const container = document.getElementById('career-platform-categories-list');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <div class="form-grid">
                    <input type="text" placeholder="Category Name" value="${item.name || ''}" data-field="name">
                    <input type="number" placeholder="Count" value="${item.count || 0}" data-field="count">
                    <input type="text" placeholder="Icon URL" value="${item.icon || ''}" data-field="icon">
                </div>
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">❌ Remove</button>
            `;
            container.appendChild(div);
        }

        function collectCareerPlatformCategories() {
            const categories = [];
            document.querySelectorAll('#career-platform-categories-list .dynamic-item').forEach(item => {
                categories.push({
                    name: item.querySelector('[data-field="name"]').value,
                    count: parseInt(item.querySelector('[data-field="count"]').value) || 0,
                    icon: item.querySelector('[data-field="icon"]').value
                });
            });
            return categories;
        }

        function addCareerPlatformResource() {
            const item = {
                title: 'Resource Title',
                description: 'Resource description',
                type: 'guide',
                url: '/resources/'
            };
            addCareerPlatformResourceItem(item);
        }

        function addCareerPlatformResourceItem(item) {
            const container = document.getElementById('career-platform-resources-list');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <div class="form-grid">
                    <input type="text" placeholder="Resource Title" value="${item.title || ''}" data-field="title">
                    <input type="text" placeholder="Resource Description" value="${item.description || ''}" data-field="description">
                    <input type="text" placeholder="Type (guide/toolkit/roadmap/blog)" value="${item.type || ''}" data-field="type">
                    <input type="text" placeholder="URL" value="${item.url || ''}" data-field="url">
                </div>
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">❌ Remove</button>
            `;
            container.appendChild(div);
        }

        function collectCareerPlatformResources() {
            const resources = [];
            document.querySelectorAll('#career-platform-resources-list .dynamic-item').forEach(item => {
                resources.push({
                    title: item.querySelector('[data-field="title"]').value,
                    description: item.querySelector('[data-field="description"]').value,
                    type: item.querySelector('[data-field="type"]').value,
                    url: item.querySelector('[data-field="url"]').value
                });
            });
            return resources;
        }

        function addCareerPlatformTestimonial() {
            const item = {
                name: 'Person Name',
                role: 'Role at Company',
                content: 'Testimonial content',
                image: 'images/testimonial.jpg',
                rating: 5
            };
            addCareerPlatformTestimonialItem(item);
        }

        function addCareerPlatformTestimonialItem(item) {
            const container = document.getElementById('career-platform-testimonials-list');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <div class="form-grid">
                    <input type="text" placeholder="Name" value="${item.name || ''}" data-field="name">
                    <input type="text" placeholder="Role" value="${item.role || ''}" data-field="role">
                    <textarea placeholder="Testimonial Content" data-field="content" rows="2">${item.content || ''}</textarea>
                    <input type="text" placeholder="Image URL" value="${item.image || ''}" data-field="image">
                    <input type="number" placeholder="Rating (1-5)" value="${item.rating || 5}" data-field="rating" min="1" max="5">
                </div>
                <button class="btn btn-small btn-danger" onclick="this.parentElement.remove()">❌ Remove</button>
            `;
            container.appendChild(div);
        }

        function collectCareerPlatformTestimonials() {
            const testimonials = [];
            document.querySelectorAll('#career-platform-testimonials-list .dynamic-item').forEach(item => {
                testimonials.push({
                    name: item.querySelector('[data-field="name"]').value,
                    role: item.querySelector('[data-field="role"]').value,
                    content: item.querySelector('[data-field="content"]').value,
                    image: item.querySelector('[data-field="image"]').value,
                    rating: parseInt(item.querySelector('[data-field="rating"]').value) || 5
                });
            });
            return testimonials;
        }

        // Initialize search
        document.addEventListener('DOMContentLoaded', function() {
            // Build initial search index after a short delay
            setTimeout(() => {
                buildSearchIndex();
            }, 1000);

            // Auto-load blog posts when blog tab is clicked
            const blogTab = document.querySelector('[data-tab="blog"]');
            if (blogTab) {
                blogTab.addEventListener('click', function() {
                    setTimeout(loadBlogPosts, 100);
                });
            }

            // Auto-load career platform data when tab is clicked
            const careerTab = document.querySelector('[data-tab="career-platform"]');
            if (careerTab) {
                careerTab.addEventListener('click', function() {
                    setTimeout(loadCareerPlatformData, 100);
                });
            }

            // Add search event listeners
            const searchInput = document.getElementById('adminSearch');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        performSearch(e.target.value);
                    }, 300);
                });

                // Allow Enter key to search immediately
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        clearTimeout(searchTimeout);
                        performSearch(e.target.value);
                    }
                });
            }

            // Rebuild index when content changes
            const observer = new MutationObserver(() => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(buildSearchIndex, 1000);
            });

            const adminCard = document.querySelector('.admin-card');
            if (adminCard) {
                observer.observe(adminCard, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                    attributeFilter: ['value']
                });
            }
        });

        // Utility Classes
        const style = document.createElement('style');
        style.textContent = `
            .mb-10 { margin-bottom: 10px; }
            .mb-20 { margin-bottom: 20px; }
            .mt-20 { margin-top: 20px; }
        `;
        document.head.appendChild(style);
    </script>

    <!-- Course Details Modal -->
    <div id="courseDetailsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000;">
        <div style="position: relative; max-width: 900px; margin: 40px auto; background: white; border-radius: 16px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column;">
            <!-- Modal Header -->
            <div style="padding: 20px; border-bottom: 1px solid #e1e1e1; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h2 id="modalCourseTitle" style="margin: 0; color: white;">Edit Course Details</h2>
                <button onclick="closeCourseDetailsModal()" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 18px;">✕</button>
            </div>

            <!-- Tabs -->
            <div style="display: flex; background: #f8f9fa; border-bottom: 2px solid #e1e1e1;">
                <button class="modal-tab active" data-tab="basic" onclick="switchModalTab('basic')" style="padding: 15px 25px; border: none; background: transparent; cursor: pointer; font-weight: 500;">📝 Basic Info</button>
                <button class="modal-tab" data-tab="details" onclick="switchModalTab('details')" style="padding: 15px 25px; border: none; background: transparent; cursor: pointer; font-weight: 500;">📋 Details</button>
                <button class="modal-tab" data-tab="lessons" onclick="switchModalTab('lessons')" style="padding: 15px 25px; border: none; background: transparent; cursor: pointer; font-weight: 500;">📚 Lessons</button>
                <button class="modal-tab" data-tab="instructor" onclick="switchModalTab('instructor')" style="padding: 15px 25px; border: none; background: transparent; cursor: pointer; font-weight: 500;">👨‍🏫 Instructor</button>
                <button class="modal-tab" data-tab="media" onclick="switchModalTab('media')" style="padding: 15px 25px; border: none; background: transparent; cursor: pointer; font-weight: 500;">🖼️ Media</button>
            </div>

            <!-- Tab Content -->
            <div style="flex: 1; overflow-y: auto; padding: 20px;">
                <!-- Basic Info Tab -->
                <div id="tab-basic" class="modal-tab-content">
                    <input type="hidden" id="modal_course_id">

                    <div class="form-group">
                        <label>📘 Course Title *</label>
                        <input type="text" id="modal_course_title" placeholder="Enter course title" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>

                    <div class="form-group">
                        <label>📝 Description *</label>
                        <textarea id="modal_course_description" placeholder="Enter course description" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>

                    <div class="form-group">
                        <label>🎯 Short Description</label>
                        <input type="text" id="modal_course_short_description" placeholder="Brief course summary" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>💰 Price</label>
                            <input type="number" id="modal_course_price" placeholder="99.99" step="0.01" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                        </div>
                        <div class="form-group">
                            <label>🏷️ Old Price</label>
                            <input type="number" id="modal_course_old_price" placeholder="149.99" step="0.01" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                        </div>
                    </div>
                </div>

                <!-- Details Tab -->
                <div id="tab-details" class="modal-tab-content" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>⏱️ Duration</label>
                            <input type="text" id="modal_course_duration" placeholder="e.g., 8 weeks" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                        </div>
                        <div class="form-group">
                            <label>📊 Level</label>
                            <select id="modal_course_level" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                                <option value="">Select Level</option>
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                                <option value="All Levels">All Levels</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>🏷️ Category</label>
                        <select id="modal_course_category" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                            <option value="">Select Category</option>
                            <option value="Web Development">Web Development</option>
                            <option value="App Development">App Development</option>
                            <option value="Machine Learning">Machine Learning</option>
                            <option value="Cloud Computing">Cloud Computing</option>
                            <option value="Data Science">Data Science</option>
                            <option value="Artificial Intelligence">Artificial Intelligence</option>
                            <option value="DevOps">DevOps</option>
                            <option value="Cybersecurity">Cybersecurity</option>
                            <option value="General">General</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>🚀 Features (comma-separated)</label>
                        <textarea id="modal_course_features" placeholder="Live sessions, Projects, Certificate, Support" rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>

                    <div class="form-group">
                        <label>📋 Requirements</label>
                        <textarea id="modal_course_requirements" placeholder="Basic programming knowledge, Computer with internet" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>

                    <div class="form-group">
                        <label>🎯 What You'll Learn</label>
                        <textarea id="modal_course_objectives" placeholder="One objective per line" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>
                </div>

                <!-- Lessons Tab -->
                <div id="tab-lessons" class="modal-tab-content" style="display: none;">
                    <div style="margin-bottom: 20px;">
                        <button class="btn btn-small btn-success" onclick="addLesson()">➕ Add Lesson</button>
                        <span style="margin-left: 10px; color: #666;">Drag lessons to reorder</span>
                    </div>
                    <div id="lessonsList" style="min-height: 200px;">
                        <!-- Lessons will be dynamically added here -->
                    </div>
                </div>

                <!-- Instructor Tab -->
                <div id="tab-instructor" class="modal-tab-content" style="display: none;">
                    <div class="form-group">
                        <label>👨‍🏫 Instructor Name</label>
                        <input type="text" id="modal_course_instructor" placeholder="Instructor name" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>

                    <div class="form-group">
                        <label>📝 Instructor Bio</label>
                        <textarea id="modal_instructor_bio" placeholder="Brief instructor biography" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;"></textarea>
                    </div>

                    <div class="form-group">
                        <label>🖼️ Instructor Photo URL</label>
                        <input type="url" id="modal_instructor_photo" placeholder="https://example.com/instructor.jpg" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>
                </div>

                <!-- Media Tab -->
                <div id="tab-media" class="modal-tab-content" style="display: none;">
                    <div class="form-group">
                        <label>🖼️ Thumbnail Image URL</label>
                        <input type="url" id="modal_course_image" placeholder="https://example.com/course-image.jpg" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                        <div id="imagePreview" style="margin-top: 10px;"></div>
                    </div>

                    <div class="form-group">
                        <label>🎥 Video URL (for preview)</label>
                        <input type="url" id="modal_course_video_url" placeholder="https://youtube.com/watch?v=..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>

                    <div class="form-group">
                        <label>🎨 Banner Image URL</label>
                        <input type="url" id="modal_course_banner" placeholder="https://example.com/banner.jpg" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div style="padding: 20px; border-top: 1px solid #e1e1e1; display: flex; justify-content: space-between; background: #f8f9fa;">
                <div>
                    <button class="btn btn-success" onclick="window.open('/detail_courses.html?id=' + document.getElementById('modal_course_id').value + '&preview=true', '_blank')">👁️ Preview Course Page</button>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="closeCourseDetailsModal()">Cancel</button>
                    <button class="btn" onclick="saveCourseFromModal()">💾 Save & Continue</button>
                    <button class="btn btn-success" onclick="saveCourseFromModal(true)">✅ Save & Close</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .modal-tab.active {
            background: white !important;
            border-bottom: 3px solid #667eea !important;
            color: #667eea !important;
        }

        .modal-tab:hover {
            background: rgba(0,0,0,0.05) !important;
        }

        .lesson-item {
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lesson-item.dragging {
            opacity: 0.5;
        }

        .lesson-item:hover {
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>

    <!-- Admin Hints System JavaScript -->
    <script src="js/admin-hints-system.js"></script>

    <script>
        // Integration with existing language system
        function switchLanguage(lang) {
            // Update admin hints language
            if (window.setAdminLanguage) {
                window.setAdminLanguage(lang);
            }

            // Existing language switching logic here...
            console.log('Language switched to:', lang);
        }

        // Auto-detect and apply hints when tabs are switched
        document.addEventListener('DOMContentLoaded', function() {
            // Re-apply hints when content changes
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList' && window.adminHints) {
                        // Delay to allow content to render
                        setTimeout(() => {
                            // Temporarily disabled - causing appendChild error
                            // window.adminHints.applyHints();
                        }, 100);
                    }
                });
            });

            // Observe changes in content areas
            const contentAreas = document.querySelectorAll('#coursesContent, #homeContent, #teachersContent, #footerContent');
            contentAreas.forEach(area => {
                if (area) {
                    observer.observe(area, {
                        childList: true,
                        subtree: true
                    });
                }
            });
        });
        // ========================================
        // Universal Blog Administration System
        // ========================================

        let currentBlogPost = null;
        let isEditingBlog = false;
        let blogAutoSaveTimer = null;

        // Load blog posts with enhanced table display
        async function loadBlogPosts() {
            try {
                const response = await fetch(`http://localhost:3000/api/blog-posts`);
                const result = await response.json();

                if (result.success && result.data) {
                    renderBlogTable(result.data);
                    console.log(`✅ Loaded ${result.data.length} blog posts`);
                } else {
                    throw new Error('Failed to load blog posts');
                }
            } catch (error) {
                console.error('❌ Error loading blogs:', error);
                document.getElementById('blog-table-body').innerHTML = `
                    <tr><td colspan="6" style="padding: 40px; text-align: center; color: #e53e3e;">
                        Error loading blog posts: ${error.message}
                    </td></tr>
                `;
            }
        }

        // Load blog posts in Teachers tab
        async function loadBlogPostsInTeachers() {
            try {
                const response = await fetch(`http://localhost:3000/api/blog-posts?admin=true&locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data) {
                    renderTeachersBlogTable(result.data);
                    console.log(`✅ Loaded ${result.data.length} blog posts in Teachers tab`);
                } else {
                    throw new Error('Failed to load blog posts');
                }
            } catch (error) {
                console.error('❌ Error loading blogs in Teachers tab:', error);
                document.getElementById('teachers-blog-table-body').innerHTML = `
                    <tr><td colspan="6" style="padding: 40px; text-align: center; color: #e53e3e;">
                        Error loading blog posts: ${error.message}
                    </td></tr>
                `;
            }
        }

        function renderTeachersBlogTable(blogs) {
            const tbody = document.getElementById('teachers-blog-table-body');
            tbody.innerHTML = blogs.map(blog => `
                <tr style="border-bottom: 1px solid #e2e8f0; transition: background-color 0.2s ease;" onmouseover="this.style.backgroundColor='#f7fafc'" onmouseout="this.style.backgroundColor='transparent'">
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="font-weight: 600; color: #2d3748; margin-bottom: 4px;">${blog.title || 'Untitled'}</div>
                        <div style="font-size: 12px; color: #718096;">ID: ${blog.id} • Created: ${formatDate(blog.created_at)}</div>
                    </td>
                    <td style="padding: 16px; vertical-align: top;">${blog.author || 'Unknown'}</td>
                    <td style="padding: 16px; vertical-align: top;">${blog.category || 'Uncategorized'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <span style="display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; ${getStatusStyle(blog.status)}">
                            ${(blog.status || 'draft').toUpperCase()}
                        </span>
                    </td>
                    <td style="padding: 16px; vertical-align: top;">${formatDate(blog.published_at) || 'Not published'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button onclick="editBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #667eea; color: white;">
                                ✏️ Edit
                            </button>
                            <button onclick="viewBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #48bb78; color: white;">
                                👁️ View
                            </button>
                            <button onclick="deleteBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #f56565; color: white;">
                                🗑️ Delete
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Load blog posts in BlogNew tab
        async function loadBlogPostsNew() {
            try {
                console.log('🔄 Starting loadBlogPostsNew...');
                const response = await fetch(`http://localhost:3000/api/blog-posts`);
                console.log('📡 API response received:', response.status);
                const result = await response.json();
                console.log('📊 API result:', result);

                if (result.success && result.data) {
                    console.log('🎯 About to render table with data:', result.data.length, 'posts');
                    renderBlogNewTable(result.data);
                    console.log(`✅ Loaded ${result.data.length} blog posts in BlogNew tab`);
                } else {
                    throw new Error('Failed to load blog posts');
                }
            } catch (error) {
                console.error('❌ Error loading blogs in BlogNew tab:', error);
                const tbody = document.getElementById('blogNew-table-body');
                console.log('🔍 Found tbody element:', !!tbody);
                if (tbody) {
                    tbody.innerHTML = `
                        <tr><td colspan="6" style="padding: 40px; text-align: center; color: #e53e3e;">
                            Error loading blog posts: ${error.message}
                        </td></tr>
                    `;
                }
            }
        }

        function renderBlogNewTable(blogs) {
            console.log('🎨 Starting renderBlogNewTable with:', blogs.length, 'blogs');
            const tbody = document.getElementById('blogNew-table-body');
            console.log('🔍 Found tbody element:', !!tbody, tbody);
            if (!tbody) {
                console.error('❌ Could not find blogNew-table-body element!');
                return;
            }

            // Force visibility of table and parent containers
            const table = tbody.closest('table');
            const tableContainer = tbody.closest('.table-container');
            const blogNewSection = document.getElementById('blogNew');

            if (table) {
                table.style.display = 'table';
                table.style.visibility = 'visible';
                table.style.opacity = '1';
            }
            if (tableContainer) {
                tableContainer.style.display = 'block';
                tableContainer.style.visibility = 'visible';
                tableContainer.style.opacity = '1';
                tableContainer.style.height = 'auto';
                tableContainer.style.overflow = 'visible';
            }
            if (blogNewSection) {
                blogNewSection.style.display = 'block';
                blogNewSection.style.visibility = 'visible';
                blogNewSection.style.opacity = '1';
            }

            tbody.innerHTML = blogs.map(blog => `
                <tr style="border-bottom: 1px solid #e2e8f0; transition: background-color 0.2s ease; display: table-row; visibility: visible; opacity: 1;" onmouseover="this.style.backgroundColor='#f7fafc'" onmouseout="this.style.backgroundColor='transparent'">
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1;">
                        <div style="font-weight: 600; color: #2d3748 !important; margin-bottom: 4px;">${blog.title || 'Untitled'}</div>
                        <div style="font-size: 12px; color: #718096 !important;">ID: ${blog.id} • Created: ${formatDate(blog.created_at)}</div>
                    </td>
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1; color: #2d3748 !important;">${blog.author || 'Unknown'}</td>
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1; color: #2d3748 !important;">${blog.category || 'Uncategorized'}</td>
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1;">
                        <span style="display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; ${getStatusStyle(blog.status)}">
                            ${(blog.status || 'draft').toUpperCase()}
                        </span>
                    </td>
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1; color: #2d3748 !important;">${formatDate(blog.published_at) || 'Not published'}</td>
                    <td style="padding: 16px; vertical-align: top; display: table-cell; visibility: visible; opacity: 1;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button onclick="editBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #667eea; color: white;">
                                ✏️ Edit
                            </button>
                            <button onclick="viewBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #48bb78; color: white;">
                                👁️ View
                            </button>
                            <button onclick="deleteBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #f56565; color: white;">
                                🗑️ Delete
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            console.log('✅ renderBlogNewTable completed. Table HTML updated with forced visibility.');

            // Debug visibility
            setTimeout(() => {
                console.log('🔍 Post-render debug check:');
                console.log('  blogNew section:', document.getElementById('blogNew')?.style.display);
                console.log('  table-container:', document.querySelector('#blogNew .table-container')?.style.display);
                console.log('  table:', document.querySelector('#blogNew table')?.style.display);
                console.log('  tbody:', document.getElementById('blogNew-table-body')?.style.display);
                console.log('  first tr:', document.querySelector('#blogNew-table-body tr')?.style.display);
                console.log('  Row count in tbody:', document.querySelectorAll('#blogNew-table-body tr').length);
            }, 100);
        }

        function renderBlogTable(blogs) {
            const tbody = document.getElementById('blog-table-body');
            tbody.innerHTML = blogs.map(blog => `
                <tr style="border-bottom: 1px solid #e2e8f0; transition: background-color 0.2s ease;" onmouseover="this.style.backgroundColor='#f7fafc'" onmouseout="this.style.backgroundColor='transparent'">
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="font-weight: 600; color: #2d3748; margin-bottom: 4px;">${blog.title || 'Untitled'}</div>
                        <div style="font-size: 12px; color: #718096;">ID: ${blog.id} • Created: ${formatDate(blog.created_at)}</div>
                    </td>
                    <td style="padding: 16px; vertical-align: top;">${blog.author || 'Unknown'}</td>
                    <td style="padding: 16px; vertical-align: top;">${blog.category || 'Uncategorized'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <span style="display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; ${getStatusStyle(blog.status)}">
                            ${(blog.status || 'draft').toUpperCase()}
                        </span>
                    </td>
                    <td style="padding: 16px; vertical-align: top;">${formatDate(blog.published_at) || 'Not published'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button onclick="editBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #667eea; color: white;">
                                ✏️ Edit
                            </button>
                            <button onclick="viewBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #48bb78; color: white;">
                                👁️ View
                            </button>
                            <button onclick="deleteBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #f56565; color: white;">
                                🗑️ Delete
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusStyle(status) {
            switch(status) {
                case 'published': return 'background: #c6f6d5; color: #22543d;';
                case 'draft': return 'background: #fed7d7; color: #742a2a;';
                default: return 'background: #e2e8f0; color: #4a5568;';
            }
        }

        // Open create modal
        function openBlogCreateModal() {
            currentBlogPost = null;
            isEditingBlog = false;
            resetBlogForm();
            document.getElementById('blog-modal-title').textContent = 'Create New Blog Post';
            document.getElementById('blog-modal').style.display = 'flex';
        }

        // Edit blog post
        async function editBlogPost(blogId) {
            try {
                const response = await fetch(`http://localhost:3000/api/blog-posts/${blogId}`);
                const data = await response.json();

                if (data.success && data.data) {
                    currentBlogPost = data.data;
                    populateBlogModal(data.data);
                    document.getElementById('blog-modal-title').textContent = 'Edit Blog Post';
                    document.getElementById('blog-modal').style.display = 'flex';
                    isEditingBlog = true;
                } else {
                    throw new Error('Failed to load blog post');
                }
            } catch (error) {
                alert('Error loading blog post: ' + error.message);
            }
        }

        // View blog post
        function viewBlogPost(blogId) {
            window.open(`/detail_blog.html?id=${blogId}`, '_blank');
        }

        // Delete blog post
        async function deleteBlogPost(blogId) {
            if (!confirm('Are you sure you want to delete this blog post? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`http://localhost:3000/api/blog-posts/${blogId}`, {
                    method: 'DELETE'
                });

                const result = await response.json();

                if (result.success) {
                    console.log('✅ Blog deleted successfully');
                    loadBlogPosts(); // Refresh the table
                } else {
                    throw new Error('Failed to delete blog');
                }
            } catch (error) {
                alert('Error deleting blog post: ' + error.message);
            }
        }

        // Populate modal with blog data
        function populateBlogModal(blog) {
            document.getElementById('blog-modal-title-input').value = blog.title || '';
            document.getElementById('blog-modal-category').value = blog.category || '';
            document.getElementById('blog-modal-excerpt').value = blog.excerpt || blog.short_description || '';
            document.getElementById('blog-modal-status').value = blog.status || 'draft';
            document.getElementById('blog-modal-reading-time').value = blog.reading_time || '';
            document.getElementById('blog-modal-content').value = blog.content || blog.description || '';
            document.getElementById('blog-modal-tags').value = formatTags(blog.tags);
            document.getElementById('blog-modal-author').value = blog.author || '';
            document.getElementById('blog-modal-author-email').value = blog.author_email || '';
            document.getElementById('blog-modal-author-bio').value = blog.author_bio || '';
            document.getElementById('blog-modal-author-image').value = blog.author_image_url || '';
            document.getElementById('blog-modal-published-at').value = formatDateTimeLocal(blog.published_at);
            document.getElementById('blog-modal-featured-image').value = blog.featured_image_url || '';
            document.getElementById('blog-modal-video-url').value = blog.video_url || '';
            document.getElementById('blog-modal-url').value = blog.url || '';
            document.getElementById('blog-modal-views-count').value = blog.views_count || 0;
            document.getElementById('blog-modal-likes-count').value = blog.likes_count || 0;
            document.getElementById('blog-modal-shares-count').value = blog.shares_count || 0;
            document.getElementById('blog-modal-is-featured').checked = blog.is_featured || false;
            document.getElementById('blog-modal-seo-keywords').value = blog.seo_keywords || '';
            document.getElementById('blog-modal-meta-description').value = blog.meta_description || '';

            // Populate gallery images
            populateBlogGalleryImages(blog.gallery_images || []);

            // Populate content sections
            populateBlogContentSections(blog.content_sections || []);
        }

        // Reset blog form
        function resetBlogForm() {
            const form = document.querySelector('#blog-modal .modal-content');
            const inputs = form.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                if (input.type === 'checkbox') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });
        }

        // Save blog post
        async function saveBlogPost() {
            try {
                const blogData = collectBlogFormData();
                const method = isEditingBlog ? 'PUT' : 'POST';
                const url = isEditingBlog
                    ? `http://localhost:3000/api/blog-posts/${currentBlogPost.id}`
                    : `http://localhost:3000/api/blog-posts`;

                updateBlogAutoSaveStatus('saving');

                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(blogData)
                });

                const result = await response.json();

                if (result.success) {
                    updateBlogAutoSaveStatus('saved');
                    console.log('✅ Blog saved successfully');
                    setTimeout(() => {
                        closeBlogModal();
                        loadBlogPosts(); // Refresh the table
                    }, 1000);
                } else {
                    throw new Error(result.error || 'Failed to save blog');
                }
            } catch (error) {
                console.error('❌ Error saving blog:', error);
                updateBlogAutoSaveStatus('error');
                alert('Failed to save blog post: ' + error.message);
            }
        }

        // Collect form data
        function collectBlogFormData() {
            return {
                title: document.getElementById('blog-modal-title-input').value,
                category: document.getElementById('blog-modal-category').value,
                excerpt: document.getElementById('blog-modal-excerpt').value,
                short_description: document.getElementById('blog-modal-excerpt').value,
                status: document.getElementById('blog-modal-status').value,
                reading_time: parseInt(document.getElementById('blog-modal-reading-time').value) || null,
                content: document.getElementById('blog-modal-content').value,
                description: document.getElementById('blog-modal-content').value,
                tags: parseTags(document.getElementById('blog-modal-tags').value),
                author: document.getElementById('blog-modal-author').value,
                author_email: document.getElementById('blog-modal-author-email').value,
                author_bio: document.getElementById('blog-modal-author-bio').value,
                author_image_url: document.getElementById('blog-modal-author-image').value,
                published_at: document.getElementById('blog-modal-published-at').value || null,
                featured_image_url: document.getElementById('blog-modal-featured-image').value,
                video_url: document.getElementById('blog-modal-video-url').value,
                url: document.getElementById('blog-modal-url').value,
                views_count: parseInt(document.getElementById('blog-modal-views-count').value) || 0,
                likes_count: parseInt(document.getElementById('blog-modal-likes-count').value) || 0,
                shares_count: parseInt(document.getElementById('blog-modal-shares-count').value) || 0,
                is_featured: document.getElementById('blog-modal-is-featured').checked,
                seo_keywords: document.getElementById('blog-modal-seo-keywords').value,
                meta_description: document.getElementById('blog-modal-meta-description').value,
                gallery_images: collectBlogGalleryImages(),
                content_sections: collectBlogContentSections()
            };
        }

        // Modal control functions
        function closeBlogModal() {
            document.getElementById('blog-modal').style.display = 'none';
            currentBlogPost = null;
            isEditingBlog = false;
            clearBlogAutoSave();
            resetBlogForm();
        }

        function switchBlogTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.blog-modal-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.color = '#718096';
                tab.style.borderBottomColor = 'transparent';
                tab.style.background = 'transparent';
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.querySelector(`[data-tab="${tabName}"]`).style.color = '#667eea';
            document.querySelector(`[data-tab="${tabName}"]`).style.borderBottomColor = '#667eea';
            document.querySelector(`[data-tab="${tabName}"]`).style.background = 'white';

            // Update tab content
            document.querySelectorAll('.blog-modal-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(`blog-tab-${tabName}`).style.display = 'block';
        }

        // Auto-save functionality
        function updateBlogAutoSaveStatus(status) {
            const statusElement = document.getElementById('blog-auto-save-status');

            const messages = {
                ready: 'Ready',
                saving: '💾 Saving...',
                saved: '✅ Saved',
                error: '❌ Save failed'
            };

            statusElement.textContent = messages[status] || status;
        }

        function clearBlogAutoSave() {
            clearTimeout(blogAutoSaveTimer);
            updateBlogAutoSaveStatus('ready');
        }

        // Search functionality
        function filterBlogTable() {
            const searchTerm = document.getElementById('blog-search-input').value.toLowerCase();
            const rows = document.querySelectorAll('#blog-table-body tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Search functionality for Teachers tab blog
        function filterTeachersBlogTable() {
            const searchTerm = document.getElementById('teachers-blog-search-input').value.toLowerCase();
            const rows = document.querySelectorAll('#teachers-blog-table-body tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Search functionality for BlogNew tab
        function filterBlogNewTable() {
            const searchTerm = document.getElementById('blogNew-search-input').value.toLowerCase();
            const rows = document.querySelectorAll('#blogNew-table-body tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // ==== BLOG ADMIN TAB FUNCTIONS ====
        // Simple implementation to display blog posts from blog_posts table

        async function loadBlogAdmin() {
            try {
                console.log(`🔄 Loading blog posts for BlogAdmin tab in ${currentLang}...`);
                const response = await fetch(`http://localhost:3000/api/blog-posts?admin=true&locale=${currentLang}`);
                const result = await response.json();

                if (result.success && result.data) {
                    renderBlogAdminTable(result.data);
                    console.log(`✅ Loaded ${result.data.length} blog posts in BlogAdmin tab`);
                } else {
                    throw new Error('Failed to load blog posts');
                }
            } catch (error) {
                console.error('❌ Error loading blogs in BlogAdmin tab:', error);
                const tbody = document.getElementById('blogAdmin-table-body');
                if (tbody) {
                    tbody.innerHTML = `
                        <tr><td colspan="6" style="padding: 40px; text-align: center; color: #e53e3e;">
                            Error loading blog posts: ${error.message}
                        </td></tr>
                    `;
                }
            }
        }

        function renderBlogAdminTable(blogs) {
            const tbody = document.getElementById('blogAdmin-table-body');
            if (!tbody) {
                console.error('❌ Could not find blogAdmin-table-body element!');
                return;
            }

            tbody.innerHTML = blogs.map(blog => `
                <tr style="border-bottom: 1px solid #e2e8f0; transition: background-color 0.2s ease;" onmouseover="this.style.backgroundColor='#f7fafc'" onmouseout="this.style.backgroundColor='transparent'">
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="font-weight: 600; color: #2d3748; margin-bottom: 4px;">${blog.title || 'Untitled'}</div>
                        <div style="font-size: 12px; color: #718096;">ID: ${blog.id} • Created: ${formatDate(blog.created_at)}</div>
                    </td>
                    <td style="padding: 16px; vertical-align: top; color: #2d3748;">${blog.author || 'Unknown'}</td>
                    <td style="padding: 16px; vertical-align: top; color: #2d3748;">${blog.category || 'Uncategorized'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <span style="display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; ${getStatusStyle(blog.status)}">
                            ${(blog.status || 'draft').toUpperCase()}
                        </span>
                    </td>
                    <td style="padding: 16px; vertical-align: top; color: #2d3748;">${formatDate(blog.published_at) || 'Not published'}</td>
                    <td style="padding: 16px; vertical-align: top;">
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button onclick="editBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #667eea; color: white;">
                                ✏️ Edit
                            </button>
                            <button onclick="viewBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #48bb78; color: white;">
                                👁️ View
                            </button>
                            <button onclick="deleteBlogPost(${blog.id})" style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #f56565; color: white;">
                                🗑️ Delete
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');

            console.log(`✅ BlogAdmin table rendered with ${blogs.length} blog posts`);
        }

        function filterBlogAdminTable() {
            const searchTerm = document.getElementById('blogAdmin-search-input').value.toLowerCase();
            const rows = document.querySelectorAll('#blogAdmin-table-body tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Utility functions
        function formatTags(tags) {
            if (!tags) return '';
            if (Array.isArray(tags)) return tags.join(', ');
            if (typeof tags === 'string') return tags;
            return '';
        }

        function parseTags(str) {
            if (!str) return [];
            return str.split(',').map(tag => tag.trim()).filter(tag => tag);
        }

        function formatDate(dateString) {
            if (!dateString) return '';
            try {
                return new Date(dateString).toLocaleDateString();
            } catch (e) {
                return dateString;
            }
        }

        function formatDateTimeLocal(dateString) {
            if (!dateString) return '';
            try {
                const date = new Date(dateString);
                return date.toISOString().slice(0, 16);
            } catch (e) {
                return '';
            }
        }

        // Gallery Images Management
        function populateBlogGalleryImages(images) {
            const container = document.getElementById('blog-gallery-images-list');
            container.innerHTML = '';
            const imagesArray = Array.isArray(images) ? images : [];
            imagesArray.forEach((image, index) => {
                addBlogGalleryImageWithData(image, index);
            });
        }

        function addBlogGalleryImage() {
            const container = document.getElementById('blog-gallery-images-list');
            const index = container.children.length;
            addBlogGalleryImageWithData('', index);
        }

        function addBlogGalleryImageWithData(imageUrl, index) {
            const container = document.getElementById('blog-gallery-images-list');
            const div = document.createElement('div');
            div.className = 'gallery-image-item';
            div.style.cssText = 'margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; display: flex; align-items: center; gap: 10px;';
            div.innerHTML = `
                <input type="url" placeholder="Image URL ${index + 1}" value="${imageUrl}"
                       data-index="${index}" class="blog-gallery-image-input"
                       style="flex: 1; padding: 8px 12px; border: 2px solid #e2e8f0; border-radius: 6px;">
                <button type="button" onclick="removeBlogGalleryImage(${index})"
                        style="padding: 8px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer;">Remove</button>
            `;
            container.appendChild(div);
        }

        function removeBlogGalleryImage(index) {
            const container = document.getElementById('blog-gallery-images-list');
            container.innerHTML = '';
            const currentImages = collectBlogGalleryImages();
            currentImages.splice(index, 1);
            populateBlogGalleryImages(currentImages);
        }

        function collectBlogGalleryImages() {
            const inputs = document.querySelectorAll('.blog-gallery-image-input');
            return Array.from(inputs).map(input => input.value).filter(url => url);
        }

        // Content Sections Management
        function populateBlogContentSections(sections) {
            const container = document.getElementById('blog-content-sections-list');
            container.innerHTML = '';
            const sectionsArray = Array.isArray(sections) ? sections : [];
            sectionsArray.forEach((section, index) => {
                addBlogContentSectionWithData(section, index);
            });
        }

        function addBlogContentSection() {
            const container = document.getElementById('blog-content-sections-list');
            const index = container.children.length;
            addBlogContentSectionWithData({title: '', content: ''}, index);
        }

        function addBlogContentSectionWithData(section, index) {
            const container = document.getElementById('blog-content-sections-list');
            const div = document.createElement('div');
            div.className = 'content-section-item';
            div.style.cssText = 'margin-bottom: 15px; padding: 15px; background: white; border-radius: 6px; border: 1px solid #e2e8f0;';
            div.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <input type="text" placeholder="Section Title" value="${section.title || ''}"
                           data-index="${index}" class="blog-section-title-input"
                           style="width: 100%; padding: 8px 12px; border: 2px solid #e2e8f0; border-radius: 6px; margin-bottom: 8px;">
                    <textarea placeholder="Section Content" rows="4"
                              data-index="${index}" class="blog-section-content-input"
                              style="width: 100%; padding: 8px 12px; border: 2px solid #e2e8f0; border-radius: 6px; resize: vertical;">${section.content || ''}</textarea>
                </div>
                <button type="button" onclick="removeBlogContentSection(${index})"
                        style="padding: 8px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer;">Remove Section</button>
            `;
            container.appendChild(div);
        }

        function removeBlogContentSection(index) {
            const container = document.getElementById('blog-content-sections-list');
            container.innerHTML = '';
            const currentSections = collectBlogContentSections();
            currentSections.splice(index, 1);
            populateBlogContentSections(currentSections);
        }

        function collectBlogContentSections() {
            const titles = document.querySelectorAll('.blog-section-title-input');
            const contents = document.querySelectorAll('.blog-section-content-input');
            const sections = [];
            titles.forEach((titleInput, index) => {
                if (titleInput.value || (contents[index] && contents[index].value)) {
                    sections.push({
                        title: titleInput.value,
                        content: contents[index] ? contents[index].value : ''
                    });
                }
            });
            return sections;
        }

    </script>

    <!-- Universal Blog Modal System -->
    <div class="modal-overlay" id="blog-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(8px); display: none; z-index: 1000; align-items: center; justify-content: center;">
        <div class="modal-container" style="background: white; border-radius: 16px; width: 90%; max-width: 1200px; max-height: 90vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);">
            <!-- Modal Header -->
            <div class="modal-header" style="background: linear-gradient(135deg, #050f2c 0%, #0a1a3a 100%); color: white; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center;">
                <h2 id="blog-modal-title" style="margin: 0; font-size: 24px; font-weight: 700;">Edit Blog Post</h2>
                <button class="modal-close" onclick="closeBlogModal()" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: background-color 0.2s ease;">&times;</button>
            </div>

            <!-- Modal Tabs -->
            <div class="modal-tabs" style="display: flex; background: #f8f9fa; border-bottom: 2px solid #e2e8f0;">
                <button class="blog-modal-tab active" data-tab="basic" onclick="switchBlogTab('basic')" style="padding: 16px 24px; background: none; border: none; font-size: 14px; font-weight: 500; color: #718096; cursor: pointer; transition: all 0.2s ease; border-bottom: 3px solid transparent;">Basic Info</button>
                <button class="blog-modal-tab" data-tab="content" onclick="switchBlogTab('content')" style="padding: 16px 24px; background: none; border: none; font-size: 14px; font-weight: 500; color: #718096; cursor: pointer; transition: all 0.2s ease; border-bottom: 3px solid transparent;">Content</button>
                <button class="blog-modal-tab" data-tab="author" onclick="switchBlogTab('author')" style="padding: 16px 24px; background: none; border: none; font-size: 14px; font-weight: 500; color: #718096; cursor: pointer; transition: all 0.2s ease; border-bottom: 3px solid transparent;">Author & Meta</button>
                <button class="blog-modal-tab" data-tab="media" onclick="switchBlogTab('media')" style="padding: 16px 24px; background: none; border: none; font-size: 14px; font-weight: 500; color: #718096; cursor: pointer; transition: all 0.2s ease; border-bottom: 3px solid transparent;">Media & Links</button>
                <button class="blog-modal-tab" data-tab="advanced" onclick="switchBlogTab('advanced')" style="padding: 16px 24px; background: none; border: none; font-size: 14px; font-weight: 500; color: #718096; cursor: pointer; transition: all 0.2s ease; border-bottom: 3px solid transparent;">Advanced</button>
            </div>

            <!-- Modal Content -->
            <div class="modal-content" style="height: 60vh; overflow-y: auto; padding: 30px;">
                <!-- Basic Info Tab -->
                <div class="blog-modal-tab-content active" id="blog-tab-basic">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Title *</label>
                            <input type="text" class="form-input" id="blog-modal-title-input" required style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Category</label>
                            <select class="form-select" id="blog-modal-category" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                <option value="Technology">Technology</option>
                                <option value="AI/ML">AI/ML</option>
                                <option value="Programming">Programming</option>
                                <option value="Career">Career</option>
                                <option value="Industry">Industry</option>
                                <option value="Tutorial">Tutorial</option>
                            </select>
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Short Description</label>
                            <textarea class="form-textarea" id="blog-modal-excerpt" rows="3" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; min-height: 120px; resize: vertical;"></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Status</label>
                            <select class="form-select" id="blog-modal-status" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;">
                                <option value="published">Published</option>
                                <option value="draft">Draft</option>
                                <option value="archived">Archived</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Reading Time (minutes)</label>
                            <input type="number" class="form-input" id="blog-modal-reading-time" min="1" max="60" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                    </div>
                </div>

                <!-- Content Tab -->
                <div class="blog-modal-tab-content" id="blog-tab-content" style="display: none;">
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Full Content *</label>
                        <textarea class="form-textarea" id="blog-modal-content" rows="10" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; min-height: 300px; resize: vertical;"></textarea>
                    </div>
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Tags (comma separated)</label>
                        <input type="text" class="form-input" id="blog-modal-tags" placeholder="AI, Machine Learning, Technology" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                    </div>
                </div>

                <!-- Author & Meta Tab -->
                <div class="blog-modal-tab-content" id="blog-tab-author" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Author Name</label>
                            <input type="text" class="form-input" id="blog-modal-author" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Author Email</label>
                            <input type="email" class="form-input" id="blog-modal-author-email" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Author Bio</label>
                            <textarea class="form-textarea" id="blog-modal-author-bio" rows="3" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; min-height: 120px; resize: vertical;"></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Author Image URL</label>
                            <input type="url" class="form-input" id="blog-modal-author-image" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Published Date</label>
                            <input type="datetime-local" class="form-input" id="blog-modal-published-at" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                    </div>
                </div>

                <!-- Media & Links Tab -->
                <div class="blog-modal-tab-content" id="blog-tab-media" style="display: none;">
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Featured Image URL</label>
                        <input type="url" class="form-input" id="blog-modal-featured-image" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                    </div>
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Video URL (YouTube, Vimeo, etc.)</label>
                        <input type="url" class="form-input" id="blog-modal-video-url" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                    </div>
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">External Source URL</label>
                        <input type="url" class="form-input" id="blog-modal-url" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                    </div>

                    <!-- Gallery Images Section -->
                    <div class="form-group" style="margin-top: 30px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Gallery Images (for drill-down page)</label>
                        <div id="blog-gallery-images-container" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 10px;">
                            <div id="blog-gallery-images-list"></div>
                            <button type="button" onclick="addBlogGalleryImage()" style="margin-top: 10px; padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">+ Add Gallery Image</button>
                        </div>
                    </div>

                    <!-- Content Sections for Drill-Down -->
                    <div class="form-group" style="margin-top: 30px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Content Sections (for detailed view)</label>
                        <div id="blog-content-sections-container" style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                            <div id="blog-content-sections-list"></div>
                            <button type="button" onclick="addBlogContentSection()" style="margin-top: 10px; padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">+ Add Content Section</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Tab -->
                <div class="blog-modal-tab-content" id="blog-tab-advanced" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Views Count</label>
                            <input type="number" class="form-input" id="blog-modal-views-count" min="0" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Likes Count</label>
                            <input type="number" class="form-input" id="blog-modal-likes-count" min="0" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Shares Count</label>
                            <input type="number" class="form-input" id="blog-modal-shares-count" min="0" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">
                                <input type="checkbox" id="blog-modal-is-featured" style="margin-right: 8px;" />
                                Featured Article
                            </label>
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">SEO Keywords</label>
                            <input type="text" class="form-input" id="blog-modal-seo-keywords" placeholder="keyword1, keyword2, keyword3" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit;" />
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">Meta Description</label>
                            <textarea class="form-textarea" id="blog-modal-meta-description" rows="3" style="width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.2s ease; font-family: inherit; min-height: 120px; resize: vertical;"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer" style="background: #f8f9fa; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center;">
                <div class="auto-save-status" id="blog-auto-save-status" style="font-size: 14px; color: #718096;">Ready</div>
                <div class="modal-actions" style="display: flex; gap: 12px;">
                    <button class="modal-button modal-button-secondary" onclick="closeBlogModal()" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: #e2e8f0; color: #4a5568;">Cancel</button>
                    <button class="modal-button modal-button-primary" onclick="saveBlogPost()" style="padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">Save Blog Post</button>
                </div>
            </div>
        </div>
    </div>


</body>
</html>