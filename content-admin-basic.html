<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Studio - Content Manager</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f7; }
        .header { background: #1d1d1f; color: white; padding: 20px 0; text-align: center; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 30px; }
        .tab { padding: 12px 24px; background: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; }
        .tab.active { background: #007aff; color: white; }
        .content-section { display: none; background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .content-section.active { display: block; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: #333; }
        .form-group input, .form-group textarea, .form-group select { 
            width: 100%; padding: 12px; border: 2px solid #e1e1e1; border-radius: 8px; font-size: 16px;
            transition: border-color 0.2s;
        }
        .form-group input:focus, .form-group textarea:focus { border-color: #007aff; outline: none; }
        .btn { padding: 12px 24px; background: #007aff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; }
        .btn:hover { background: #0056b3; }
        .btn-danger { background: #ff3b30; }
        .btn-danger:hover { background: #d12b20; }
        .items-list { margin-top: 30px; }
        .item { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px; }
        .item h4 { color: #333; margin-bottom: 10px; }
        .item p { color: #666; margin-bottom: 8px; }
        .item-actions { margin-top: 10px; }
        .item-actions button { margin-right: 10px; }
        .status { padding: 20px; text-align: center; background: #e8f5e8; color: #2d5a3d; border-radius: 8px; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
    </style>
  <link href="css/mobile-fix.css" rel="stylesheet" type="text/css">
  <link href="/css/desktop-language-selector-fix.css" rel="stylesheet" type="text/css">
</head>
<body>
    <div class="header">
        <h1>üéì AI Studio - Content Manager</h1>
        <p>Manage all website content through Live API</p>
    </div>

    <div class="container">
        <div class="status" id="status">
            ‚úÖ Live API Connected - Ready to manage content
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showSection('courses')">üìö Courses</button>
            <button class="tab" onclick="showSection('blog-posts')">üìù Blog Posts</button>
            <button class="tab" onclick="showSection('teachers')">üë®‚Äçüè´ Teachers</button>
            <button class="tab" onclick="showSection('pricing-plans')">üí∞ Pricing</button>
        </div>

        <!-- Courses Section -->
        <div id="courses" class="content-section active">
            <h2>üìö Manage Courses</h2>
            <div class="grid">
                <div>
                    <h3>Add/Edit Course</h3>
                    <form id="courseForm">
                        <div class="form-group">
                            <label>Course Title</label>
                            <input type="text" id="courseTitle" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="courseDescription" rows="3" required></textarea>
                        </div>
                        <div class="grid">
                            <div class="form-group">
                                <label>Price ($)</label>
                                <input type="number" id="coursePrice" required>
                            </div>
                            <div class="form-group">
                                <label>Duration</label>
                                <input type="text" id="courseDuration" placeholder="e.g., 8 Weeks" required>
                            </div>
                        </div>
                        <div class="grid">
                            <div class="form-group">
                                <label>Lessons</label>
                                <input type="number" id="courseLessons" required>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="courseCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="Web Development">Web Development</option>
                                    <option value="Data Science">Data Science</option>
                                    <option value="Mobile Development">Mobile Development</option>
                                    <option value="Design">Design</option>
                                    <option value="Cloud & DevOps">Cloud & DevOps</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid">
                            <div class="form-group">
                                <label>Rating (1-5)</label>
                                <input type="number" id="courseRating" min="1" max="5" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label>Visible on Website</label>
                                <select id="courseVisible" required>
                                    <option value="1">Yes - Show on website</option>
                                    <option value="0">No - Hide from website</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn">üíæ Save Course</button>
                        <button type="button" class="btn btn-danger" onclick="clearCourseForm()">üóëÔ∏è Clear Form</button>
                    </form>
                </div>
                <div>
                    <h3>Current Courses</h3>
                    <div id="coursesList" class="items-list">
                        Loading courses...
                    </div>
                </div>
            </div>
        </div>

        <!-- Blog Posts Section -->
        <div id="blog-posts" class="content-section">
            <h2>üìù Manage Blog Posts</h2>
            <div id="blogPostsList" class="items-list">
                Loading blog posts...
            </div>
        </div>

        <!-- Teachers Section -->
        <div id="teachers" class="content-section">
            <h2>üë®‚Äçüè´ Manage Teachers</h2>
            <div id="teachersList" class="items-list">
                Loading teachers...
            </div>
        </div>

        <!-- Pricing Section -->
        <div id="pricing-plans" class="content-section">
            <h2>üí∞ Manage Pricing Plans</h2>
            <div id="pricingList" class="items-list">
                Loading pricing plans...
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3335/api';
        
        // Tab Management
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            // Load data for the section
            loadSectionData(sectionId);
        }
        
        // Load data based on section
        function loadSectionData(section) {
            switch(section) {
                case 'courses':
                    loadCourses();
                    break;
                case 'blog-posts':
                    loadBlogPosts();
                    break;
                case 'teachers':
                    loadTeachers();
                    break;
                case 'pricing-plans':
                    loadPricingPlans();
                    break;
            }
        }
        
        // Load Courses
        async function loadCourses() {
            try {
                const response = await fetch(`${API_URL}/courses`);
                const data = await response.json();
                
                const coursesList = document.getElementById('coursesList');
                coursesList.innerHTML = '';
                
                if (data.data && data.data.length > 0) {
                    data.data.forEach(course => {
                        const courseDiv = document.createElement('div');
                        courseDiv.className = 'item';
                        courseDiv.innerHTML = `
                            <h4>${course.attributes.title}</h4>
                            <p><strong>Price:</strong> $${course.attributes.price}</p>
                            <p><strong>Duration:</strong> ${course.attributes.duration}</p>
                            <p><strong>Lessons:</strong> ${course.attributes.lessons}</p>
                            <p><strong>Category:</strong> ${course.attributes.category}</p>
                            <p><strong>Rating:</strong> ${course.attributes.rating}/5</p>
                            <p><strong>Visible:</strong> ${course.attributes.visible ? '‚úÖ Yes' : '‚ùå No'}</p>
                            <p>${course.attributes.description}</p>
                            <div class="item-actions">
                                <button class="btn" onclick="editCourse(${course.id})">‚úèÔ∏è Edit</button>
                                <button class="btn btn-danger" onclick="deleteCourse(${course.id})">üóëÔ∏è Delete</button>
                            </div>
                        `;
                        coursesList.appendChild(courseDiv);
                    });
                } else {
                    coursesList.innerHTML = '<p>No courses found.</p>';
                }
            } catch (error) {
                console.error('Error loading courses:', error);
                document.getElementById('coursesList').innerHTML = '<p>Error loading courses. Check if Live API is running on port 3334.</p>';
            }
        }
        
        // Load other sections (simplified for now)
        async function loadBlogPosts() {
            const response = await fetch(`${API_URL}/blog-posts`);
            const data = await response.json();
            const list = document.getElementById('blogPostsList');
            
            if (data.data && data.data.length > 0) {
                list.innerHTML = data.data.map(post => `
                    <div class="item">
                        <h4>${post.attributes.title}</h4>
                        <p><strong>Author:</strong> ${post.attributes.author}</p>
                        <p><strong>Category:</strong> ${post.attributes.category}</p>
                        <p>${post.attributes.excerpt}</p>
                    </div>
                `).join('');
            } else {
                list.innerHTML = '<p>No blog posts found.</p>';
            }
        }
        
        async function loadTeachers() {
            const response = await fetch(`${API_URL}/teachers`);
            const data = await response.json();
            const list = document.getElementById('teachersList');
            
            if (data.data && data.data.length > 0) {
                list.innerHTML = data.data.map(teacher => `
                    <div class="item">
                        <h4>${teacher.attributes.name}</h4>
                        <p><strong>Role:</strong> ${teacher.attributes.role}</p>
                        <p>${teacher.attributes.bio}</p>
                        ${teacher.attributes.linkedin ? `<p><strong>LinkedIn:</strong> <a href="${teacher.attributes.linkedin}" target="_blank">Profile</a></p>` : ''}
                    </div>
                `).join('');
            } else {
                list.innerHTML = '<p>No teachers found.</p>';
            }
        }
        
        async function loadPricingPlans() {
            const response = await fetch(`${API_URL}/pricing-plans`);
            const data = await response.json();
            const list = document.getElementById('pricingList');
            
            if (data.data && data.data.length > 0) {
                list.innerHTML = data.data.map(plan => `
                    <div class="item">
                        <h4>${plan.attributes.name}</h4>
                        <p><strong>Price:</strong> $${plan.attributes.price}/${plan.attributes.period}</p>
                        <p>${plan.attributes.description}</p>
                        <p><strong>Featured:</strong> ${plan.attributes.featured ? '‚≠ê Yes' : 'No'}</p>
                    </div>
                `).join('');
            } else {
                list.innerHTML = '<p>No pricing plans found.</p>';
            }
        }
        
        // Form Management
        function clearCourseForm() {
            document.getElementById('courseForm').reset();
            delete document.getElementById('courseForm').dataset.editingId;
            document.querySelector('#courseForm button[type="submit"]').textContent = 'üíæ Save Course';
        }
        
        // Edit course - Load course data into form
        async function editCourse(courseId) {
            try {
                const response = await fetch(`${API_URL}/courses/${courseId}`);
                const data = await response.json();
                
                if (data.data) {
                    const course = data.data.attributes;
                    document.getElementById('courseTitle').value = course.title;
                    document.getElementById('courseDescription').value = course.description;
                    document.getElementById('coursePrice').value = course.price;
                    document.getElementById('courseDuration').value = course.duration;
                    document.getElementById('courseLessons').value = course.lessons;
                    document.getElementById('courseCategory').value = course.category;
                    document.getElementById('courseRating').value = course.rating;
                    document.getElementById('courseVisible').value = course.visible ? '1' : '0';
                    
                    // Store the ID for updating
                    document.getElementById('courseForm').dataset.editingId = courseId;
                    document.querySelector('#courseForm button[type="submit"]').textContent = '‚úèÔ∏è Update Course';
                    
                    // Scroll to form
                    document.getElementById('courseForm').scrollIntoView({ behavior: 'smooth' });
                }
            } catch (error) {
                console.error('Error loading course:', error);
                alert('Error loading course data');
            }
        }
        
        // Delete course
        async function deleteCourse(courseId) {
            if (confirm('Are you sure you want to delete this course? This action cannot be undone.')) {
                try {
                    const response = await fetch(`${API_URL}/courses/${courseId}`, {
                        method: 'DELETE'
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        alert('Course deleted successfully!');
                        loadCourses(); // Reload the courses list
                    } else {
                        alert('Error deleting course: ' + (result.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Error deleting course:', error);
                    alert('Error deleting course');
                }
            }
        }
        
        // Form submission - Create or Update course
        document.getElementById('courseForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const courseData = {
                title: document.getElementById('courseTitle').value,
                description: document.getElementById('courseDescription').value,
                price: parseInt(document.getElementById('coursePrice').value),
                duration: document.getElementById('courseDuration').value,
                lessons: parseInt(document.getElementById('courseLessons').value),
                category: document.getElementById('courseCategory').value,
                rating: parseFloat(document.getElementById('courseRating').value),
                visible: document.getElementById('courseVisible').value === '1'
            };
            
            try {
                const editingId = this.dataset.editingId;
                let response;
                
                if (editingId) {
                    // Update existing course
                    response = await fetch(`${API_URL}/courses/${editingId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(courseData)
                    });
                } else {
                    // Create new course
                    response = await fetch(`${API_URL}/courses`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(courseData)
                    });
                }
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(editingId ? 'Course updated successfully!' : 'Course created successfully!');
                    clearCourseForm();
                    loadCourses(); // Reload the courses list
                } else {
                    alert('Error saving course: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error saving course:', error);
                alert('Error saving course');
            }
        });
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadCourses(); // Load initial data
            
            // Check API connection
            fetch(`${API_URL}/status`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('status').innerHTML = `
                        ‚úÖ Live API Connected - ${data.content.courses} courses, ${data.content.blogPosts} blog posts, ${data.content.teachers} teachers
                    `;
                })
                .catch(error => {
                    document.getElementById('status').innerHTML = `
                        ‚ùå Live API Connection Failed - Make sure server is running on port 3334
                    `;
                });
        });
    </script>
  <script src="js/mobile-menu-fix.js"></script>
</body>
</html>