<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Translation Flow</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { margin: 10px; padding: 10px 20px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f4f4f4; padding: 10px; }
    </style>
</head>
<body>
    <h1>Test Translation Flow</h1>

    <div>
        <button onclick="setRussian()">1. Set Russian in localStorage</button>
        <button onclick="checkStorage()">2. Check localStorage</button>
        <button onclick="goToHome()">3. Go to Home</button>
        <button onclick="goToCourses()">4. Go to Courses</button>
        <button onclick="goToCoursesDirectRu()">5. Go to Courses with ?locale=ru</button>
        <button onclick="clearStorage()">Clear localStorage</button>
    </div>

    <h2>Current Status:</h2>
    <pre id="status"></pre>

    <script>
        const status = document.getElementById('status');

        function log(msg, type = 'info') {
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'info';
            status.innerHTML += `<span class="${className}">${msg}</span>\n`;
        }

        function setRussian() {
            localStorage.setItem('preferred_locale', 'ru');
            log('✅ Set preferred_locale to "ru"', 'success');
            checkStorage();
        }

        function checkStorage() {
            status.innerHTML = '';
            const locale = localStorage.getItem('preferred_locale');
            log('Current localStorage:');
            log(`  preferred_locale: ${locale || 'NOT SET'}`);

            if (locale === 'ru') {
                log('✅ Russian is set!', 'success');
                log('Now navigate to courses page - it should be in Russian');
            } else {
                log('⚠️ Russian is NOT set', 'error');
            }
        }

        function goToHome() {
            log('Navigating to home.html...');
            window.location.href = '/home.html';
        }

        function goToCourses() {
            log('Navigating to courses.html (should inherit language from localStorage)...');
            window.location.href = '/courses.html';
        }

        function goToCoursesDirectRu() {
            log('Navigating to courses.html with ?locale=ru...');
            window.location.href = '/courses.html?locale=ru';
        }

        function clearStorage() {
            localStorage.clear();
            log('❌ Cleared localStorage', 'error');
            checkStorage();
        }

        // Initial check
        checkStorage();

        // Instructions
        log('\nInstructions:', 'success');
        log('1. Click "Set Russian in localStorage"');
        log('2. Click "Go to Courses"');
        log('3. The courses page should be in Russian!');
        log('\nIf it doesn\'t work:');
        log('- Check browser console for errors');
        log('- Try hard refresh (Ctrl+Shift+R)');
        log('- Try "Go to Courses with ?locale=ru" to force it');
    </script>
</body>
</html>