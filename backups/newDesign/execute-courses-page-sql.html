<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Execute nd_courses_page SQL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .sql-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background: #5563d1;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
        .results {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—„ï¸ Create nd_courses_page Table</h1>

        <p>This page will execute SQL to create the <code>nd_courses_page</code> table in the Railway PostgreSQL database.</p>

        <h2>SQL to Execute:</h2>
        <div class="sql-box" id="sqlContent">
            Loading SQL...
        </div>

        <button onclick="executeSQL()" id="executeBtn">ğŸš€ Execute SQL on Railway Database</button>
        <button onclick="testTable()" id="testBtn">ğŸ§ª Test Table</button>
        <button onclick="testAPI()" id="apiBtn">ğŸ“¡ Test API Endpoint</button>

        <div id="status" class="status"></div>
        <div id="results" class="results"></div>
    </div>

    <script>
        // SQL script embedded
        const sqlScript = `-- Create nd_courses_page table
CREATE TABLE IF NOT EXISTS nd_courses_page (
    id SERIAL PRIMARY KEY,
    section_key VARCHAR(100) UNIQUE NOT NULL,
    section_type VARCHAR(50),
    content_en JSONB,
    content_ru JSONB,
    content_he JSONB,
    visible BOOLEAN DEFAULT true,
    animations_enabled BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Insert all sections
INSERT INTO nd_courses_page (section_key, section_type, content_en, content_ru, content_he) VALUES
('hero', 'hero',
    '{"title": "Our Courses", "subtitle": "Explore Our Learning Programs", "description": "Choose from our comprehensive range of courses designed to help you master new skills"}'::jsonb,
    '{"title": "ĞĞ°ÑˆĞ¸ ĞšÑƒÑ€ÑÑ‹", "subtitle": "Ğ˜Ğ·ÑƒÑ‡Ğ¸Ñ‚Ğµ ĞĞ°ÑˆĞ¸ Ğ£Ñ‡ĞµĞ±Ğ½Ñ‹Ğµ ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹", "description": "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ· Ğ½Ğ°ÑˆĞµĞ³Ğ¾ ÑˆĞ¸Ñ€Ğ¾ĞºĞ¾Ğ³Ğ¾ ÑĞ¿ĞµĞºÑ‚Ñ€Ğ° ĞºÑƒÑ€ÑĞ¾Ğ², Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ²Ğ°Ğ¼ Ğ¾ÑĞ²Ğ¾Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¸"}'::jsonb,
    '{"title": "×”×§×•×¨×¡×™× ×©×œ× ×•", "subtitle": "×—×§×•×¨ ××ª ×ª×•×›× ×™×•×ª ×”×œ××™×“×” ×©×œ× ×•", "description": "×‘×—×¨ ××ª×•×š ××’×•×•×Ÿ ×¨×—×‘ ×©×œ ×§×•×¨×¡×™× ×©× ×•×¢×“×• ×œ×¢×–×•×¨ ×œ×š ×œ×©×œ×•×˜ ×‘××™×•×× ×•×™×•×ª ×—×“×©×•×ª"}'::jsonb
),
('featured_courses', 'courses',
    '{"content": {"title": "Featured Courses", "subtitle": "Our Most Popular Programs", "filters": {"all": "All", "web_dev": "Web Development", "mobile_dev": "Mobile Development", "data_science": "Data Science", "machine_learning": "Machine Learning", "cloud": "Cloud Computing"}}}'::jsonb,
    '{"content": {"title": "Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ ĞšÑƒÑ€ÑÑ‹", "subtitle": "ĞĞ°ÑˆĞ¸ Ğ¡Ğ°Ğ¼Ñ‹Ğµ ĞŸĞ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹", "filters": {"all": "Ğ’ÑĞµ", "web_dev": "Ğ’ĞµĞ±-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°", "mobile_dev": "ĞœĞ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°", "data_science": "ĞĞ°ÑƒĞºĞ° Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…", "machine_learning": "ĞœĞ°ÑˆĞ¸Ğ½Ğ½Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ", "cloud": "ĞĞ±Ğ»Ğ°Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ"}}}'::jsonb,
    '{"content": {"title": "×§×•×¨×¡×™× ××•××œ×¦×™×", "subtitle": "×”×ª×•×›× ×™×•×ª ×”×¤×•×¤×•×œ×¨×™×•×ª ×‘×™×•×ª×¨ ×©×œ× ×•", "filters": {"all": "×”×›×œ", "web_dev": "×¤×™×ª×•×— ××™× ×˜×¨× ×˜", "mobile_dev": "×¤×™×ª×•×— ××•×‘×™×™×œ", "data_science": "××“×¢ ×”× ×ª×•× ×™×", "machine_learning": "×œ××™×“×ª ××›×•× ×”", "cloud": "××—×©×•×‘ ×¢× ×Ÿ"}}}'::jsonb
),
('ui_elements', 'ui',
    '{"content": {"buttons": {"course_details": "Course Details", "start_learning": "Start Learning", "browse_courses": "Browse Courses", "sign_up_today": "Sign Up Today", "get_in_touch": "Get In Touch", "check_out_courses": "Check Out Courses"}, "labels": {"price": "Price", "duration": "Duration", "level": "Level", "students": "Students Enrolled", "rating": "Rating", "instructor": "Instructor"}}}'::jsonb,
    '{"content": {"buttons": {"course_details": "Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ ĞšÑƒÑ€ÑĞ°", "start_learning": "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ", "browse_courses": "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞšÑƒÑ€ÑÑ‹", "sign_up_today": "Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒÑÑ Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ", "get_in_touch": "Ğ¡Ğ²ÑĞ·Ğ°Ñ‚ÑŒÑÑ", "check_out_courses": "ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞšÑƒÑ€ÑÑ‹"}, "labels": {"price": "Ğ¦ĞµĞ½Ğ°", "duration": "ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ", "level": "Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ", "students": "Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ¾", "rating": "Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³", "instructor": "ĞŸÑ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ"}}}'::jsonb,
    '{"content": {"buttons": {"course_details": "×¤×¨×˜×™ ×”×§×•×¨×¡", "start_learning": "×”×ª×—×œ ×œ×œ××•×“", "browse_courses": "×¢×™×™×Ÿ ×‘×§×•×¨×¡×™×", "sign_up_today": "×”×¨×©××” ×”×™×•×", "get_in_touch": "×¦×•×¨ ×§×©×¨", "check_out_courses": "×‘×“×•×§ ×§×•×¨×¡×™×"}, "labels": {"price": "××—×™×¨", "duration": "××©×š", "level": "×¨××”", "students": "×¡×˜×•×“× ×˜×™× ×¨×©×•××™×", "rating": "×“×™×¨×•×’", "instructor": "××“×¨×™×š"}}}'::jsonb
),
('cart', 'cart',
    '{"content": {"title": "Your Cart", "empty_message": "Your cart is empty", "subtotal": "Subtotal", "checkout": "Continue to Checkout", "remove": "Remove", "quantity": "Quantity"}}'::jsonb,
    '{"content": {"title": "Ğ’Ğ°ÑˆĞ° ĞšĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ°", "empty_message": "Ğ’Ğ°ÑˆĞ° ĞºĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ° Ğ¿ÑƒÑÑ‚Ğ°", "subtotal": "ĞŸÑ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ¸Ñ‚Ğ¾Ğ³", "checkout": "ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ Ğº Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ»ĞµĞ½Ğ¸Ñ", "remove": "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ", "quantity": "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾"}}'::jsonb,
    '{"content": {"title": "×”×¢×’×œ×” ×©×œ×š", "empty_message": "×”×¢×’×œ×” ×©×œ×š ×¨×™×§×”", "subtotal": "×¡×›×•× ×‘×™× ×™×™×", "checkout": "×”××©×š ×œ×ª×©×œ×•×", "remove": "×”×¡×¨", "quantity": "×›××•×ª"}}'::jsonb
),
('cta_bottom', 'cta',
    '{"content": {"subtitle": "Start Learning Today", "title": "Discover A World Of Learning Opportunities", "description": "Don't wait to transform your career and unlock your full potential"}}'::jsonb,
    '{"content": {"subtitle": "ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ", "title": "ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ ĞœĞ¸Ñ€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ´Ğ»Ñ ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ", "description": "ĞĞµ Ğ¶Ğ´Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ñ ĞºĞ°Ñ€ÑŒĞµÑ€Ñƒ Ğ¸ Ñ€Ğ°ÑĞºÑ€Ñ‹Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¹ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»"}}'::jsonb,
    '{"content": {"subtitle": "×”×ª×—×œ ×œ×œ××•×“ ×”×™×•×", "title": "×’×œ×” ×¢×•×œ× ×©×œ ×”×–×“×× ×•×™×•×ª ×œ××™×“×”", "description": "××œ ×ª×—×›×” ×œ×©× ×•×ª ××ª ×”×§×¨×™×™×¨×” ×©×œ×š ×•×œ×¤×ª×•×— ××ª ×”×¤×•×˜× ×¦×™××œ ×”××œ× ×©×œ×š"}}'::jsonb
),
('misc', 'misc',
    '{"content": {"no_items": "No items found", "loading": "Loading courses...", "error": "Failed to load courses"}}'::jsonb,
    '{"content": {"no_items": "Ğ¢Ğ¾Ğ²Ğ°Ñ€Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹", "loading": "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºÑƒÑ€ÑĞ¾Ğ²...", "error": "ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ ĞºÑƒÑ€ÑÑ‹"}}'::jsonb,
    '{"content": {"no_items": "×œ× × ××¦××• ×¤×¨×™×˜×™×", "loading": "×˜×•×¢×Ÿ ×§×•×¨×¡×™×...", "error": "× ×›×©×œ ×‘×˜×¢×™× ×ª ×§×•×¨×¡×™×"}}'::jsonb
),
('navigation', 'navigation',
    '{"content": {"home": "Home", "courses": "Courses", "pricing": "Pricing", "blog": "Blog", "teachers": "Teachers", "about_us": "About Us", "career_orientation": "Career Orientation", "career_center": "Career Center"}}'::jsonb,
    '{"content": {"home": "Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ", "courses": "ĞšÑƒÑ€ÑÑ‹", "pricing": "Ğ¦ĞµĞ½Ñ‹", "blog": "Ğ‘Ğ»Ğ¾Ğ³", "teachers": "ĞŸÑ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸", "about_us": "Ğ Ğ½Ğ°Ñ", "career_orientation": "ĞŸÑ€Ğ¾Ñ„Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ", "career_center": "Ğ¦ĞµĞ½Ñ‚Ñ€ ĞšĞ°Ñ€ÑŒĞµÑ€Ñ‹"}}'::jsonb,
    '{"content": {"home": "×‘×™×ª", "courses": "×§×•×¨×¡×™×", "pricing": "×ª××—×•×¨", "blog": "×‘×œ×•×’", "teachers": "××•×¨×™×", "about_us": "××•×“×•×ª×™× ×•", "career_orientation": "×”×›×•×•× ×” ××§×¦×•×¢×™×ª", "career_center": "××¨×›×– ×§×¨×™×™×¨×”"}}'::jsonb
)
ON CONFLICT (section_key) DO UPDATE
SET
    section_type = EXCLUDED.section_type,
    content_en = EXCLUDED.content_en,
    content_ru = EXCLUDED.content_ru,
    content_he = EXCLUDED.content_he,
    updated_at = NOW();`;

        // Display SQL on page load
        document.getElementById('sqlContent').textContent = sqlScript;

        async function executeSQL() {
            const btn = document.getElementById('executeBtn');
            const status = document.getElementById('status');

            btn.disabled = true;
            status.className = 'status info';
            status.innerHTML = 'â³ Executing SQL on Railway database...';

            try {
                // This would need a server endpoint to execute SQL
                // For now, we'll show instructions
                status.className = 'status info';
                status.innerHTML = `
                    <h3>ğŸ“‹ Manual Steps Required:</h3>
                    <ol>
                        <li>Copy the SQL above</li>
                        <li>Go to Railway Dashboard</li>
                        <li>Open the PostgreSQL plugin</li>
                        <li>Click "Connect" â†’ "psql"</li>
                        <li>Paste and execute the SQL</li>
                    </ol>
                    <p>Or use the Railway CLI:</p>
                    <pre>railway run psql < production-create-nd-courses-page.sql</pre>
                `;
            } catch (error) {
                status.className = 'status error';
                status.innerHTML = 'âŒ Error: ' + error.message;
            } finally {
                btn.disabled = false;
            }
        }

        async function testTable() {
            const btn = document.getElementById('testBtn');
            const status = document.getElementById('status');
            const results = document.getElementById('results');

            btn.disabled = true;
            status.className = 'status info';
            status.innerHTML = 'ğŸ§ª Testing table existence...';

            try {
                // Test via API
                const response = await fetch('http://localhost:1337/api/nd/courses-page?locale=en');

                if (response.ok) {
                    const data = await response.json();

                    if (data.success) {
                        status.className = 'status success';
                        status.innerHTML = 'âœ… Table exists and API is working!';

                        // Display results
                        let html = '<h3>Table Contents:</h3><table><tr><th>Section</th><th>Type</th><th>Has EN</th><th>Has RU</th><th>Has HE</th></tr>';

                        for (const [key, section] of Object.entries(data.data)) {
                            html += `<tr>
                                <td>${key}</td>
                                <td>${section.type}</td>
                                <td>${section.content && Object.keys(section.content).length > 0 ? 'âœ…' : 'âŒ'}</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>`;
                        }
                        html += '</table>';
                        results.innerHTML = html;
                    } else {
                        throw new Error(data.message || 'API returned error');
                    }
                } else if (response.status === 404) {
                    status.className = 'status error';
                    status.innerHTML = 'âŒ API endpoint not found. Server needs restart.';
                } else {
                    const text = await response.text();
                    throw new Error(`API error: ${text}`);
                }
            } catch (error) {
                status.className = 'status error';
                status.innerHTML = 'âŒ ' + error.message;

                if (error.message.includes('relation "nd_courses_page" does not exist')) {
                    status.innerHTML += '<br><br>Table does not exist yet. Please execute the SQL first.';
                }
            } finally {
                btn.disabled = false;
            }
        }

        async function testAPI() {
            const btn = document.getElementById('apiBtn');
            const status = document.getElementById('status');
            const results = document.getElementById('results');

            btn.disabled = true;
            status.className = 'status info';
            status.innerHTML = 'ğŸ“¡ Testing API endpoints...';

            try {
                const locales = ['en', 'ru', 'he'];
                let html = '<h3>API Test Results:</h3>';

                for (const locale of locales) {
                    const response = await fetch(`http://localhost:1337/api/nd/courses-page?locale=${locale}`);

                    if (response.ok) {
                        const data = await response.json();
                        const buttons = data.data?.ui_elements?.content?.buttons;

                        if (buttons) {
                            html += `<h4>${locale.toUpperCase()}:</h4><ul>`;
                            html += `<li>Course Details: "${buttons.course_details}"</li>`;
                            html += `<li>Sign Up Today: "${buttons.sign_up_today}"</li>`;
                            html += '</ul>';
                        }
                    }
                }

                status.className = 'status success';
                status.innerHTML = 'âœ… API endpoints working!';
                results.innerHTML = html;

            } catch (error) {
                status.className = 'status error';
                status.innerHTML = 'âŒ API Error: ' + error.message;
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>