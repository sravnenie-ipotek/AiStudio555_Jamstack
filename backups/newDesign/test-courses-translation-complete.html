<!DOCTYPE html>
<html>
<head>
    <title>Courses Page Translation Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1d3a;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        .success { color: #4ade80; }
        .warning { color: #fbbf24; }
        .error { color: #f87171; }
        .info { color: #60a5fa; }
        iframe {
            width: 100%;
            height: 700px;
            border: 2px solid #667eea;
            border-radius: 8px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #764ba2;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            text-align: center;
        }
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>🧪 Courses Page Complete Translation Test</h1>

    <div class="test-section">
        <h2>📊 Translation Coverage Statistics</h2>
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value">62</div>
                <div class="stat-label">data-i18n attributes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">270%</div>
                <div class="stat-label">Coverage increase</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">39</div>
                <div class="stat-label">New translations</div>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>🎯 Critical Elements Now Translated</h2>
        <ul>
            <li class="success">✅ Navigation menu items (home, courses, teachers, etc.)</li>
            <li class="success">✅ "Sign Up Today" buttons</li>
            <li class="success">✅ Course filter tabs (All, Web Development, etc.)</li>
            <li class="success">✅ "Course Details" buttons (10 instances)</li>
            <li class="success">✅ "Start Learning" buttons (9 instances)</li>
            <li class="success">✅ "Browse Courses" buttons (6 instances)</li>
            <li class="success">✅ "No items found" messages (6 instances)</li>
            <li class="success">✅ Cart elements (Your Cart, Subtotal, Continue to Checkout)</li>
            <li class="success">✅ CTA section (title and description)</li>
            <li class="success">✅ Footer elements (Newsletter, Contact, Menu titles)</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>🔧 Test Controls</h2>
        <button onclick="testEnglish()">Test English</button>
        <button onclick="testRussian()">Test Russian</button>
        <button onclick="testHebrew()">Test Hebrew</button>
        <button onclick="countTranslations()">Count Translations</button>
        <button onclick="checkMissing()">Check Missing</button>
    </div>

    <div class="test-section" id="results">
        <h2>📝 Test Results</h2>
        <div id="output"></div>
    </div>

    <iframe id="testFrame" src="http://localhost:3005/backups/newDesign/courses.html"></iframe>

    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const time = new Date().toLocaleTimeString();
            output.innerHTML += `<div class="${type}">[${time}] ${message}</div>`;
        }

        async function testEnglish() {
            const frame = document.getElementById('testFrame');
            frame.src = 'http://localhost:3005/backups/newDesign/courses.html?locale=en';
            log('🇬🇧 Loading English version...', 'info');

            setTimeout(() => {
                const doc = frame.contentDocument;
                const hasEnglish = doc.body.textContent.includes('Courses') &&
                                  doc.body.textContent.includes('Sign Up Today');
                if (hasEnglish) {
                    log('✅ English content verified', 'success');
                }
            }, 2000);
        }

        async function testRussian() {
            const frame = document.getElementById('testFrame');
            frame.src = 'http://localhost:3005/backups/newDesign/courses.html?locale=ru';
            log('🇷🇺 Loading Russian version...', 'info');

            setTimeout(() => {
                const doc = frame.contentDocument;
                const hasRussian = /[А-Яа-я]{3,}/.test(doc.body.textContent);
                if (hasRussian) {
                    log('✅ Russian content detected', 'success');

                    // Check specific translations
                    const elements = doc.querySelectorAll('[data-i18n]');
                    let translated = 0;
                    elements.forEach(el => {
                        if (/[А-Яа-я]/.test(el.textContent)) {
                            translated++;
                        }
                    });
                    log(`📊 ${translated}/${elements.length} elements showing Russian text`, 'info');
                } else {
                    log('⚠️ No Russian text detected - check API', 'warning');
                }
            }, 2000);
        }

        async function testHebrew() {
            const frame = document.getElementById('testFrame');
            frame.src = 'http://localhost:3005/backups/newDesign/courses.html?locale=he';
            log('🇮🇱 Loading Hebrew version...', 'info');

            setTimeout(() => {
                const doc = frame.contentDocument;
                const hasHebrew = /[א-ת]{3,}/.test(doc.body.textContent);
                const isRTL = doc.documentElement.getAttribute('dir') === 'rtl';

                if (hasHebrew) {
                    log('✅ Hebrew content detected', 'success');
                }
                if (isRTL) {
                    log('✅ RTL layout applied', 'success');
                }
            }, 2000);
        }

        function countTranslations() {
            const frame = document.getElementById('testFrame');
            const doc = frame.contentDocument;
            const elements = doc.querySelectorAll('[data-i18n]');

            log(`📊 Found ${elements.length} elements with data-i18n attributes`, 'info');

            // Group by section
            const sections = {};
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                const section = key.split('.')[0];
                sections[section] = (sections[section] || 0) + 1;
            });

            log('📁 Translation sections:', 'info');
            for (const [section, count] of Object.entries(sections)) {
                log(`  - ${section}: ${count} elements`, 'info');
            }
        }

        function checkMissing() {
            const frame = document.getElementById('testFrame');
            const doc = frame.contentDocument;

            // Find text elements without data-i18n
            const allElements = doc.querySelectorAll('a, button, h1, h2, h3, h4, p, span, div');
            let missing = [];

            allElements.forEach(el => {
                const text = el.textContent.trim();
                const hasI18n = el.hasAttribute('data-i18n');
                const hasChildren = el.children.length > 0;

                // Check for meaningful text without translation
                if (text && text.length > 2 && !hasI18n && !hasChildren &&
                    !/^[0-9|]+$/.test(text) && !text.includes('@')) {
                    missing.push(text.substring(0, 50));
                }
            });

            // Remove duplicates
            missing = [...new Set(missing)].slice(0, 20);

            if (missing.length > 0) {
                log(`⚠️ Found ${missing.length} potentially untranslated texts:`, 'warning');
                missing.forEach(text => {
                    log(`  - "${text}"`, 'warning');
                });
            } else {
                log('✅ No obvious missing translations found', 'success');
            }
        }

        // Auto-test on load
        window.addEventListener('load', () => {
            log('🚀 Courses page translation test loaded', 'success');
            log('📊 Coverage improved from 23 to 62 data-i18n attributes', 'success');
            log('✨ 39 new elements now support translation', 'success');
            setTimeout(countTranslations, 2000);
        });
    </script>
</body>
</html>