<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Menu Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .test-frame {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .controls button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .controls button:hover {
            background: #0056b3;
        }
        .device-selector {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.5;
            max-height: 300px;
            overflow-y: auto;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .mobile-frame {
            width: 375px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üì± Mobile Menu Test Suite</h1>

        <div class="controls">
            <select class="device-selector" id="deviceSelect">
                <option value="375">iPhone SE (375px)</option>
                <option value="390">iPhone 12 (390px)</option>
                <option value="414">iPhone Plus (414px)</option>
                <option value="768">iPad (768px)</option>
                <option value="100%">Desktop (100%)</option>
            </select>

            <select class="device-selector" id="pageSelect">
                <option value="/he/home.html">Hebrew Home</option>
                <option value="/he/courses.html">Hebrew Courses</option>
                <option value="/he/teachers.html">Hebrew Teachers</option>
                <option value="/he/pricing.html">Hebrew Pricing</option>
                <option value="/en/home.html">English Home</option>
                <option value="/ru/home.html">Russian Home</option>
            </select>

            <button onclick="loadPage()">Load Page</button>
            <button onclick="testMenu()">Test Menu</button>
            <button onclick="clearStatus()">Clear</button>
        </div>

        <div id="frameContainer" class="mobile-frame">
            <iframe id="testFrame" class="test-frame" src="/he/home.html"></iframe>
        </div>

        <div id="status" class="status">
            Ready to test mobile menu...
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const status = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : 'üìù';
            status.innerHTML += `${timestamp} ${icon} ${message}<br>`;
            status.scrollTop = status.scrollHeight;

            if (type === 'success') {
                status.className = 'status success';
            } else if (type === 'error') {
                status.className = 'status error';
            }
        }

        function clearStatus() {
            document.getElementById('status').innerHTML = 'Ready to test mobile menu...';
            document.getElementById('status').className = 'status';
        }

        function loadPage() {
            const page = document.getElementById('pageSelect').value;
            const frame = document.getElementById('testFrame');
            frame.src = page;
            log(`Loading ${page}...`);

            frame.onload = function() {
                log(`Page loaded: ${page}`, 'success');
            };
        }

        function setDeviceWidth() {
            const width = document.getElementById('deviceSelect').value;
            const container = document.getElementById('frameContainer');

            if (width === '100%') {
                container.style.width = '100%';
            } else {
                container.style.width = width + 'px';
            }

            log(`Device width set to: ${width}`);
        }

        async function testMenu() {
            clearStatus();
            log('Starting mobile menu test...');

            const frame = document.getElementById('testFrame');
            const frameDoc = frame.contentDocument || frame.contentWindow.document;

            try {
                // Test 1: Check if menu exists
                const menu = frameDoc.querySelector('.w-nav-menu');
                if (menu) {
                    log('Menu element found', 'success');
                } else {
                    log('Menu element not found', 'error');
                    return;
                }

                // Test 2: Check initial state
                const menuDisplay = window.getComputedStyle(menu).display;
                const menuVisibility = window.getComputedStyle(menu).visibility;
                log(`Initial state - Display: ${menuDisplay}, Visibility: ${menuVisibility}`);

                // Test 3: Check hamburger button
                const hamburger = frameDoc.querySelector('.w-nav-button');
                if (hamburger) {
                    log('Hamburger button found', 'success');
                    const hamburgerDisplay = window.getComputedStyle(hamburger).display;
                    log(`Hamburger display: ${hamburgerDisplay}`);
                } else {
                    log('Hamburger button not found', 'error');
                    return;
                }

                // Test 4: Click hamburger to open menu
                hamburger.click();
                await new Promise(resolve => setTimeout(resolve, 500));

                const bodyClasses = frameDoc.body.className;
                const isOpen = frameDoc.body.classList.contains('w--nav-menu-open');
                log(`After click - Menu open: ${isOpen}`, isOpen ? 'success' : 'error');

                // Test 5: Check menu items
                const menuItems = frameDoc.querySelectorAll('.w-nav-menu .nav-link');
                log(`Menu items found: ${menuItems.length}`);

                // Test 6: Click hamburger to close menu
                if (isOpen) {
                    hamburger.click();
                    await new Promise(resolve => setTimeout(resolve, 500));

                    const isClosed = !frameDoc.body.classList.contains('w--nav-menu-open');
                    log(`After second click - Menu closed: ${isClosed}`, isClosed ? 'success' : 'error');
                }

                // Summary
                log('========================================');
                log('Mobile menu test complete!', 'success');

            } catch (error) {
                log(`Test error: ${error.message}`, 'error');
            }
        }

        // Set initial device width
        document.getElementById('deviceSelect').addEventListener('change', setDeviceWidth);

        // Initial setup
        window.onload = function() {
            setDeviceWidth();
            log('Test page loaded and ready');
        };
    </script>
</body>
</html>